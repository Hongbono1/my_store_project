<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>광고 홈페이지 - 식당</title>

  <!-- Tailwind -->
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
  <style>
    .header-content { gap: 1rem; }
    .nav-links a   { transition: color .3s ease; }
    footer p       { font-size: .875rem; }
  </style>
</head>

<body class="bg-gray-50">
  <!-- ▣ 헤더 -->
  <div id="header-container"></div>

  <!-- ▣ 메인 -->
  <main class="w-full max-w-screen-xl mx-auto px-4 sm:px-8 mt-8">
    <!-- 타이틀 -->
    <section class="bg-gradient-to-r from-gray-800 to-blue-500 text-white p-6 rounded-lg shadow mb-12">
      <h1 class="text-4xl sm:text-5xl font-bold mb-2">식&nbsp;당</h1>
      <p class="text-lg sm:text-xl">맛있는 음식점들을 소개합니다. 오늘은 뭘 먹을까요?</p>
    </section>

    <!-- 카테고리 스크롤 버튼 -->
    <section id="categorySelection" class="bg-white p-4 rounded-lg shadow border border-gray-300 mb-12">
      <div class="bg-blue-100 p-6 rounded-lg">
        <h2 class="text-2xl font-bold mb-6">스크롤 선택</h2>
        <div class="flex overflow-x-auto space-x-3 py-3">
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="koreanAdsSection">한식</button>
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="chineseAdsSection">중식</button>
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="japaneseAdsSection">일식</button>
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="westernAdsSection">양식</button>
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="fastfoodAdsSection">패스트푸드</button>
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="chickenAdsSection">치킨</button>
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="cafeAdsSection">카페</button>
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="streetfoodAdsSection">스트리트푸드</button>
          <button class="category-btn bg-white text-gray-800 font-medium px-5 py-2 text-lg rounded-full border border-gray-400 shadow hover:bg-blue-200 transition" data-target="bunsikAdsSection">분식</button>
        </div>
      </div>
    </section>

    <!-- 파워 광고 -->
    <section id="powerAdsSection" class="bg-yellow-50 border-4 border-yellow-400 shadow-lg rounded-lg p-6 mb-16">
      <h2 class="text-2xl font-bold mb-4">파워 광고</h2>
      <div id="powerAdsGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="powerAdsEmpty" class="text-center text-gray-500 mt-4 hidden">준비중입니다.</p>
    </section>

    <!-- ===== 카테고리별 CSR 광고 섹션 ===== -->
    <!-- 한식 -->
    <section id="koreanAdsSection" class="category-box mb-16 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">한식 (CSR)</h2>
        <a href="detail_hansik.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="koreanAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="koreanEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
    <!-- 중식 -->
    <section id="chineseAdsSection" class="category-box mb-16 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">중식 (CSR)</h2>
        <a href="detail_chinese.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="chineseAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="chineseEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
    <!-- 일식 -->
    <section id="japaneseAdsSection" class="category-box mb-16 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">일식 (CSR)</h2>
        <a href="detail_japanese.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="japaneseAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="japaneseEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
    <!-- 양식 -->
    <section id="westernAdsSection" class="category-box mb-16 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">양식 (CSR)</h2>
        <a href="detail_western.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="westernAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="westernEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
    <!-- 패스트푸드 -->
    <section id="fastfoodAdsSection" class="category-box mb-16 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">패스트푸드 (CSR)</h2>
        <a href="detail_fastfood.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="fastfoodAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="fastfoodEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
    <!-- 치킨 -->
    <section id="chickenAdsSection" class="category-box mb-16 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">치킨 (CSR)</h2>
        <a href="detail_chicken.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="chickenAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="chickenEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
    <!-- 카페 -->
    <section id="cafeAdsSection" class="category-box mb-16 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">카페 (CSR)</h2>
        <a href="detail_cafe.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="cafeAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="cafeEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
    <!-- 스트리트푸드 -->
    <section id="streetfoodAdsSection" class="category-box mb-16 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">스트리트푸드 (CSR)</h2>
        <a href="detail_streetfood.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="streetfoodAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="streetfoodEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
    <!-- 분식 -->
    <section id="bunsikAdsSection" class="category-box mb-20 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">분식 (CSR)</h2>
        <a href="detail_bunsik.html" class="more-link text-blue-600 font-semibold hover:underline">+더보기</a>
      </div>
      <div id="bunsikAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
      <p id="bunsikEmpty" class="text-center text-gray-500 mt-4 hidden">아직 등록된 가게가 없습니다.</p>
    </section>
  </main>

  <!-- ▣ 푸터 -->
  <div id="footer-container"></div>

  <!-- ▣ 공통 모달 오버레이/모달 (기존 코드 동일) -->
  <div id="modalOverlay" class="fixed inset-0 bg-black bg-opacity-50 z-40 hidden"></div>
  <div id="commonModal" class="fixed inset-0 flex items-center justify-center z-50 hidden">
    <!-- … 모달 내용 생략 (기존과 동일) … -->
  </div>

  <!-- ▣ 스크립트 -->
  <script>
    /* ───────── 공통 컴포넌트 로드 ───────── */
    async function loadComponent(url, target) {
      try {
        const r = await fetch(url);
        document.getElementById(target).innerHTML = await r.text();
      } catch (e) { console.error(url, e); }
    }

    /* ───────── 카드 템플릿 ───────── */
    function createAdCard({ title, category, phone, img }) {
      const d = document.createElement('div');
      d.className = 'bg-white border-2 border-gray-300 shadow-lg rounded-lg p-6 flex flex-col transform transition hover:-translate-y-1 hover:shadow-2xl';
      d.innerHTML = `
        <img src="${img || '/assets/images/no-thumb.png'}" alt="${title}" class="w-full h-40 object-cover rounded mb-4">
        <h3 class="text-xl font-bold text-center mb-1">${title}</h3>
        <p class="text-gray-600 text-center text-sm">${phone || ''}</p>`;
      return d;
    }

    /* ───────── 파워 광고 로드 ───────── */
    async function loadPowerAds() {
      try {
        const r = await fetch('/restaurant/ads');
        const ads = await r.json();
        const grid = document.getElementById('powerAdsGrid');
        const empty = document.getElementById('powerAdsEmpty');
        grid.innerHTML = '';
        if (!ads.length) { empty.classList.remove('hidden'); return; }
        empty.classList.add('hidden');
        ads.slice(0, 4).forEach(a => grid.appendChild(createAdCard({
          title: a.businessName, category: a.category, phone: a.phone, img: a.thumb
        })));
      } catch (e) { console.error(e); }
    }

    /* ───────── 카테고리별 데이터 로드 ───────── */
    async function loadCategoryAds(category, containerId, emptyId) {
      try {
        const r = await fetch('/restaurant/' + encodeURIComponent(category) + '/stores');
        const data = await r.json();
        const box = document.getElementById(containerId);
        const empty = document.getElementById(emptyId);
        box.innerHTML = '';
        if (!data.length) { empty.classList.remove('hidden'); return; }
        empty.classList.add('hidden');
        data.slice(0, 8).forEach(item =>
          box.appendChild(createAdCard({
            title: item.businessName,
            category: item.category,
            phone: item.phone,
            img: item.thumb
          }))
        );
      } catch (e) { console.error(e); }
    }

    /* ───────── 초기화 ───────── */
    document.addEventListener('DOMContentLoaded', async () => {
      await loadComponent('/components/header.html', 'header-container');
      await loadComponent('/components/footer.html', 'footer-container');
      await loadPowerAds();

      const cats = [
        { n: '한식', c: 'koreanAdsContainer', e: 'koreanEmpty' },
        { n: '중식', c: 'chineseAdsContainer', e: 'chineseEmpty' },
        { n: '일식', c: 'japaneseAdsContainer', e: 'japaneseEmpty' },
        { n: '양식', c: 'westernAdsContainer', e: 'westernEmpty' },
        { n: '패스트푸드', c: 'fastfoodAdsContainer', e: 'fastfoodEmpty' },
        { n: '치킨', c: 'chickenAdsContainer', e: 'chickenEmpty' },
        { n: '카페', c: 'cafeAdsContainer', e: 'cafeEmpty' },
        { n: '스트리트푸드', c: 'streetfoodAdsContainer', e: 'streetfoodEmpty' },
        { n: '분식', c: 'bunsikAdsContainer', e: 'bunsikEmpty' }
      ];
      cats.forEach(cfg => loadCategoryAds(cfg.n, cfg.c, cfg.e));

      /* 버튼 스크롤 */
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.addEventListener('click', () => {
          const id = btn.dataset.target;
          document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
        });
      });
    });
  </script>
</body>
</html>
