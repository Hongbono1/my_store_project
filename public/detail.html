<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Í∞ÄÍ≤å ÏÉÅÏÑ∏ ¬∑ 3-ÏÑπÏÖò Î†àÏù¥ÏïÑÏõÉ</title>

    <!-- Tailwind -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />

    <!-- Îã§Ïùå Ïö∞Ìé∏Î≤àÌò∏ API (ÎÇòÏ§ëÏóê Ï£ºÏÜå Í≤ÄÏÉâÏö©) -->
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js" defer></script>

</head>

<body class="bg-gray-100 min-h-screen flex flex-col">
    <!-- ‚îÄ‚îÄ (Ìó§Îçî) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div id="header-placeholder"></div>

    <!-- ‚îÄ‚îÄ Î©îÏù∏ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <main class="container mx-auto px-4 py-8 flex-1">
        <div class="flex flex-col lg:flex-row gap-6">

            <!-- ‚ñ£ 1. ÏôºÏ™Ω : Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îçî + ÏßÄÎèÑ -->
            <section class="flex-1 bg-white p-6 rounded shadow flex flex-col gap-6">
                <!-- üîπ Ïù¥ÎØ∏ÏßÄ Ïä¨ÎùºÏù¥Îçî + Ïç∏ÎÑ§Ïùº -->
                <div class="relative">
                    <div id="sliderWrapper" class="w-full h-64 overflow-hidden relative rounded shadow">
                        <div id="sliderImages" class="flex transition-transform duration-500 ease-in-out h-full"></div>
                    </div>

                    <!-- Î∞©Ìñ• Î≤ÑÌäº - Î∂àÌà¨Î™Ö¬∑ÎùºÏö¥Îìú Í∞úÏÑ† -->
                    <button id="prevBtn"
                        class="absolute left-2 top-1/2 -translate-y-1/2 bg-black text-white rounded-full px-3 py-1 opacity-70 hover:opacity-100 z-10">‚Äπ</button>
                    <button id="nextBtn"
                        class="absolute right-2 top-1/2 -translate-y-1/2 bg-black text-white rounded-full px-3 py-1 opacity-70 hover:opacity-100 z-10">‚Ä∫</button>

                    <!-- üîπ Ïç∏ÎÑ§Ïùº Ïª®ÌÖåÏù¥ÎÑà -->
                    <div id="thumbBox" class="flex gap-2 justify-center mt-3"></div>
                </div>


                <!-- ÏßÄÎèÑ -->
                <div class="bg-gray-50 border rounded-lg p-4 flex-1">
                    <h2 class="text-lg font-semibold mb-2">Í∞ÄÍ≤å ÏúÑÏπò</h2>
                    <p id="addressText" class="text-sm text-gray-700 mb-2"></p>
                    <div id="map" class="w-full h-40 bg-gray-200 flex items-center justify-center text-gray-600">
                        ÏßÄÎèÑ Î°úÎìú Ï§ë‚Ä¶
                    </div>
                </div>
            </section>

            <!-- ‚ñ£ 2. Í∞ÄÏö¥Îç∞ : ÏÉÅÌò∏¬∑Ï†ïÎ≥¥¬∑ÏÑ§Î™Ö -->
            <section class="flex-1 bg-white p-6 rounded shadow flex flex-col gap-4">
                <h2 id="businessNameHeader" class="text-3xl font-bold text-center border-b pb-3"></h2>

                <div>
                    <p id="businessType" class="text-lg"></p>
                    <p id="deliveryOption" class="text-lg"></p>
                    <p id="businessHours" class="text-lg"></p>
                </div>

                <div class="bg-gray-50 p-4 rounded border">
                    <h3 class="text-xl font-bold mb-2">ÏÑúÎπÑÏä§ ÎÇ¥Ïö©</h3>
                    <p id="serviceDetails" class="text-gray-700"></p>
                </div>

                <div class="bg-gray-50 p-4 rounded border">
                    <h3 class="text-xl font-bold mb-2">Ïù¥Î≤§Ìä∏</h3>
                    <ul id="eventsList" class="list-disc pl-6 space-y-1"></ul>
                </div>

                <div class="bg-gray-50 p-4 rounded border">
                    <h3 class="text-xl font-bold mb-2">Í∏∞ÌÉÄ Ï†ïÎ≥¥</h3>
                    <ul id="infoEtcList" class="list-disc pl-6 space-y-1"></ul>
                </div>

                <div class="bg-gray-50 p-4 rounded border">
                    <h3 class="text-xl font-bold mb-2">Ï∂îÍ∞Ä Ï†ïÎ≥¥</h3>
                    <ul id="additionalInfoList" class="list-disc pl-6 space-y-1"></ul>
                </div>

                <div class="bg-gray-50 p-4 rounded border">
                    <h3 class="text-xl font-bold mb-2 border-b pb-1">Ïó∞ÎùΩÏ≤ò</h3>
                    <p id="contactPhone" class="text-gray-700"></p>
                    <p id="contactHomepage" class="text-gray-700"></p>
                    <p id="contactInstagram" class="text-gray-700"></p>
                    <p id="contactFacebook" class="text-gray-700"></p>
                </div>

                <div class="bg-gray-50 p-4 rounded border">
                    <h3 class="text-xl font-bold mb-2 border-b pb-1">Ï∂îÍ∞Ä ÏÑ§Î™Ö</h3>
                    <p id="additionalDesc" class="text-gray-700"></p>
                </div>
            </section>

            <!-- ‚ñ£ 3. Ïò§Î•∏Ï™Ω : Î©îÎâ¥ + Ïû•Î∞îÍµ¨Îãà(ÏÉÅÏãú ÌëúÏãú) -->
            <section class="w-full lg:w-1/3 flex flex-col gap-4">
                <!-- Î©îÎâ¥ -->
                <div id="menuBox" class="flex-1 bg-white border rounded p-4 shadow overflow-auto max-h-[600px]">
                    <h2 class="text-xl font-bold mb-4">Î©îÎâ¥</h2>
                    <ul id="menuList" class="grid grid-cols-2 lg:grid-cols-3 gap-4"></ul>
                </div>

                <!-- Ïû•Î∞îÍµ¨Îãà -->
                <div id="cartBox" class="bg-white border rounded p-4 shadow">
                    <h3 class="text-xl font-bold mb-2">üõí Ïû•Î∞îÍµ¨Îãà</h3>
                    <ul id="cartList" class="space-y-2 max-h-60 overflow-auto"></ul>
                    <div class="border-t mt-3 pt-3 text-right">
                        <p class="font-semibold">Ï¥ùÌï©: <span id="totalPrice">0</span>Ïõê</p>
                        <button id="checkoutBtn"
                            class="mt-2 w-full bg-blue-500 hover:bg-blue-600 text-white py-2 rounded">
                            Í≤∞Ï†úÌïòÍ∏∞
                        </button>
                    </div>
                </div>
            </section>

        </div><!-- //flex -->
    </main>

    <!-- ‚îÄ‚îÄ (Ìë∏ÌÑ∞) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ -->
    <div id="footer-placeholder"></div>

    <script type="module">
        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 0. Í≥µÌÜµ Ìó¨Ìçº ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        const $ = (id) => document.getElementById(id);
        const params = new URLSearchParams(location.search);
        const storeId = params.get("id") || 1;

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 1. Ìó§Îçî ¬∑ Ìë∏ÌÑ∞ ÏÇΩÏûÖ ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        window.addEventListener("DOMContentLoaded", () => {
            fetch("/components/header.html")
                .then(r => r.text())
                .then(html => { $("header-placeholder").innerHTML = html; });

            fetch("/components/footer.html")
                .then(r => r.text())
                .then(html => { $("footer-placeholder").innerHTML = html; });
        });

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 2. Kakao SDK ÎèôÏ†Å Î°úÎìú ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        function loadKakaoSdk() {
            console.log("üì¶ Kakao SDK Î°úÎî© ÏãúÏûë");
            return fetch("/kakao-key")
                .then(r => r.json())
                .then(({ key }) => new Promise((resolve, reject) => {
                    if (!key) {
                        console.error("‚ùå Kakao key not found");
                        return reject("Kakao key not found");
                    }

                    const s = document.createElement("script");
                    s.src = `https://dapi.kakao.com/v2/maps/sdk.js?appkey=${key}&autoload=false&libraries=services,clusterer`;
                    s.defer = true;

                    s.onload = () => {
                        console.log("‚úÖ Kakao SDK script Î°úÎìú ÏôÑÎ£å");
                        kakao.maps.load(() => {
                            console.log("‚úÖ kakao.maps.load Ïã§Ìñâ ÏôÑÎ£å");
                            resolve();
                        });
                    };

                    s.onerror = () => {
                        console.error("‚ùå Kakao SDK script Î°úÎî© Ïã§Ìå®");
                        reject("Kakao SDK load error");
                    };

                    document.head.appendChild(s);
                }));
        }

        /* ‚úÖ initMap Ìï®Ïàò Ï∂îÍ∞Ä ------------------------------ */
        async function initMap(storeAddress, storeName = "") {
            try {
                await loadKakaoSdk();

                const geocoder = new kakao.maps.services.Geocoder();
                geocoder.addressSearch(storeAddress, (result, status) => {
                    if (status !== kakao.maps.services.Status.OK) {
                        console.warn("‚ùå Ï£ºÏÜå Í≤ÄÏÉâ Ïã§Ìå®:", status);
                        return;
                    }

                    const coords = new kakao.maps.LatLng(result[0].y, result[0].x);
                    const map = new kakao.maps.Map(document.getElementById("map"), {
                        center: coords,
                        level: 3
                    });

                    new kakao.maps.Marker({ map, position: coords });

                    new kakao.maps.InfoWindow({
                        map,
                        position: coords,
                        content: `<div style="padding:5px">${storeName}</div>`
                    });

                    document.getElementById("addressText").textContent = storeAddress;
                });
            } catch (e) {
                console.error("ÏßÄÎèÑ Ï¥àÍ∏∞Ìôî Ïò§Î•ò:", e);
            }
        }

        const slider = {                // üîπ Ïç∏ÎÑ§Ïùº Í∏∞Îä• Ìè¨Ìï®
            imgs: [],
            idx: 0,

            init(arr) {
                this.imgs = arr.length
                    ? arr
                    : ["/images/no-image.png"];
                $("sliderImages").innerHTML = this.imgs
                    .map(u => `<img src="${u}" class="w-full h-64 flex-shrink-0 object-cover" />`)
                    .join("");
                this.renderThumbs();
                this.update();
                $("prevBtn").onclick = () => this.move(-1);
                $("nextBtn").onclick = () => this.move(1);
            },

            renderThumbs() {
                const box = $("thumbBox"); box.innerHTML = "";
                this.imgs.forEach((src, i) => {
                    const t = document.createElement("img");
                    t.src = src;
                    t.className = "w-16 h-16 object-cover rounded cursor-pointer border hover:opacity-80";
                    t.onclick = () => { this.idx = i; this.update(); };
                    box.appendChild(t);
                });
            },

            move(step) {
                this.idx = (this.idx + step + this.imgs.length) % this.imgs.length;
                this.update();
            },

            update() {
                $("sliderImages").style.transform = `translateX(${-this.idx * 100}%)`;
                [...$("thumbBox").children].forEach((el, i) => {
                    el.classList.toggle("ring-2", i === this.idx);
                    el.classList.toggle("ring-blue-500", i === this.idx);
                });
            }
        };

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 4. Ïû•Î∞îÍµ¨Îãà ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        const cart = [];
        function addToCart(item) { cart.push(item); renderCart(); }
        function renderCart() {
            const ul = $("cartList"); ul.innerHTML = "";
            let sum = 0;
            cart.forEach(({ menuName, menuPrice }) => {
                sum += Number(menuPrice);
                const li = document.createElement("li");
                li.className = "flex justify-between text-sm";
                li.innerHTML = `<span>${menuName}</span><span>${Number(menuPrice).toLocaleString()}Ïõê</span>`;
                ul.appendChild(li);
            });
            $("totalPrice").textContent = sum.toLocaleString();
        }

        /* Î¶¨Ïä§Ìä∏ Ï∂úÎ†• Ìó¨Ìçº */
        const setList = (wrapId, arr = []) => {
            const ul = $(wrapId); ul.innerHTML = "";
            arr.forEach(t => {
                const li = document.createElement("li");
                li.textContent = t;
                ul.appendChild(li);
            });
        };

        /* ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ 5. Î©îÏù∏ Ïã§Ìñâ (async IIFE) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
        (async () => {
            try {
                /* 5-1 Kakao SDK Î®ºÏ†Ä Ï§ÄÎπÑ */
                await loadKakaoSdk();

                /* 5-2 Í∞ÄÍ≤å Îç∞Ïù¥ÌÑ∞ Í∞ÄÏ†∏Ïò§Í∏∞ */
                const res = await fetch(`/store/${storeId}`);
                if (!res.ok) throw new Error("Store API error");
                const { store, menu = [] } = await res.json();


                /* 5-3 Ïä¨ÎùºÏù¥Îçî ¬∑ Í∏∞Î≥∏ Ï†ïÎ≥¥ */
                slider.init(store.images || []);
                console.log("‚ñ∂ store", store);

                $("businessNameHeader").textContent = store.businessName ?? "ÏÉÅÌò∏Î™Ö ÏóÜÏùå";
                $("businessType").innerHTML = `<strong>ÏóÖÏ¢Ö:</strong> ${store.businessType ?? ""}`;
                $("deliveryOption").innerHTML = `<strong>Î∞∞Îã¨:</strong> ${store.deliveryOption ?? ""}`;
                $("businessHours").innerHTML = `<strong>ÏòÅÏóÖÏãúÍ∞Ñ:</strong> ${store.businessHours ?? ""}`;
                $("serviceDetails").textContent = store.serviceDetails ?? "";

                /* Í≥†Í∞ù Ïù¥Î≤§Ìä∏ */
                setList("eventsList", store.events);  // Í∑∏ÎåÄÎ°ú ÏÇ¨Ïö©

                /* ‚îÄ‚îÄ ‚ÄòÏ∂îÍ∞Ä Ï†ïÎ≥¥(Í∏∞ÌÉÄ)‚Äô ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
                const infoList = $("infoEtcList");    // ‚Üê Î∞îÎÄê ID
                if (infoList) {
                    infoList.innerHTML = `
                      <li>Ïû•Ïï†Ïù∏ Ìé∏ÏùòÏãúÏÑ§: ${store.facility ?? "Ï†ïÎ≥¥ ÏóÜÏùå"}</li>
                      <li>Î∞òÎ†§ÎèôÎ¨º Ï∂úÏûÖ:   ${store.pets ?? "Ï†ïÎ≥¥ ÏóÜÏùå"}</li>
                      <li>Ï£ºÏ∞® Ï†ïÎ≥¥:       ${store.parking ?? "Ï†ïÎ≥¥ ÏóÜÏùå"}</li>
                    `;
                }

                /* ‚îÄ‚îÄ Ïó∞ÎùΩÏ≤ò ¬∑ ÌôàÌéòÏù¥ÏßÄ ¬∑ SNS ¬∑ Ï∂îÍ∞Ä ÏÑ§Î™Ö ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ */
                if ($("contactPhone"))
                    $("contactPhone").textContent = store.contactPhone ?? "";

                // ÌôàÌéòÏù¥ÏßÄ
                if ($("contactHomepage")) {
                    $("contactHomepage").innerHTML = store.homepage
                        ? `<strong>ÌôàÌéòÏù¥ÏßÄ:</strong> <a href="${store.homepage}" class="text-blue-600 underline" target="_blank">${store.homepage}</a>`
                        : "";
                }

                // Ïù∏Ïä§ÌÉÄÍ∑∏Îû®
                if ($("contactInstagram")) {
                    $("contactInstagram").innerHTML = store.instagram
                        ? `<strong>Ïù∏Ïä§ÌÉÄÍ∑∏Îû®:</strong> <a href="${store.instagram}" class="text-blue-600 underline" target="_blank">${store.instagram}</a>`
                        : "";
                }

                // ÌéòÏù¥Ïä§Î∂Å
                if ($("contactFacebook")) {
                    $("contactFacebook").innerHTML = store.facebook
                        ? `<strong>ÌéòÏù¥Ïä§Î∂Å:</strong> <a href="${store.facebook}" class="text-blue-600 underline" target="_blank">${store.facebook}</a>`
                        : "";
                }

                /* Ï∂îÍ∞Ä ÏÑ§Î™Ö */
                if ($("additionalDesc"))
                    $("additionalDesc").textContent = store.additionalDesc ?? "";


                /* 5-4 Î©îÎâ¥ ‚Üí Ïû•Î∞îÍµ¨Îãà */
                const menuList = $("menuList");
                menuList.innerHTML = "";
                menuList.className = "grid grid-cols-2 lg:grid-cols-3 gap-4";

                menu.forEach(it => {
                    const box = document.createElement("div");
                    box.className = "flex items-center gap-4 p-3 border rounded hover:shadow w-[320px] shrink-0";

                    box.innerHTML = `
                        <img src="${it.menuImageUrl || '/images/no-thumb.png'}"
                             alt="${it.menuName}" class="w-20 h-20 object-cover rounded-md" />

                        <div class="flex-1 min-w-0">
                            <div class="text-base font-semibold truncate">${it.menuName}</div>
                            <div class="text-gray-600">${Number(it.menuPrice).toLocaleString()}Ïõê</div>
                        </div>

                        <button class="addBtn px-3 py-1 bg-blue-600 text-white text-sm rounded">Îã¥Í∏∞</button>
                    `;

                    box.querySelector(".addBtn").onclick = () => addToCart(it);
                    menuList.appendChild(box);
                });


                /* 5-5 Kakao ÏßÄÎèÑ ÌëúÏãú (Í∏∞Ï°¥ ÏßÄÏò§ÏΩîÎî© Î∏îÎ°ù) */
                const geocoder = new kakao.maps.services.Geocoder();
                geocoder.addressSearch(store.address, (result, status) => {
                    console.log("üìçÏ£ºÏÜå:", store.address);       // Ï£ºÏÜå ÌôïÏù∏
                    console.log("üó∫Ô∏èÏßÄÏò§ÏΩîÎî© Í≤∞Í≥º:", result);     // Ï¢åÌëú Í≤∞Í≥º Î∞∞Ïó¥
                    console.log("üì°ÏÉÅÌÉú ÏΩîÎìú:", status);         // ÏùëÎãµ ÏÉÅÌÉú ÏΩîÎìú

                    if (status !== kakao.maps.services.Status.OK) {
                        console.warn("‚ùå ÏßÄÏò§ÏΩîÎî© Ïã§Ìå®: ÏÉÅÌÉú =", status);
                        return;
                    }

                    const coords = new kakao.maps.LatLng(result[0].y, result[0].x);
                    const map = new kakao.maps.Map($("map"), { center: coords, level: 3 });
                    new kakao.maps.Marker({ map, position: coords });
                    new kakao.maps.InfoWindow({
                        map, position: coords,
                        content: `<div style="padding:5px">${store.businessName}</div>`
                    });
                    $("addressText").textContent = store.address;
                });

                // ‚úÖ Ï£ºÏÜå Ï†ïÏ†ú
                function cleanAddress(fullAddress) {
                    let cleaned = fullAddress.replace(/^\d{5}\s*/, "");   // ÏïûÏûêÎ¶¨ Ïö∞Ìé∏Î≤àÌò∏ Ï†úÍ±∞
                    cleaned = cleaned.replace(/\s+\d+$/, "");             // ÎÅùÏûêÎ¶¨ ÏÉÅÏÑ∏Ï£ºÏÜå Ï†úÍ±∞
                    return cleaned.trim();
                }

                const mapAddress = cleanAddress(store.address);
                initMap(mapAddress, store.businessName);

                /* ‚úÖ initMap Î≥ÑÎèÑ Ìò∏Ï∂ú Ï∂îÍ∞Ä (Ìï®Ïàò Ïù¥Îèô ÏöîÍµ¨ Î∞òÏòÅ) */
                initMap(store.address, store.businessName);

            } catch (err) {
                console.error("Î°úÎìú Ïò§Î•ò:", err);
                // ÏóêÎü¨ Î∞úÏÉù Ïãú Ïä¨ÎùºÏù¥ÎçîÏóê Í∏∞Î≥∏ Ïù¥ÎØ∏ÏßÄ ÏÇΩÏûÖ
                const sliderImages = $("sliderImages");
                if (sliderImages) {
                    sliderImages.innerHTML = `
                      <img src="/images/no-image.png"
                           class="w-full h-64 flex-shrink-0 object-cover" />
                 `;
                }
            }
        })();
    </script>

</body>

</html>