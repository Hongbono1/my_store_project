<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ê°€ì¥ í•«í•œ ìš°ë¦¬ë™ë„¤(ëª¨ë‹¬ ì—°ê²°)</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50">
  <!-- Header (JSP ì¸í´ë£¨ë“œ) -->
  <jsp:include page="components/header.html" />

  <!-- ëª¨ë‹¬ HTML (ì •ì  ì¸í´ë£¨ë“œ) -->
  <jsp:include page="modal/modal.html" />

  <!-- ì „ì²´ ì»¨í…Œì´ë„ˆ -->
  <div class="max-w-screen-xl mx-auto px-4 sm:px-8 mt-10">
    <!-- ê°€ì¥ í•«í•œ ìš°ë¦¬ë™ë„¤ ì„¹ì…˜ -->
    <section class="bg-white shadow-lg rounded-lg p-6 border-2 border-gray-300 mb-12">
      <h2 class="text-3xl font-bold mb-6 text-center text-gray-800">ê°€ì¥ í•«í•œ ìš°ë¦¬ë™ë„¤</h2>
      <div id="hotNeighborhoodBoxes" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- ìŠ¬ë¼ì´ë“œ ì˜ì—­ -->
    <section
      class="relative w-full max-w-screen-lg mx-auto overflow-hidden border border-gray-300 rounded-lg mt-8 px-4 mb-9">
      <div id="sliderContainer" class="flex transition-transform duration-500 h-48 items-center"></div>
      <button id="prevBtn"
        class="absolute left-4 top-1/2 transform -translate-y-1/2 bg-gray-700 text-white p-3 rounded-full hover:bg-gray-900 transition z-[9999]">
        &lt;
      </button>
      <button id="nextBtn"
        class="absolute right-4 top-1/2 transform -translate-y-1/2 bg-gray-700 text-white p-3 rounded-full hover:bg-gray-900 transition z-[9999]">
        &gt;
      </button>
    </section>

    <!-- ì¶”ì²œ ê°€ê²Œ ì„¹ì…˜ -->
    <section class="bg-white shadow-lg rounded-lg p-6 border-2 border-gray-300">
      <h2 class="text-3xl font-bold mb-6 text-center text-gray-800">ì¶”ì²œ ê°€ê²Œ</h2>
      <div class="grid grid-cols-1 lg:grid-cols-5 gap-6 items-stretch">
        <!-- ì¢Œì¸¡ ì´ë¯¸ì§€ ë°•ìŠ¤: ë§Œí™” ì´ë¯¸ì§€ -->
        <div class="lg:col-span-1 flex flex-col gap-6 h-full">
          <div class="flex-1 overflow-hidden border-2 border-gray-300 rounded-lg shadow-lg">
            <img src="https://via.placeholder.com/300x400?text=ë§Œí™”1" alt="ë§Œí™” ì´ë¯¸ì§€ ìƒë‹¨"
              class="w-full h-full object-cover" />
          </div>
          <div class="flex-1 overflow-hidden border-2 border-gray-300 rounded-lg shadow-lg">
            <img src="https://via.placeholder.com/300x400?text=ë§Œí™”2" alt="ë§Œí™” ì´ë¯¸ì§€ í•˜ë‹¨"
              class="w-full h-full object-cover" />
          </div>
        </div>
        <!-- ì˜¤ë¥¸ìª½ ê´‘ê³  ë¦¬ìŠ¤íŠ¸ -->
        <div id="recommendedStoreContainer" class="lg:col-span-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        </div>
      </div>
    </section>
  </div>

  <!-- Footer (JSP ì¸í´ë£¨ë“œ) -->
  <jsp:include page="components/footer.html" />

  <!-- ëª¨ë‹¬ JS (ì •ì  í¬í•¨) -->
  <script src="modal/modal.js"></script>


  <script>
    /* ------------------- ì¹´ë“œÂ·ìŠ¬ë¡¯ ìƒì„± ------------------- */
    // ë°ì´í„° ì¹´ë“œ
    function createAdCard(ad) {
      const box = document.createElement("div");
      box.className =
        "ad-card bg-white shadow-lg rounded-lg p-6 flex flex-col border-2 border-gray-300 " +
        "transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl";
      box.innerHTML = `
    <img src="${ad.thumb}" alt="${ad.businessName}"
         class="h-40 w-full object-cover rounded mb-4 cursor-pointer" />
    <h3 class="font-semibold text-lg mb-1 cursor-pointer">${ad.businessName}</h3>
    <button class="go-detail mt-auto bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600">
      ë°”ë¡œê°€ê¸°
    </button>
  `;
      [box.querySelector("img"), box.querySelector("h3"), box.querySelector(".go-detail")]
        .forEach(el => el.addEventListener("click",
          () => window.location.href = `/detail.html?id=${ad.id}`));
      return box;
    }

    // ë¹ˆ ìŠ¬ë¡¯ ì¹´ë“œ
    function createEmptyCard() {
      const box = document.createElement("div");
      box.className =
        "bg-white border-2 border-gray-300 rounded-lg p-6 flex flex-col " +
        "items-center justify-center text-gray-400 opacity-50 h-64";
      box.innerHTML = `
    <div class="mb-4 h-40 w-full bg-gray-100 rounded animate-pulse"></div>
    <h3 class="font-semibold text-lg mb-1">ì •ë³´ ì—†ìŒ</h3>
    <button disabled
      class="mt-auto bg-gray-300 text-white py-2 px-4 rounded cursor-not-allowed">
      ëŒ€ê¸° ì¤‘
    </button>`;
      return box;
    }

    /* ------------------- ê³µí†µ ë Œë”ë§ ------------------- */
    function renderAdBoxes(containerId, ads, totalSlots = 8) {
      const c = document.getElementById(containerId);
      c.innerHTML = "";
      for (let i = 0; i < totalSlots; i++) {
        if (i < ads.length) c.appendChild(createAdCard(ads[i]));
        else c.appendChild(createEmptyCard());
      }
    }

    /* ------------------- ì •ì  ì¶”ì²œ ê°€ê²Œ ------------------- */
    const recommendedStoreAds = [
      { id: 101, businessName: "ë¯¸ìŠ¤í„°í”¼ì", phone: "010-1111-2222", thumb: "https://via.placeholder.com/300x200" },
      { id: 102, businessName: "ë„ë¯¸ë…¸í”¼ì", phone: "010-2222-3333", thumb: "https://via.placeholder.com/300x200" },
      { id: 103, businessName: "ë²„ê±°í‚¹", phone: "010-3333-4444", thumb: "https://via.placeholder.com/300x200" },
      { id: 104, businessName: "ë¡¯ë°ë¦¬ì•„", phone: "010-4444-5555", thumb: "https://via.placeholder.com/300x200" },
      { id: 105, businessName: "íƒì•¤íƒìŠ¤", phone: "010-5555-6666", thumb: "https://via.placeholder.com/300x200" },
      { id: 106, businessName: "ì—”ì œë¦¬ë„ˆìŠ¤", phone: "010-6666-7777", thumb: "https://via.placeholder.com/300x200" },
      { id: 107, businessName: "íŒŒë¦¬ë°”ê²Œëœ¨", phone: "010-7777-8888", thumb: "https://via.placeholder.com/300x200" },
      { id: 108, businessName: "ëšœë ˆì¥¬ë¥´", phone: "010-8888-9999", thumb: "https://via.placeholder.com/300x200" }
    ];

    /* ------------------- í˜ì´ì§€ ë¡œë“œ ------------------- */
    document.addEventListener("DOMContentLoaded", async () => {
      /* 1) í•« ì„¹ì…˜ â”€ ì—ëŸ¬ê°€ ë‚˜ë„ ë¹ˆ ë°°ì—´ë¡œ ë„˜ì–´ê° */
      let hotAds = [];
      try {
        const res = await fetch("/hot/api");
        if (res.ok) hotAds = await res.json();
      } catch (err) {
        console.error("ğŸ”¥ hot api error:", err);
      }
      renderAdBoxes("hotNeighborhoodBoxes", hotAds);

      /* 2) ì¶”ì²œ ì„¹ì…˜ (ì •ì ) */
      renderAdBoxes("recommendedStoreContainer", recommendedStoreAds);

      /* 3) ìŠ¬ë¼ì´ë”Â·ëª¨ë‹¬ */
      initSlider();
      bindModal();
    });
  </script>


</body>

</html>