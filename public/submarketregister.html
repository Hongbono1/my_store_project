<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <title>오픈예정 등록</title>
</head>

<body class="bg-gray-100 min-h-screen">
    <!-- 헤더 -->
    <div id="header-container"></div>

    <!-- 본문 컨테이너 -->
    <div class="container mx-auto px-4 py-8">
        <div class="bg-white shadow-lg rounded-2xl overflow-hidden">
            <!-- 상단 타이틀 -->
            <div class="bg-blue-600 text-white py-6 px-8">
                <h1 class="text-2xl font-bold">오픈예정 등록</h1>
            </div>
            <!-- 2단 그리드 -->
            <div class="grid grid-cols-4 gap-6 p-8">
                <!-- 좌측 메뉴 -->
                <aside class="col-span-1 border-r pr-4">
                    <nav class="space-y-2 text-gray-700">
                        <a href="#" class="block px-3 py-2 hover:bg-gray-100 rounded">기본 정보</a>
                        <a href="#" class="block px-3 py-2 hover:bg-gray-100 rounded">영업시간</a>
                        <a href="#" class="block px-3 py-2 hover:bg-gray-100 rounded">위치/지도</a>
                        <a href="#" class="block px-3 py-2 hover:bg-gray-100 rounded">이미지 업로드</a>
                        <a href="#" class="block px-3 py-2 hover:bg-gray-100 rounded">기타</a>
                    </nav>
                </aside>
                <!-- 우측 등록 폼 -->
                <main class="col-span-3">
                    <form id="openForm" class="space-y-6" enctype="multipart/form-data">
                        <!-- 상호명 -->
                        <div>
                            <label class="block font-medium mb-1">상호명 <span class="text-red-500">*</span></label>
                            <input name="store_name" type="text" class="w-full border rounded px-3 py-2"
                                placeholder="가게 이름을 입력하세요" required>
                        </div>
                        <!-- 오픈일 -->
                        <div>
                            <label class="block font-medium mb-1">오픈일 <span class="text-red-500">*</span></label>
                            <input name="open_date" type="date" class="w-full border rounded px-3 py-2" required>
                        </div>
                        <!-- 업종(카테고리) -->
                        <div>
                            <label class="block font-medium mb-1">업종(카테고리) <span class="text-red-500">*</span></label>
                            <select name="category" class="w-full border rounded px-3 py-2" required>
                                <option value="">선택하세요</option>
                                <option value="한식">한식</option>
                                <option value="분식">분식</option>
                                <option value="양식">양식</option>
                                <option value="카페">카페</option>
                                <!-- 필요시 추가 -->
                            </select>
                        </div>
                        <!-- 전화번호 -->
                        <div>
                            <label class="block font-medium mb-1">전화번호</label>
                            <input name="phone" type="tel" class="w-full border rounded px-3 py-2" placeholder="숫자만 입력">
                        </div>
                        <!-- 영업시간 -->
                        <div>
                            <label class="block font-medium mb-1">영업시간</label>
                            <input name="open_time" type="text" class="w-full border rounded px-3 py-2"
                                placeholder="예: 10:00~22:00">
                        </div>
                        <!-- 주소 -->
                        <div>
                            <label class="block font-medium mb-1">주소 <span class="text-red-500">*</span></label>
                            <input name="address" type="text" class="w-full border rounded px-3 py-2" required>
                        </div>
                        <!-- 위치 지도 (예시: 이미지 업로드) -->
                        <div>
                            <label class="block font-medium mb-1">가게 대표 이미지</label>
                            <input name="image1" type="file" class="w-full border rounded px-3 py-2 bg-white">
                        </div>
                        <!-- 소개/설명 -->
                        <div>
                            <label class="block font-medium mb-1">가게 소개</label>
                            <textarea name="description" rows="3" class="w-full border rounded px-3 py-2"></textarea>
                        </div>
                        <!-- 제출 버튼 -->
                        <div class="text-center">
                            <button type="submit"
                                class="bg-blue-600 text-white font-bold px-8 py-3 rounded-lg hover:bg-blue-700 transition">등록하기</button>
                        </div>
                    </form>
                </main>
            </div>
        </div>
    </div>

    <!-- 푸터 -->
    <div id="footer-container"></div>

    <!-- 스크립트: 헤더/푸터 로드 및 폼 처리 -->
    <script>
        // 헤더/푸터 동적 로드
        ['header', 'footer'].forEach(name => {
            fetch(`/components/${name}.html`)
                .then(res => res.text())
                .then(html => {
                    document.getElementById(`${name}-container`).innerHTML = html;
                });
        });

        // 폼 제출
        const form = document.getElementById('openForm');
        form.addEventListener('submit', async e => {
            e.preventDefault();
            const formData = new FormData(form);
            try {
                const res = await fetch('https://www.hongbono1.com/store', {
                    method: 'POST',
                    body: formData
                });
                const data = await res.json();
                if (data.success) {
                    alert('등록이 완료되었습니다!');
                    if (data.id) {
                        window.location.href = `/detail.html?id=${data.id}`;
                    }
                } else {
                    alert('등록 실패: ' + (data.error || '알 수 없는 오류'));
                }
            } catch (err) {
                console.error(err);
                alert('서버와 통신 중 오류가 발생했습니다.');
            }
        });
    </script>
</body>

</html>