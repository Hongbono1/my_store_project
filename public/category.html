<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>광고 홈페이지 - 한식 </title>
  <!-- Tailwind CSS -->
  <link rel="stylesheet" href="/assets/css/tailwind.css" />
  />
  <style>
    .header-content {
      gap: 1rem;
    }

    .nav-links a {
      transition: color 0.3s ease;
    }

    footer p {
      font-size: 0.875rem;
    }
  </style>
</head>

<body class="bg-gray-50">
  <!-- 헤더 (JSP 인클루드로 불러옴) -->
  <jsp:include page="components/header.html" />

  <!-- 기존 모달 코드 삭제 (모달 인클루드는 제거) -->
  <!-- 모달 컨테이너: 동적으로 모달 HTML과 JS를 로드할 영역 -->
  <div id="modal-container"></div>

  <!-- 메인 콘텐츠 -->
  <main class="w-full max-w-screen-xl mx-auto px-4 sm:px-8 mt-8">
    <!-- 상단 섹션: 병원 배경/타이틀 -->
    <section class="bg-gradient-to-r from-gray-800 to-blue-500 text-white p-6 rounded-lg shadow mb-8">
      <h1 class="text-4xl sm:text-5xl font-bold mb-2">한식</h1>
      <p class="text-lg sm:text-xl">우리동네 한식 맛집을 소개합니다</p>
    </section>

    <!-- 스크롤 버튼 (카테고리 선택 영역) -->
    <section id="categorySelection" class="bg-white p-4 rounded-lg shadow border border-gray-300 mt-8 mb-8">
      <div class="bg-blue-100 p-6 rounded-lg">
        <h2 class="text-2xl font-bold mb-6">스크롤 선택</h2>
        <div class="flex overflow-x-auto space-x-3 py-3">
          <!-- 밥 -->
          <button
            class="category-btn bg-white text-[#2C3E50] font-medium px-5 py-2 text-lg rounded-full border border-[#748CAB] shadow-md hover:bg-[#7F9BBF] transition"
            data-category="밥">밥 (비빔밥/덮밥/백반)</button>

          <!-- 찌개/탕 -->
          <button
            class="category-btn bg-white text-[#2C3E50] font-medium px-5 py-2 text-lg rounded-full border border-[#748CAB] shadow-md hover:bg-[#7F9BBF] transition"
            data-category="찌개/탕">찌개/탕/국</button>

          <!-- 고기/구이 -->
          <button
            class="category-btn bg-white text-[#2C3E50] font-medium px-5 py-2 text-lg rounded-full border border-[#748CAB] shadow-md hover:bg-[#7F9BBF] transition"
            data-category="고기/구이">고기/구이 (제육볶음)</button>

          <!-- 생선 -->
          <button
            class="category-btn bg-white text-[#2C3E50] font-medium px-5 py-2 text-lg rounded-full border border-[#748CAB] shadow-md hover:bg-[#7F9BBF] transition"
            data-category="생선">생선</button>

          <!-- 족발/보쌈 -->
          <button
            class="category-btn bg-white text-[#2C3E50] font-medium px-5 py-2 text-lg rounded-full border border-[#748CAB] shadow-md hover:bg-[#7F9BBF] transition"
            data-category="족발/보쌈">족발/보쌈</button>

          <!-- 국밥 -->
          <button
            class="category-btn bg-white text-[#2C3E50] font-medium px-5 py-2 text-lg rounded-full border border-[#748CAB] shadow-md hover:bg-[#7F9BBF] transition"
            data-category="국밥">국밥</button>

          <!-- 반찬 -->
          <button
            class="category-btn bg-white text-[#2C3E50] font-medium px-5 py-2 text-lg rounded-full border border-[#748CAB] shadow-md hover:bg-[#7F9BBF] transition"
            data-category="반찬">반찬</button>

          <!-- 기타 -->
          <button
            class="category-btn bg-white text-[#2C3E50] font-medium px-5 py-2 text-lg rounded-full border border-[#748CAB] shadow-md hover:bg-[#7F9BBF] transition"
            data-category="기타">기타</button>
        </div>
      </div>
    </section>

    <!-- 파워 광고 (SSR 시뮬레이션) - 4개 광고 박스 -->
    <section id="powerAdsSection" class="bg-yellow-50 border-4 border-yellow-400 shadow-lg rounded-lg p-6">
      <h2 class="text-2xl font-bold mb-4">파워 광고</h2>
      <div id="powerAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
        <div
          class="ad-card relative bg-yellow-50 border-4 border-yellow-400 shadow-lg rounded-lg p-6 flex flex-col transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl"
          data-title="파워 광고 1" data-phone="010-1111-2222" data-category="식당"
          data-img="https://via.placeholder.com/300x200/111111" data-events="신규 할인" data-facilities="휠체어 접근 가능"
          data-parking="무료 주차">
          <div class="absolute top-2 right-2 bg-red-500 text-white px-2 py-1 text-xs rounded">파워광고</div>
          <img src="https://via.placeholder.com/300x200/111111" alt="파워 광고 1"
            class="h-40 w-full object-cover rounded mb-4" />
          <h2 class="text-2xl font-bold text-center mb-2">파워 광고 1</h2>
          <h3 class="text-xl font-semibold text-center text-gray-700">식당</h3>
          <p class="text-lg text-gray-500 text-center">010-1111-2222</p>
          <a href="#"
            class="open-modal mt-4 bg-blue-500 text-white py-2 px-4 rounded text-center shadow-lg hover:bg-blue-600">바로가기</a>
        </div>
        <div
          class="ad-card relative bg-yellow-50 border-4 border-yellow-400 shadow-lg rounded-lg p-6 flex flex-col transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl"
          data-title="파워 광고 2" data-phone="010-2222-3333" data-category="식당"
          data-img="https://via.placeholder.com/300x200/222222" data-events="이벤트 중" data-facilities="없음"
          data-parking="유료 주차">
          <div class="absolute top-2 right-2 bg-red-500 text-white px-2 py-1 text-xs rounded">파워광고</div>
          <img src="https://via.placeholder.com/300x200/222222" alt="파워 광고 2"
            class="h-40 w-full object-cover rounded mb-4" />
          <h2 class="text-2xl font-bold text-center mb-2">파워 광고 2</h2>
          <h3 class="text-xl font-semibold text-center text-gray-700">식당</h3>
          <p class="text-lg text-gray-500 text-center">010-2222-3333</p>
          <a href="#"
            class="open-modal mt-4 bg-blue-500 text-white py-2 px-4 rounded text-center shadow-lg hover:bg-blue-600">바로가기</a>
        </div>
        <div
          class="ad-card relative bg-yellow-50 border-4 border-yellow-400 shadow-lg rounded-lg p-6 flex flex-col transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl"
          data-title="파워 광고 3" data-phone="010-3333-4444" data-category="식당"
          data-img="https://via.placeholder.com/300x200/333333" data-events="시즌 할인" data-facilities="휠체어 리프트 있음"
          data-parking="무료 주차">
          <div class="absolute top-2 right-2 bg-red-500 text-white px-2 py-1 text-xs rounded">파워광고</div>
          <img src="https://via.placeholder.com/300x200/333333" alt="파워 광고 3"
            class="h-40 w-full object-cover rounded mb-4" />
          <h2 class="text-2xl font-bold text-center mb-2">파워 광고 3</h2>
          <h3 class="text-xl font-semibold text-center text-gray-700">식당</h3>
          <p class="text-lg text-gray-500 text-center">010-3333-4444</p>
          <a href="#"
            class="open-modal mt-4 bg-blue-500 text-white py-2 px-4 rounded text-center shadow-lg hover:bg-blue-600">바로가기</a>
        </div>
        <div
          class="ad-card relative bg-yellow-50 border-4 border-yellow-400 shadow-lg rounded-lg p-6 flex flex-col transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl"
          data-title="파워 광고 4" data-phone="010-4444-5555" data-category="식당"
          data-img="https://via.placeholder.com/300x200/444444" data-events="특가 행사" data-facilities="없음"
          data-parking="유료 주차">
          <div class="absolute top-2 right-2 bg-red-500 text-white px-2 py-1 text-xs rounded">파워광고</div>
          <img src="https://via.placeholder.com/300x200/444444" alt="파워 광고 4"
            class="h-40 w-full object-cover rounded mb-4" />
          <h2 class="text-2xl font-bold text-center mb-2">파워 광고 4</h2>
          <h3 class="text-xl font-semibold text-center text-gray-700">식당</h3>
          <p class="text-lg text-gray-500 text-center">010-4444-5555</p>
          <a href="#"
            class="open-modal mt-4 bg-blue-500 text-white py-2 px-4 rounded text-center shadow-lg hover:bg-blue-600">바로가기</a>
        </div>
      </div>
    </section>

    <!-- 광고 섹션 예시 (각 카테고리별) -->
    <!-- 밥 -->
    <section id="baekbanSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">밥</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_emergency.html" class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="emergencyAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- 찌게/탕/국 -->
    <section id="jjigaetangSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">찌게/탕/국</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_generalhospital.html"
            class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="generalhospitalAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- 고기/구이 -->
    <section id="gogiguiSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">고기/구이(제육볶음)</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_hospital.html" class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="hospitalAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- 생선 -->
    <section id="fishSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">생선</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_clinic.html" class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="clinicAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- 족발/보쌈 -->
    <section id="noodleSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">족발/보쌈</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_orientalmedicine.html"
            class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="orientalmedicineAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- 국밥 -->
    <section id="snackSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">국밥</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_nursing.html" class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="nursingAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- 반찬 -->
    <section id="soupSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">반찬</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_dentistry.html" class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="dentistryAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- 야식 -->
    <section id="sideSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">야식</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_dentistry.html" class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="orientalAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>

    <!-- 여러가지 -->
    <section id="etcSection" class="mt-8 border-2 border-gray-300 rounded-lg p-6">
      <div class="flex items-center justify-between mb-6">
        <h2 class="text-2xl font-bold">여러가지</h2>
        <div class="flex items-center space-x-6">
          <a href="#" class="home-link text-blue-500 hover:underline font-bold text-lg">🏠 홈</a>
          <a href="detail_dentistry.html" class="more-link text-blue-500 hover:underline font-bold text-lg">+더보기</a>
        </div>
      </div>
      <div id="orientalAdsContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </section>
  </main>

  <!-- 푸터 (JSP 인클루드로 불러옴) -->
  <jsp:include page="components/footer.html" />

  <!-- 모달 관련 기존 코드 삭제 및 새로운 모달 HTML/JS 동적 로드 -->
  <script>
    // 기존 모달이 존재하면 삭제
    const existingModal = document.querySelector("#commonModal");
    if (existingModal) {
      existingModal.remove();
      console.log("기존 모달 삭제 완료");
    }
    // 동적으로 모달 HTML과 JS 로드
    fetch("modal/modal.html")
      .then(response => response.text())
      .then(html => {
        const modalContainer = document.createElement("div");
        modalContainer.id = "modal-container";
        modalContainer.innerHTML = html;
        document.body.appendChild(modalContainer);
        const script = document.createElement("script");
        script.src = "modal/modal.js";
        script.onload = function () {
          console.log("modal.js 로드 완료");
          if (window.populateModal) {
            console.log("populateModal 함수 정상 로드");
          } else {
            console.error("populateModal 함수 로드 실패");
          }
        };
        document.body.appendChild(script);
      })
      .catch(error => console.error("modal.html 로드 실패:", error));
  </script>

  <!-- 광고 및 모달 렌더링 관련 스크립트 -->
  <script>
    /* ───────────────────────────────
        1) 서버에서 요약 데이터 가져오기
       ─────────────────────────────── */
    async function fetchStores() {
      const res = await fetch('/stores');   // ✦ 목록 전용 API
      if (!res.ok) throw new Error('데이터 조회 실패');
      return await res.json();              // [{ id, businessName, thumbnailUrl, category, phone, powerAd, events, facilities, parking }, …]
    }

    /* ───────────────────────────────
        2) 카드 생성 함수
       ─────────────────────────────── */
    function makeCardHTML(ad, isPower) {
      // 카드 공통 dataset (모달용)
      return `
      ${isPower ? '<div class="absolute top-2 right-2 bg-red-500 text-white px-2 py-1 text-xs rounded">파워광고</div>' : ''}
      <img src="${ad.thumbnailUrl}" alt="${ad.businessName}" class="h-40 w-full object-cover rounded mb-4" />
      <h2 class="text-2xl font-bold text-center mb-2">${ad.businessName}</h2>
      <h3 class="text-xl font-semibold text-center text-gray-700">${ad.category}</h3>
      <p class="text-lg text-gray-500 text-center">${ad.phone}</p>
      <a href="#" class="open-modal mt-4 bg-blue-500 text-white py-2 px-4 rounded text-center shadow-lg hover:bg-blue-600">바로가기</a>
    `;
    }

    function createPowerAdCard(ad) {
      const box = document.createElement('div');
      box.className =
        'ad-card relative bg-yellow-50 border-4 border-yellow-400 shadow-lg rounded-lg p-6 flex flex-col transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl';
      box.dataset.title = ad.businessName;
      box.dataset.phone = ad.phone || '';
      box.dataset.img = ad.thumbnailUrl;
      box.dataset.events = ad.events || '';
      box.dataset.facilities = ad.facilities || '';
      box.dataset.parking = ad.parking || '';
      box.dataset.category = ad.category;
      box.innerHTML = makeCardHTML(ad, true);
      return box;
    }

    function createAdCard(ad) {
      const box = document.createElement('div');
      box.className =
        'ad-card bg-white shadow-lg rounded-lg p-6 flex flex-col border-2 border-gray-300 transform transition duration-300 hover:-translate-y-2 hover:shadow-2xl';
      box.dataset.title = ad.businessName;
      box.dataset.phone = ad.phone || '';
      box.dataset.img = ad.thumbnailUrl;
      box.dataset.events = ad.events || '';
      box.dataset.facilities = ad.facilities || '';
      box.dataset.parking = ad.parking || '';
      box.dataset.category = ad.category;
      box.innerHTML = makeCardHTML(ad, false);
      return box;
    }

    /* ───────────────────────────────
        3) 섹션 렌더링 + 모달 버튼 핸들러
       ─────────────────────────────── */
    function renderSection(items, makeCard, containerId, limit) {
      const container = document.getElementById(containerId);
      container.innerHTML = '';
      items.slice(0, limit).forEach(ad => container.appendChild(makeCard(ad)));
    }

    function attachModalHandlers() {
      document.querySelectorAll('.open-modal').forEach(btn => {
        btn.addEventListener('click', e => {
          e.preventDefault();
          const card = btn.parentElement;
          if (!card) return;

          const data = {
            title: card.dataset.title,
            phone: card.dataset.phone,
            image: card.dataset.img,
            address: '주소 미정',
            category: card.dataset.category,
            delivery: '정보 없음',
            hours: '정보 없음',
            serviceItems: '정보 없음',
            events: [card.dataset.events, ''],
            facilities: card.dataset.facilities,
            pets: '정보 없음',
            parking: card.dataset.parking,
            sliderImages: [card.dataset.img]
          };

          if (window.populateModal) {
            window.populateModal(data);
            document.getElementById('modalOverlay').classList.remove('hidden');
            document.getElementById('commonModal').classList.remove('hidden');
          } else {
            console.error('populateModal 함수가 로드되지 않았습니다.');
          }
        });
      });
    }

    /* ───────────────────────────────
        4) 초기화
       ─────────────────────────────── */
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        const stores = await fetchStores();

        /* 4-1. 파워 광고(4개) */
        const powerAds = stores.filter(ad => ad.powerAd);
        renderSection(powerAds, createPowerAdCard, 'powerAdsContainer', 4);

        /* 4-2. 카테고리별 CSR 광고(각 8개) */
        const containerMap = {
          백반: "baekbanSection",
          찌개탕: "jjigaetangSection",
          고기구이: "gogiguiSection",
          생선: "fishSection",
          국수: "noodleSection",
          분식: "snackSection",
          국밥: "soupSection",
          반찬: "sideSection",
          여러가지: "etcSection"
        };
        Object.entries(containerMap).forEach(([cat, id]) => {
          const items = stores.filter(ad => ad.category === cat);
          renderSection(items, createAdCard, id, 8);
        });

        /* 4-3. 새로 생성된 카드에 모달 핸들러 연결 */
        attachModalHandlers();
      } catch (err) {
        console.error(err);
      }

      /* ========== (기존 코드 그대로 유지) ========== */
      const categorySectionMap = {
        밥류: "baekbanSection",
        "찌게/탕": "jjigaetangSection",
        "고기/구이": "gogiguiSection",
        생선: "fishSection",
        국수: "noodleSection",
        분식: "snackSection",
        국밥: "soupSection",
        반찬: "sideSection",
        여러가지: "etcSection"
      };

      document.querySelectorAll(".category-btn").forEach(button => {
        button.addEventListener("click", () => {
          const cat = button.dataset.category;
          const secId = categorySectionMap[cat];
          const sec = document.getElementById(secId);
          if (sec) sec.scrollIntoView({ behavior: "smooth" });
        });
      });

      document.querySelectorAll(".home-link").forEach(link => {
        link.addEventListener("click", e => {
          e.preventDefault();
          document.getElementById("categorySelection").scrollIntoView({ behavior: "smooth" });
        });
      });
    });
  </script>

</body>

</html>