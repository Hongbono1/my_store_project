<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ìŠ¤í† ì–´ í”„ë¼ì´ë“œ ìƒì„¸ | MALL HANKOOK</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: Pretendard, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        Roboto, "Noto Sans KR", sans-serif;
      background: radial-gradient(circle at top, #e0f2fe 0, #eef2ff 35%, #f9fafb 100%);
      min-height: 100vh;
    }

    .neo-card {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 24px;
      box-shadow: 0 18px 45px rgba(15, 23, 42, 0.12);
      border: 1px solid rgba(148, 163, 184, 0.25);
      backdrop-filter: blur(16px);
    }

    .pill {
      border-radius: 999px;
      border: 1px solid rgba(148, 163, 184, 0.5);
      background: rgba(255, 255, 255, 0.8);
    }

    .content-area p {
      margin-bottom: 0.75rem;
    }

    .content-area ul {
      list-style: disc;
      padding-left: 1.5rem;
      margin: 0.75rem 0;
    }

    .content-area h1,
    .content-area h2,
    .content-area h3 {
      font-weight: 700;
      margin: 1rem 0 0.5rem;
    }

    .content-area img {
      max-width: 100%;
      height: auto;
      border-radius: 16px;
      margin: 1rem auto;
      display: block;
    }
  </style>
</head>

<body class="text-slate-900">
  <div class="min-h-screen flex flex-col">
    <!-- ìƒë‹¨ í—¤ë” ì˜ì—­ (ê°„ë‹¨ ë²„ì „) -->
    <header class="w-full border-b border-slate-200/70 bg-white/70 backdrop-blur z-10">
      <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
        <div class="flex items-center gap-2">
          <div
            class="w-8 h-8 rounded-2xl bg-gradient-to-tr from-sky-500 to-indigo-500 flex items-center justify-center text-white text-xs font-bold shadow-md">
            MH
          </div>
          <div class="flex flex-col leading-tight">
            <span class="text-sm font-semibold text-slate-800">MALL HANKOOK</span>
            <span class="text-xs text-slate-400">Store Pride</span>
          </div>
        </div>
        <button onclick="history.back()"
          class="text-xs md:text-sm px-3 py-1.5 rounded-full border border-slate-200 bg-white hover:bg-slate-50 text-slate-600 flex items-center gap-1 shadow-sm">
          â† ë’¤ë¡œê°€ê¸°
        </button>
      </div>
    </header>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <main class="flex-1">
      <div class="max-w-5xl mx-auto px-4 py-6 md:py-10">
        <!-- ë¡œë”© / ì—ëŸ¬ ì˜ì—­ -->
        <div id="status" class="mb-4 text-sm text-slate-500 hidden"></div>

        <div class="neo-card p-5 md:p-8">
          <!-- ìƒë‹¨: ê°€ê²Œ ì •ë³´ + í”„ë¼ì´ë“œ ì œëª© -->
          <div class="flex flex-col gap-4 md:gap-6 border-b border-slate-200/70 pb-5 md:pb-6">
            <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3">
              <div class="flex flex-col gap-1">
                <div class="flex items-center gap-2 flex-wrap">
                  <span id="store-name" class="text-xl md:text-2xl font-bold text-slate-900">
                    ê°€ê²Œ ì´ë¦„
                  </span>
                  <span id="business-tags" class="text-xs md:text-xs text-slate-500">
                    <!-- ì—…ì¢… / ì¹´í…Œê³ ë¦¬ -->
                  </span>
                </div>
                <div class="flex flex-wrap gap-2 mt-1">
                  <span
                    class="pill px-2.5 py-0.5 text-[11px] md:text-xs font-medium text-sky-700 bg-sky-50/80 border-sky-100">
                    STORE PRIDE
                  </span>
                  <span id="category-pill"
                    class="pill px-2.5 py-0.5 text-[11px] md:text-xs text-slate-600 bg-slate-50/80">
                    ì¹´í…Œê³ ë¦¬
                  </span>
                  <span id="date-pill" class="pill px-2.5 py-0.5 text-[11px] md:text-xs text-slate-500 bg-slate-50/80">
                    ë‚ ì§œ
                  </span>
                </div>
              </div>
            </div>

            <div class="flex flex-col md:flex-row gap-4 md:gap-6 items-start md:items-center">
              <div class="flex-1 flex flex-col gap-1 text-xs md:text-sm text-slate-600">
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="font-medium text-slate-700">ì œëª©</span>
                  <span id="pride-title" class="text-slate-900 font-semibold">
                    ìë‘ê¸€ ì œëª©
                  </span>
                </div>
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="font-medium text-slate-700">ì£¼ì†Œ</span>
                  <span id="address" class="text-slate-600">
                    -
                  </span>
                </div>
                <div class="flex items-center gap-2 flex-wrap">
                  <span class="font-medium text-slate-700">ì—°ë½ì²˜</span>
                  <span id="phone" class="text-slate-600">
                    -
                  </span>
                </div>
              </div>

              <!-- ëŒ€í‘œ ì´ë¯¸ì§€ -->
              <div class="w-full md:w-52">
                <div
                  class="relative rounded-2xl overflow-hidden border border-slate-200/70 bg-slate-100 aspect-[4/3] flex items-center justify-center">
                  <img id="thumbnail" src="" alt="ìŠ¤í† ì–´ í”„ë¼ì´ë“œ ëŒ€í‘œ ì´ë¯¸ì§€" class="w-full h-full object-cover hidden" />
                  <div id="thumbnail-placeholder"
                    class="flex flex-col items-center justify-center text-xs text-slate-400 gap-1">
                    <div class="w-10 h-10 rounded-full bg-slate-200 flex items-center justify-center text-slate-500">
                      ğŸ“·
                    </div>
                    <span>ë“±ë¡ëœ ëŒ€í‘œ ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- ë‚´ìš© ì˜ì—­ -->
          <section class="mt-5 md:mt-6">
            <h2 class="text-sm font-semibold text-slate-800 mb-3">
              ê°€ê²Œ ìë‘ ë‚´ìš©
            </h2>
            <div id="pride-content"
              class="content-area text-sm md:text-[15px] leading-relaxed text-slate-800 bg-slate-50/60 rounded-2xl px-4 py-3 md:px-5 md:py-4 border border-slate-200/70 overflow-x-auto">
              <!-- ì—¬ê¸° ì•ˆì— DBì— ì €ì¥ëœ HTML(content)ì´ ê·¸ëŒ€ë¡œ ë Œë”ë§ë¨ -->
              ë¡œë”© ì¤‘...
            </div>
          </section>
        </div>
      </div>
    </main>
  </div>

  <script>
    // ì¿¼ë¦¬ìŠ¤íŠ¸ë§ì—ì„œ id ì¶”ì¶œ
    function getQueryParam(name) {
      const params = new URLSearchParams(window.location.search);
      return params.get(name);
    }

    async function loadStorePrideDetail() {
      const statusEl = document.getElementById("status");
      const id = getQueryParam("id");

      if (!id) {
        statusEl.textContent = "ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤. id íŒŒë¼ë¯¸í„°ê°€ ì—†ìŠµë‹ˆë‹¤.";
        statusEl.classList.remove("hidden");
        statusEl.classList.add("text-red-500");
        return;
      }

      try {
        statusEl.textContent = "ìŠ¤í† ì–´ í”„ë¼ì´ë“œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...";
        statusEl.classList.remove("hidden");
        statusEl.classList.remove("text-red-500");
        statusEl.classList.add("text-slate-500");

        // ğŸ”¹ ì—¬ê¸°ì„œ API ì£¼ì†ŒëŠ” í”„ë¡œì íŠ¸ì— ë§ê²Œ ìˆ˜ì • ê°€ëŠ¥
        const res = await fetch(`/storepride/${id}`);
        if (!res.ok) {
          throw new Error(`ì„œë²„ ì‘ë‹µ ì˜¤ë¥˜: ${res.status}`);
        }

        const json = await res.json();
        if (!json.ok) {
          throw new Error(json.error || "ë°ì´í„° ì¡°íšŒì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
        }

        const data = json.data;

        // ê¸°ëŒ€í•˜ëŠ” ë°ì´í„° êµ¬ì¡° ì˜ˆì‹œ:
        // data = {
        //   id, store_id, title, event_date, category,
        //   phone, address, content, image_path,
        //   store: { business_name, business_type, business_category }
        // }

        // ê°€ê²Œ/í”„ë¼ì´ë“œ ê¸°ë³¸ ì •ë³´ ì±„ìš°ê¸°
        document.getElementById("store-name").textContent =
          (data.store && data.store.business_name) || "(ê°€ê²Œ ì´ë¦„ ì—†ìŒ)";

        const bizTagsEl = document.getElementById("business-tags");
        const bizType = data.store?.business_type || "";
        const bizCategory = data.store?.business_category || "";
        bizTagsEl.textContent = [bizType, bizCategory].filter(Boolean).join(" Â· ");

        document.getElementById("pride-title").textContent = data.title || "(ì œëª© ì—†ìŒ)";
        document.getElementById("address").textContent = data.address || "-";
        document.getElementById("phone").textContent = data.phone || "-";

        // ì¹´í…Œê³ ë¦¬ Pill
        document.getElementById("category-pill").textContent =
          data.category ? `ë¶„ë¥˜: ${data.category}` : "ë¶„ë¥˜ ì •ë³´ ì—†ìŒ";

        // ë‚ ì§œ Pill
        if (data.event_date) {
          const d = new Date(data.event_date);
          const y = d.getFullYear();
          const m = String(d.getMonth() + 1).padStart(2, "0");
          const day = String(d.getDate()).padStart(2, "0");
          document.getElementById("date-pill").textContent = `${y}-${m}-${day}`;
        } else {
          document.getElementById("date-pill").textContent = "ë‚ ì§œ ì •ë³´ ì—†ìŒ";
        }

        // ëŒ€í‘œ ì´ë¯¸ì§€ ì²˜ë¦¬
        const thumbEl = document.getElementById("thumbnail");
        const thumbPlaceholder = document.getElementById("thumbnail-placeholder");

        if (data.image_path) {
          // ì ˆëŒ€ ê²½ë¡œ/ìƒëŒ€ ê²½ë¡œ ëª¨ë‘ ëŒ€ì‘
          thumbEl.src = data.image_path;
          thumbEl.classList.remove("hidden");
          thumbPlaceholder.classList.add("hidden");
        } else {
          thumbEl.classList.add("hidden");
          thumbPlaceholder.classList.remove("hidden");
        }

        // ë‚´ìš©(content) HTML ì‚½ì…
        const contentEl = document.getElementById("pride-content");
        if (data.content) {
          // âš ï¸ contentëŠ” ìš°ë¦¬ê°€ ì§ì ‘ ë§Œë“  ì—ë””í„°/ê´€ë¦¬ìê°€ ì…ë ¥í•œ HTMLì´ë¼ê³  ê°€ì •
          contentEl.innerHTML = data.content;
        } else {
          contentEl.textContent = "ë“±ë¡ëœ ìë‘ê¸€ ë‚´ìš©ì´ ì—†ìŠµë‹ˆë‹¤.";
        }

        statusEl.classList.add("hidden");
      } catch (err) {
        console.error(err);
        statusEl.textContent = `ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤: ${err.message}`;
        statusEl.classList.remove("hidden");
        statusEl.classList.remove("text-slate-500");
        statusEl.classList.add("text-red-500");
      }
    }

    document.addEventListener("DOMContentLoaded", loadStorePrideDetail);
  </script>
</body>

</html>