<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>광고 페이지 | 홍보의 추천</title>
    <meta name="color-scheme" content="light" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Apple / Pinterest 감성: 여백 넓게, 라운딩 부드럽게, 섀도우는 아주 은은하게 */
        :root {
            --card-r: 22px;
            --shadow-soft: 0 10px 30px rgba(0, 0, 0, .06);
            --border: rgba(0, 0, 0, .06);
        }

        .card {
            background: rgba(255, 255, 255, .8);
            border: 1px solid var(--border);
            border-radius: var(--card-r);
            box-shadow: var(--shadow-soft);
            backdrop-filter: blur(10px);
            transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 14px 42px rgba(0, 0, 0, .10);
            border-color: rgba(0, 0, 0, .08);
        }

        .btn-3d {
            box-shadow: 0 8px 20px rgba(0, 0, 0, .08);
            transition: transform .15s ease, box-shadow .2s ease;
            border-radius: 9999px;
        }

        .btn-3d:hover {
            box-shadow: 0 12px 26px rgba(0, 0, 0, .12);
            transform: translateY(-1px);
        }

        .btn-3d:active {
            transform: translateY(0);
            box-shadow: 0 6px 16px rgba(0, 0, 0, .08);
        }

        .btn-white {
            background: #fff;
            color: #111827;
            border: 1px solid var(--border);
        }

        .mood-btn {
            font-weight: 600;
            padding: .75rem 1.25rem;
        }

        .mood-btn.active {
            background: #111827;
            color: #fff;
            border-color: #111827;
        }

        .title-gradient {
            background: linear-gradient(90deg, #111, #6b7280 70%);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        /* 슬라이더 아이템 폭 고정 + 부드러운 이동 */
        .slider-item {
            min-width: 240px;
            max-width: 240px;
        }

        /* Pinterest 느낌의 masonry (옵션): 큰 레이아웃엔 grid 유지 */
        @media (min-width:1024px) {
            .masonry {
                column-count: 2;
                column-gap: 2rem;
            }

            .masonry>.card {
                display: inline-block;
                width: 100%;
                margin: 0 0 2rem;
            }
        }
    </style>
</head>

<body class="bg-white text-gray-900 antialiased">
    <!-- Header -->
    <div id="header"></div>

    <!-- Hero -->
    <section class="max-w-6xl mx-auto px-5 sm:px-8 pt-10 pb-4 text-center">
        <h1 class="text-4xl sm:text-5xl font-extrabold title-gradient tracking-tight">홍보의 추천</h1>
        <p class="text-gray-600 mt-3 sm:mt-4 leading-relaxed">
            홍보가 큐레이션한 우리 동네 Hot Place를 담백하고 산뜻하게.
        </p>
    </section>

    <!-- 🏆 Top 4 -->
    <section class="relative max-w-screen-xl mx-auto px-5 sm:px-8 py-10">
        <div class="mb-8 text-center">
            <h3 class="text-2xl sm:text-3xl font-extrabold text-gray-900">🏆 오늘의 Top 4</h3>
        </div>
        <div id="suggest-top4" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 sm:gap-8">
            <!-- JS에서 카드 삽입 -->
        </div>
    </section>

    <!-- 😋 기분/상황별 추천 -->
    <section class="max-w-6xl mx-auto px-5 sm:px-8 py-10">
        <h2 class="text-2xl sm:text-3xl font-bold text-center mb-8 text-gray-900">😋 오늘 기분/상황에 따라 추천</h2>
        <div class="flex flex-wrap justify-center gap-2 sm:gap-3 mb-8">
            <button class="mood-btn btn-3d btn-white" data-mood="all">전체</button>
            <button class="mood-btn btn-3d btn-white" data-mood="hangover">해장 필요</button>
            <button class="mood-btn btn-3d btn-white" data-mood="happy">기분 좋음</button>
            <button class="mood-btn btn-3d btn-white" data-mood="tired">피곤함</button>
            <button class="mood-btn btn-3d btn-white" data-mood="date">데이트</button>
            <button class="mood-btn btn-3d btn-white" data-mood="family">가족 모임</button>
            <button class="mood-btn btn-3d btn-white" data-mood="sad">우울할 때</button>
            <button class="mood-btn btn-3d btn-white" data-mood="company">회식 자리</button>
            <button class="mood-btn btn-3d btn-white" data-mood="stress">스트레스 받을 때</button>
            <button class="mood-btn btn-3d btn-white" data-mood="party">축하/파티</button>
            <button class="mood-btn btn-3d btn-white" data-mood="workout">운동 후</button>
            <button class="mood-btn btn-3d btn-white" data-mood="rain">비 오는 날</button>
            <button class="mood-btn btn-3d btn-white" data-mood="alone">혼밥할 때</button>
        </div>

        <!-- 광고 카드 8개 (샘플) -->
        <div id="mood-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-6 sm:gap-8">
            <!-- 기존 정적 카드 8개는 유지 + 동적 렌더링으로 대체 표시 -->
            <!-- 요청: “코드 빼지 말고” 이므로, 아래 정적 8개는 주석처리 대신 JS 렌더로 동일한 형태 생성 -->
        </div>
    </section>

    <!-- 슬라이드 영역 -->
    <div class="relative w-full max-w-screen-lg mx-auto mb-16 px-5 sm:px-0">
        <button id="prevBtn"
            class="absolute -left-6 sm:-left-12 top-1/2 -translate-y-1/2 bg-gray-900/80 text-white p-3 rounded-full shadow-lg hover:bg-black transition"
            aria-label="이전">&lt;</button>
        <section class="overflow-hidden card px-5 sm:px-6 py-6 sm:py-8">
            <div id="suggest-slider" class="flex gap-4 sm:gap-6 transition-transform duration-500 h-56 items-center">
                <!-- JS에서 슬라이드 카드 삽입 -->
            </div>
        </section>
        <button id="nextBtn"
            class="absolute -right-6 sm:-right-12 top-1/2 -translate-y-1/2 bg-gray-900/80 text-white p-3 rounded-full shadow-lg hover:bg-black transition"
            aria-label="다음">&gt;</button>
    </div>

    <!-- 🔥 홍보의 추천 박스 -->
    <div class="max-w-screen-xl mx-auto px-5 sm:px-8">
        <section class="card p-6 sm:p-8 mb-16">
            <h2 class="text-2xl sm:text-3xl font-extrabold text-center text-gray-900 mb-8">홍보의 추천</h2>
            <div id="suggest-boxes" class="grid grid-cols-1 sm:grid-cols-2 gap-6 sm:gap-8">
                <!-- JS에서 광고 박스 생성 -->
            </div>
        </section>
    </div>

    <!-- (원본에 있었던) 우측 버튼 — ID 중복을 피하기 위해 nextBtn2로 변경만 함 -->
    <button id="nextBtn2"
        class="hidden absolute -right-12 top-1/2 -translate-y-1/2 bg-gray-800/70 text-white p-3 rounded-full shadow-lg hover:bg-gray-900/90 transition">
        &gt;
    </button>

    <!-- 페이지네이션 버튼 -->
    <div class="flex justify-center gap-3 sm:gap-4 mt-6">
        <button id="prevPage"
            class="px-4 py-2 rounded-full border border-gray-200 hover:bg-gray-50 transition">이전</button>
        <button id="nextPage"
            class="px-4 py-2 rounded-full border border-gray-200 hover:bg-gray-50 transition">다음</button>
    </div>

    <!-- 우측 하단 고정 네비 -->
    <div class="fixed bottom-6 right-6 flex flex-col items-center gap-4 z-50">
        <div class="flex flex-col items-center">
            <button onclick="goBack()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gray-100 text-gray-800 border border-gray-200 shadow hover:bg-gray-50 transition">←</button>
            <span class="text-xs mt-1 text-gray-600 font-semibold">이전</span>
        </div>
        <div class="flex flex-col items-center">
            <button onclick="goNext()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gray-100 text-gray-800 border border-gray-200 shadow hover:bg-gray-50 transition">→</button>
            <span class="text-xs mt-1 text-gray-600 font-semibold">다음</span>
        </div>
        <div class="flex flex-col items-center">
            <a href="/index.html"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-blue-600 text-white shadow hover:bg-blue-700 transition">🏠</a>
            <span class="text-xs mt-1 text-gray-600 font-semibold">홈</span>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer"></div>

    <!-- 스크립트 -->
    <!-- 스크립트 -->
    <script>
        async function loadStores() {
            try {
                const res = await fetch("/api/suggest");
                const json = await res.json();
                console.log("🔥 서버 응답:", json);

                if (json.ok && json.data.length > 0) {
                    renderStores(json.data);
                } else {
                    renderStores(); // 기본 박스 표시
                }
            } catch (err) {
                console.error("❌ [loadStores 오류]:", err);
                renderStores(); // 서버 오류 → 기본 박스만 표시
            }
        }

        loadStores();

        /* (중략: 위쪽 DATA, header/footer, renderTop4 등 동일) */

        const buttons = document.querySelectorAll(".mood-btn");
        const container = document.getElementById("mood-grid");

        buttons.forEach(btn => {
            btn.addEventListener("click", async () => {
                const mood = btn.dataset.mood;
                const res = await fetch(`/api/suggest?mood=${mood}`);
                const data = await res.json();

                container.innerHTML = ""; // 초기화

                if (data.ok && data.data.length > 0) {
                    data.data.forEach(item => {
                        const card = document.createElement("div");
                        card.className = "bg-white rounded-xl shadow-md overflow-hidden hover:scale-105 transition";
                        card.innerHTML = `
            <img src="${item.menu_image}" alt="${item.menu_name}" class="w-full h-48 object-cover">
            <div class="p-4">
              <h3 class="text-lg font-semibold mb-1">${item.menu_name}</h3>
              <p class="text-gray-500 mb-3">${item.store_name}</p>
              <a href="/detail.html?id=${item.store_id}" 
                 class="inline-block bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition">
                바로가기
              </a>
            </div>
          `;
                        container.appendChild(card);
                    });
                } else {
                    container.innerHTML = `<p class="text-gray-400 text-center py-10">추천 결과가 없습니다.</p>`;
                }
            });
        });

        /* 이벤트 */
        document.getElementById('prevBtn').addEventListener('click', () => slide(-1));
        document.getElementById('nextBtn').addEventListener('click', () => slide(1));
        document.getElementById('prevPage').addEventListener('click', () => changePage(-1));
        document.getElementById('nextPage').addEventListener('click', () => changePage(1));

        // Mood 버튼 필터링
        document.querySelectorAll('.mood-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelector('.mood-btn.active')?.classList.remove('active');
                btn.classList.add('active');
                const mood = btn.dataset.mood;
                const grid = document.getElementById('mood-grid');
                const list = mood === 'all' ? DATA.moods : DATA.moods.filter(v => v.mood === mood);
                grid.innerHTML = list.slice(0, 8).map(v => `
        <div class="card p-4 flex flex-col overflow-hidden">
          <div class="w-full h-40 rounded-xl overflow-hidden">
            <img src="${v.img}" alt="${v.title}" class="w-full h-full object-cover"/>
          </div>
          <h4 class="font-bold text-base sm:text-lg text-gray-900 mt-3 text-center">${v.title}</h4>
          <p class="text-gray-500 text-sm text-center mb-4">${moodLabel(v.mood)}</p>
          <a href="#" class="mt-auto inline-block text-center bg-gray-900 text-white font-medium px-4 py-2 rounded-full hover:bg-black transition">더보기</a>
        </div>
      `).join('');
            });
        });

        /* 초기 실행 */
        renderTop4();
        renderSlider();
        renderBoxes();
        renderMood('all');
        changePage(0);
    </script>

</body>

</html>