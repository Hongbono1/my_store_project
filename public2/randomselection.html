<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>오늘의 랜덤 추천</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ✅ 네오모피즘+글래스 */
        .neo-glass {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            border-radius: 1.5rem;
            border: 1px solid rgba(200, 200, 200, 0.6);
            box-shadow: 8px 8px 20px rgba(0, 0, 0, 0.08),
                -8px -8px 20px rgba(255, 255, 255, 0.9);
        }

        /* ✅ 공통 3D 버튼 */
        .btn-3d {
            border-radius: 9999px;
            box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.25),
                -2px -2px 6px rgba(255, 255, 255, 0.6);
            transition: all 0.2s ease;
            display: inline-block;
        }

        .btn-3d:hover {
            transform: translateY(-2px);
            box-shadow: 6px 6px 14px rgba(0, 0, 0, 0.35),
                -3px -3px 8px rgba(255, 255, 255, 0.8);
        }

        .btn-3d:active {
            transform: translateY(2px);
            box-shadow: inset 2px 2px 6px rgba(0, 0, 0, 0.3),
                inset -2px -2px 6px rgba(255, 255, 255, 0.7);
        }

        /* ✅ 파란색 버튼 (자세히 보기 전용) */
        .btn-blue {
            background: linear-gradient(145deg, #3b82f6, #1e40af);
            color: #fff;
        }

        /* ✅ 흰색 버튼 (기분/상황 버튼) */
        .btn-white {
            background: #fff !important;
            color: #111827 !important;
            /* 검정 글씨 */
            border: 1px solid #d1d5db;
        }
    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <!-- 1단계: 제철 음식 -->
    <section class="max-w-4xl mx-auto px-4 py-10">
        <h1 class="text-3xl font-extrabold text-center mb-6">🥗 이달의 제철 음식</h1>
        <div class="neo-glass grid md:grid-cols-2 gap-6 overflow-hidden min-h-[250px] p-4">
            <div>
                <img src="https://via.placeholder.com/600x400?text=제철음식" alt="제철 음식"
                    class="w-full h-64 object-cover md:h-full rounded-2xl">
            </div>
            <div class="p-6 flex flex-col justify-center text-center md:text-left">
                <h3 class="text-2xl font-bold mb-3">가을 전어구이</h3>
                <p class="text-lg text-gray-700 mb-4">
                    가을철엔 고소한 전어구이가 제맛!<br>가족과 함께 즐겨보세요 🍂
                </p>
                <a href="season.html"
                    class="btn-3d btn-blue text-white text-sm font-semibold rounded-full px-6 py-2 self-center md:self-start">
                    자세히 보기
                </a>
            </div>
        </div>
    </section>

    <!-- 3단계: 랜덤 광고 8개 -->
    <section class="max-w-6xl mx-auto px-4 py-10">
        <h2 class="text-2xl font-extrabold text-center mb-6">📢 오늘의 랜덤 광고 추천</h2>
        <div id="ad-grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-8">

            <!-- 광고 카드 1 -->
            <div class="neo-glass flex flex-col overflow-hidden p-4">
                <div class="w-full h-40 bg-gray-100 rounded-xl mb-4 overflow-hidden">
                    <img src="https://via.placeholder.com/300x200?text=광고1" alt="광고1"
                        class="w-full h-full object-cover">
                </div>
                <h4 class="font-extrabold text-lg text-gray-800 mb-2 text-center">광고 1</h4>
                <p class="text-gray-500 text-sm text-center mb-4">카테고리</p>
                <a href="#"
                    class="btn-3d bg-gradient-to-r from-yellow-400 to-pink-400 text-white font-semibold px-4 py-2 rounded-full shadow hover:opacity-90 transition  flex justify-center items-center text-center">
                    더보기
                </a>
            </div>

            <!-- 광고 카드 2 -->
            <div class="neo-glass flex flex-col overflow-hidden p-4">
                <div class="w-full h-40 bg-gray-100 rounded-xl mb-4 overflow-hidden">
                    <img src="https://via.placeholder.com/300x200?text=광고2" alt="광고2"
                        class="w-full h-full object-cover">
                </div>
                <h4 class="font-extrabold text-lg text-gray-800 mb-2 text-center">광고 2</h4>
                <p class="text-gray-500 text-sm text-center mb-4">카테고리</p>
                <a href="#"
                    class="btn-3d bg-gradient-to-r from-yellow-400 to-pink-400 text-white font-semibold px-4 py-2 rounded-full shadow hover:opacity-90 transition  flex justify-center items-center text-center">
                    더보기
                </a>
            </div>

            <!-- 광고 카드 3 -->
            <div class="neo-glass flex flex-col overflow-hidden p-4">
                <div class="w-full h-40 bg-gray-100 rounded-xl mb-4 overflow-hidden">
                    <img src="https://via.placeholder.com/300x200?text=광고3" alt="광고3"
                        class="w-full h-full object-cover">
                </div>
                <h4 class="font-extrabold text-lg text-gray-800 mb-2 text-center">광고 3</h4>
                <p class="text-gray-500 text-sm text-center mb-4">카테고리</p>
                <a href="#"
                    class="btn-3d bg-gradient-to-r from-yellow-400 to-pink-400 text-white font-semibold px-4 py-2 rounded-full shadow hover:opacity-90 transition  flex justify-center items-center text-center">
                    더보기
                </a>
            </div>

            <!-- 광고 카드 4 -->
            <div class="neo-glass flex flex-col overflow-hidden p-4">
                <div class="w-full h-40 bg-gray-100 rounded-xl mb-4 overflow-hidden">
                    <img src="https://via.placeholder.com/300x200?text=광고4" alt="광고4"
                        class="w-full h-full object-cover">
                </div>
                <h4 class="font-extrabold text-lg text-gray-800 mb-2 text-center">광고 4</h4>
                <p class="text-gray-500 text-sm text-center mb-4">카테고리</p>
                <a href="#"
                    class="btn-3d bg-gradient-to-r from-yellow-400 to-pink-400 text-white font-semibold px-4 py-2 rounded-full shadow hover:opacity-90 transition  flex justify-center items-center text-center">
                    더보기
                </a>
            </div>

            <!-- 광고 카드 5 -->
            <div class="neo-glass flex flex-col overflow-hidden p-4">
                <div class="w-full h-40 bg-gray-100 rounded-xl mb-4 overflow-hidden">
                    <img src="https://via.placeholder.com/300x200?text=광고5" alt="광고5"
                        class="w-full h-full object-cover">
                </div>
                <h4 class="font-extrabold text-lg text-gray-800 mb-2 text-center">광고 5</h4>
                <p class="text-gray-500 text-sm text-center mb-4">카테고리</p>
                <a href="#"
                    class="btn-3d bg-gradient-to-r from-yellow-400 to-pink-400 text-white font-semibold px-4 py-2 rounded-full shadow hover:opacity-90 transition  flex justify-center items-center text-center">
                    더보기
                </a>
            </div>

            <!-- 광고 카드 6 -->
            <div class="neo-glass flex flex-col overflow-hidden p-4">
                <div class="w-full h-40 bg-gray-100 rounded-xl mb-4 overflow-hidden">
                    <img src="https://via.placeholder.com/300x200?text=광고6" alt="광고6"
                        class="w-full h-full object-cover">
                </div>
                <h4 class="font-extrabold text-lg text-gray-800 mb-2 text-center">광고 6</h4>
                <p class="text-gray-500 text-sm text-center mb-4">카테고리</p>
                <a href="#"
                    class="btn-3d bg-gradient-to-r from-yellow-400 to-pink-400 text-white font-semibold px-4 py-2 rounded-full shadow hover:opacity-90 transition  flex justify-center items-center text-center">
                    더보기
                </a>
            </div>

            <!-- 광고 카드 7 -->
            <div class="neo-glass flex flex-col overflow-hidden p-4">
                <div class="w-full h-40 bg-gray-100 rounded-xl mb-4 overflow-hidden">
                    <img src="https://via.placeholder.com/300x200?text=광고7" alt="광고7"
                        class="w-full h-full object-cover">
                </div>
                <h4 class="font-extrabold text-lg text-gray-800 mb-2 text-center">광고 7</h4>
                <p class="text-gray-500 text-sm text-center mb-4">카테고리</p>
                <a href="#"
                    class="btn-3d bg-gradient-to-r from-yellow-400 to-pink-400 text-white font-semibold px-4 py-2 rounded-full shadow hover:opacity-90 transition  flex justify-center items-center text-center">
                    더보기
                </a>
            </div>

            <!-- 광고 카드 8 -->
            <div class="neo-glass flex flex-col overflow-hidden p-4">
                <div class="w-full h-40 bg-gray-100 rounded-xl mb-4 overflow-hidden">
                    <img src="https://via.placeholder.com/300x200?text=광고8" alt="광고8"
                        class="w-full h-full object-cover">
                </div>
                <h4 class="font-extrabold text-lg text-gray-800 mb-2 text-center">광고 8</h4>
                <p class="text-gray-500 text-sm text-center mb-4">카테고리</p>
                <a href="#"
                    class="btn-3d bg-gradient-to-r from-yellow-400 to-pink-400 text-white font-semibold px-4 py-2 rounded-full shadow hover:opacity-90 transition  flex justify-center items-center text-center">
                    더보기
                </a>
            </div>

        </div>
    </section>

</body>

</html>

<script>
    // 제철 음식 불러오기 (큰 광고박스)
    async function loadSeasonFood() {
        try {
            const res = await fetch("/api/season-foods");
            const data = await res.json();
            const el = document.getElementById("season-food");
            el.innerHTML = `
              <div>
                <img src="${data.image_url}" alt="${data.name}" class="w-full h-64 object-cover md:h-full">
              </div>
              <div class="p-6 flex flex-col justify-center text-center md:text-left">
                <h3 class="text-2xl font-bold mb-3">${data.name}</h3>
                <p class="text-gray-600 mb-4">${data.description}</p>
              </div>
            `;
        } catch (e) {
            console.error(e);
        }
    }

    // 상황별 문구 매핑
    const moodTexts = {
        hangover: "속을 시원하게 풀어드리는 최고의 해장 음식",
        date: "사랑하는 연인과 함께 즐기는 분위기 있는 음식",
        family: "따뜻한 마음이 모이는 가족 단위 추천 음식",
        company: "동료들과 함께 나누기 좋은 푸짐한 음식",
        rain: "빗소리와 함께 즐기면 더 맛있는 음식",
        workout: "에너지를 빠르게 채워주는 든든한 음식",
        sad: "마음을 달래주는 위로의 한 끼",
        stress: "답답한 기분을 풀어주는 시원한 음식",
        party: "즐거운 순간을 더욱 특별하게 만드는 파티 음식",
        tired: "지친 몸에 활력을 주는 든든한 보양 음식",
        happy: "행복한 순간을 더 즐겁게 만들어주는 특별한 음식",
        alone: "혼자여도 든든하고 만족스러운 한 끼"
    };

    // 기분별 음식 추천 (큰 광고박스)
    async function loadMoodFood(mood) {
        const moodBox = document.getElementById("mood-food");
        const text = moodTexts[mood] || "추천 음식을 불러오는 중입니다";

        // 버튼 클릭 시 우선 문구 반영
        moodBox.innerHTML = `
      <div>
        <img src="https://via.placeholder.com/600x400?text=${mood}" 
             alt="${mood}" 
             class="w-full h-64 object-cover md:h-full">
      </div>
      <div class="p-6 flex flex-col justify-center text-center md:text-left">
        <h3 class="text-2xl font-bold mb-3 break-keep">${text}</h3>
        <a href="mood-detail.html?mood=${mood}" 
           class="inline-block bg-blue-600 text-white text-sm px-4 py-2 rounded 
                  hover:bg-blue-700 transition self-center md:self-start">
           자세히 보기
        </a>
      </div>
    `;

        // 그 다음 서버 데이터 있으면 업데이트
        try {
            const res = await fetch(`/api/mood-foods?mood=${mood}`);
            const data = await res.json();

            if (data && (data.name || data.description)) {
                moodBox.innerHTML = `
              <div>
                <img src="${data.image_url || 'https://via.placeholder.com/600x400?text=' + mood}" 
                     alt="${data.name || text}" 
                     class="w-full h-64 object-cover md:h-full">
              </div>
              <div class="p-6 flex flex-col justify-center text-center md:text-left">
                <h3 class="text-2xl font-bold mb-3 break-keep">${data.name || text}</h3>
                <p class="text-gray-600 mb-4 break-keep">${data.description || text}</p>
                <a href="mood-detail.html?mood=${mood}" 
                   class="inline-block bg-blue-600 text-white text-sm px-4 py-2 rounded 
                          hover:bg-blue-700 transition self-center md:self-start">
                   자세히 보기
                </a>
              </div>
            `;
            }
        } catch (e) {
            console.error("[loadMoodFood] 서버 요청 실패:", e);
        }

        // 관련 광고도 함께 불러오기
        loadAds([mood]);
    }

    // 광고 불러오기 (작은 박스, 최대 8개)
    async function loadAds(tags = []) {
        try {
            const query = tags.length ? `?tags=${tags.join(",")}` : "";
            const res = await fetch(`/api/ads${query}`);
            const data = await res.json();
            const grid = document.getElementById("ad-grid");

            if (data.length === 0) {
                grid.innerHTML = `<p class="col-span-4 text-center text-gray-500">현재 노출할 광고가 없습니다.</p>`;
                return;
            }

            grid.innerHTML = data.slice(0, 8).map(ad => `
              <a href="${ad.link || '#'}" target="_blank"
                 class="bg-white rounded-lg shadow-md p-4 flex flex-col items-center hover:shadow-lg transition">
                <img src="${ad.image_url}" alt="${ad.title}" class="w-full h-32 object-cover rounded mb-3">
                <h4 class="font-bold text-gray-800">${ad.title}</h4>
              </a>
            `).join("");
        } catch (e) {
            console.error(e);
        }
    }

    // 초기 실행
    document.addEventListener("DOMContentLoaded", () => {
        loadSeasonFood();
        loadAds();

        // 버튼 이벤트
        document.querySelectorAll(".mood-btn").forEach(btn => {
            btn.addEventListener("click", () => {
                loadMoodFood(btn.dataset.mood);
            });
        });
    });
</script>

</body>

</html>