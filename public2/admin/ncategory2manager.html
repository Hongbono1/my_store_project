<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>ncategory2 ë§¤ë‹ˆì €</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .neo-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 1.2rem;
            box-shadow: 6px 6px 16px #d9e0ec, -6px -6px 16px #ffffff;
            backdrop-filter: blur(16px) saturate(120%);
            transition: all .25s ease;
        }

        .neo-card:hover {
            transform: translateY(-4px);
            box-shadow: 4px 4px 12px #cfd8e6, -4px -4px 12px #ffffff, 0 8px 24px rgba(80, 130, 255, 0.15);
        }

        .btn-3d {
            background: linear-gradient(90deg, #6dd5fa, #2980b9);
            border-radius: 1.3rem;
            padding: .5rem 1.5rem;
            font-weight: bold;
            color: white;
            box-shadow: 0 4px 0 #2393b3, 0 8px 16px rgba(0, 64, 128, 0.14);
            transition: all .15s;
        }

        .btn-3d:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #2393b3, 0 4px 10px rgba(0, 64, 128, 0.16);
        }

        .sidebar-scroll {
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: transparent transparent;
        }

        .sidebar-scroll:hover {
            scrollbar-color: #cbd5e1 transparent;
        }

        .sidebar-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar-scroll::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 9999px;
        }

        .sidebar-scroll:hover::-webkit-scrollbar-thumb {
            background: #cbd5e1;
        }

        .sidebar-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        /* line-clamp ëŒ€ì²´(ê°„ë‹¨) */
        .clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 via-white to-blue-100 min-h-screen text-gray-800">
    <!-- âœ… header.html ë¶ˆëŸ¬ì˜¤ê¸° -->
    <div id="header-placeholder"></div>

    <header class="py-6 text-center">
        <h1 class="text-3xl font-bold text-blue-700">ncategory2 ë§¤ë‹ˆì €</h1>
        <p class="text-gray-600 mt-1">ìŠ¬ë¡¯ í´ë¦­ â†’ ëª¨ë‹¬ í¸ì§‘ â†’ ì €ì¥/ì‚­ì œ</p>
    </header>

    <div class="max-w-6xl mx-auto grid grid-cols-12 gap-6 py-6 px-4">

        <!-- ì¢Œì¸¡ ì‚¬ì´ë“œë°” -->
        <aside class="col-span-3 neo-card p-3 h-full max-h-[1346px] sidebar-scroll">
            <h2 class="font-bold text-2xl mb-4 text-center">CATEGORY</h2>

            <!-- âœ… (ìš”ì²­) ì‚¬ì´ë“œë°” ì¹´í…Œê³ ë¦¬ ëª©ë¡ í¬í•¨ -->
            <ul class="space-y-3">
                <!-- ë³‘ì› -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        ë³‘ ì› <span>â–¼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=hospital&category=ì¢…í•©ë³‘ì›"
                                class="block px-5 py-2 neo-card text-center">ì¢…í•©ë³‘ì›</a>
                        </li>
                        <li><a href="/subcategory.html?type=hospital&category=ë‚´ê³¼"
                                class="block px-3 py-2 neo-card text-center">ë‚´ê³¼</a>
                        </li>
                        <li><a href="/subcategory.html?type=hospital&category=ì¹˜ê³¼"
                                class="block px-3 py-2 neo-card text-center">ì¹˜ê³¼</a>
                        </li>
                        <li><a href="/subcategory.html?type=hospital&category=ì†Œì•„ê³¼"
                                class="block px-3 py-2 neo-card text-center">ì†Œì•„ê³¼</a>
                        </li>
                        <li><a href="/subcategory.html?type=hospital&category=ì •í˜•ì™¸ê³¼"
                                class="block px-3 py-2 neo-card text-center">ì •í˜•ì™¸ê³¼</a>
                        </li>
                        <li><a href="/subcategory.html?type=hospital&category=ì‚°ë¶€ì¸ê³¼"
                                class="block px-3 py-2 neo-card text-center">ì‚°ë¶€ì¸ê³¼</a>
                        </li>
                        <li><a href="/subcategory.html?type=hospital&category=í•œì˜ì›"
                                class="block px-3 py-2 neo-card text-center">í•œì˜ì›</a>
                        </li>
                        <li><a href="/subcategory.html?type=hospital&category=ê¸°íƒ€"
                                class="block px-3 py-2 neo-card text-center">ê¸°íƒ€</a>
                        </li>
                    </ul>
                </li>

                <!-- ì•½êµ­ -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        ì•½ êµ­ <span>â–¼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=pharmacy&category=ì¼ë°˜ì•½êµ­"
                                class="block px-3 py-2 neo-card text-center">ì¼ë°˜ì•½êµ­</a>
                        </li>
                        <li><a href="/subcategory.html?type=pharmacy&category=24ì‹œì•½êµ­"
                                class="block px-3 py-2 neo-card text-center">24ì‹œì•½êµ­</a>
                        </li>
                        <li><a href="/subcategory.html?type=pharmacy&category=í•œì•½ë°©"
                                class="block px-3 py-2 neo-card text-center">í•œì•½ë°©</a>
                        </li>
                        <li><a href="/subcategory.html?type=pharmacy&category=ê¸°íƒ€"
                                class="block px-3 py-2 neo-card text-center">ê¸°íƒ€</a>
                        </li>
                    </ul>
                </li>

                <!-- í•™ì› -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        í•™ ì› <span>â–¼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=academy&category=ì…ì‹œí•™ì›"
                                class="block px-3 py-2 neo-card text-center">ì…ì‹œí•™ì›</a>
                        </li>
                        <li><a href="/subcategory.html?type=academy&category=ì˜ì–´"
                                class="block px-3 py-2 neo-card text-center">ì˜ì–´</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ìˆ˜í•™"
                                class="block px-3 py-2 neo-card text-center">ìˆ˜í•™</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ìŒì•…"
                                class="block px-3 py-2 neo-card text-center">ìŒì•…</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ë¯¸ìˆ "
                                class="block px-3 py-2 neo-card text-center">ë¯¸ìˆ </a></li>
                        <li><a href="/subcategory.html?type=academy&category=ì»´í“¨í„°"
                                class="block px-3 py-2 neo-card text-center">ì»´í“¨í„°</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ì²´ìœ¡"
                                class="block px-3 py-2 neo-card text-center">ì²´ìœ¡</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ê¸°íƒ€"
                                class="block px-3 py-2 neo-card text-center">ê¸°íƒ€</a></li>
                    </ul>
                </li>

                <!-- ë§ˆíŠ¸ -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        ë§ˆ íŠ¸ <span>â–¼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=mart&category=ëŒ€í˜•ë§ˆíŠ¸"
                                class="block px-3 py-2 neo-card text-center">ëŒ€í˜•ë§ˆíŠ¸</a></li>
                        <li><a href="/subcategory.html?type=mart&category=ì¤‘ì†Œë§ˆíŠ¸"
                                class="block px-3 py-2 neo-card text-center">ì¤‘ì†Œë§ˆíŠ¸</a></li>
                        <li><a href="/subcategory.html?type=mart&category=ìŠˆí¼ë§ˆì¼“"
                                class="block px-3 py-2 neo-card text-center">ìŠˆí¼ë§ˆì¼“</a></li>
                        <li><a href="/subcategory.html?type=mart&category=ê¸°íƒ€"
                                class="block px-3 py-2 neo-card text-center">ê¸°íƒ€</a></li>
                    </ul>
                </li>

                <!-- ë¯¸ìš©/ì´ë°œ -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-11 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        ë¯¸ìš©/ì´ë°œ <span>â–¼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=beauty&category=ë¯¸ìš©"
                                class="block px-3 py-2 neo-card text-center">ë¯¸ìš©</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=ì´ë°œ"
                                class="block px-3 py-2 neo-card text-center">ì´ë°œ</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=ë„¤ì¼"
                                class="block px-3 py-2 neo-card text-center">ë„¤ì¼</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=í”¼ë¶€ê´€ë¦¬"
                                class="block px-3 py-2 neo-card text-center">í”¼ë¶€ê´€ë¦¬</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=ì™ì‹±"
                                class="block px-3 py-2 neo-card text-center">ì™ì‹±</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=ê¸°íƒ€"
                                class="block px-3 py-2 neo-card text-center">ê¸°íƒ€</a></li>
                    </ul>
                </li>
            </ul>

            <!-- âœ… ì‚¬ì´ë“œ ê´‘ê³  ìŠ¬ë¡¯ 2ê°œ -->
            <div class="mt-6 space-y-4">
                <button id="slot_ncategory2_sidebar_ad_1" data-position="ncategory2_sidebar_ad_1" data-title="ì‚¬ì´ë“œ ê´‘ê³  1"
                    class="neo-card w-full p-3 text-left">
                    <div class="font-bold text-lg mb-2">ì‚¬ì´ë“œ ê´‘ê³  1</div>
                    <img data-role="img" src="/uploads/no-image.png" alt="ì‚¬ì´ë“œ ê´‘ê³  1"
                        class="w-full h-[70px] object-cover rounded-xl bg-white" />
                    <div data-role="text" class="text-sm text-slate-700 mt-2 clamp-2"></div>
                </button>

                <button id="slot_ncategory2_sidebar_ad_2" data-position="ncategory2_sidebar_ad_2" data-title="ì‚¬ì´ë“œ ê´‘ê³  2"
                    class="neo-card w-full p-3 text-left">
                    <div class="font-bold text-lg mb-2">ì‚¬ì´ë“œ ê´‘ê³  2</div>
                    <img data-role="img" src="/uploads/no-image.png" alt="ì‚¬ì´ë“œ ê´‘ê³  2"
                        class="w-full h-[70px] object-cover rounded-xl bg-white" />
                    <div data-role="text" class="text-sm text-slate-700 mt-2 clamp-2"></div>
                </button>
            </div>
        </aside>

        <!-- ì¤‘ì•™ ë©”ì¸ -->
        <main class="col-span-9 space-y-8">

            <!-- ë©”ì¸ ë°°ë„ˆ(ê´€ë¦¬ìš©: ê³ ì •) -->
            <section class="relative h-60 neo-card flex items-center justify-center">
                <div class="text-center">
                    <h1 class="text-3xl font-bold mb-2">Premium ì¹´í…Œê³ ë¦¬</h1>
                    <p class="text-gray-600 text-sm">ì¹´í…Œê³ ë¦¬ ì„¤ëª… ë¬¸êµ¬ë¥¼ ì—¬ê¸°ì— ë„£ìŠµë‹ˆë‹¤.</p>
                </div>
            </section>

            <!-- íŒŒì›Œ ê´‘ê³ (ìŠ¬ë¡¯ 9ê°œë¥¼ 3ê°œì”© ê·¸ë£¹ ìŠ¬ë¼ì´ë”ë¡œ) -->
            <section class="mt-10">
                <h2 class="font-bold text-2xl text-purple-600 text-center mb-4">ê°•ë ¥ ì¶”ì²œ</h2>

                <div id="powerViewport" class="relative overflow-hidden">
                    <div id="powerAdTrack"
                        class="flex transition-transform duration-700 ease-in-out will-change-transform">
                        <!-- JSì—ì„œ ë™ì  ìƒì„± -->
                    </div>

                    <button id="prevBtn"
                        class="absolute left-0 top-1/2 -translate-y-1/2 bg-white shadow rounded-full px-3 py-2">â€¹</button>
                    <button id="nextBtn"
                        class="absolute right-0 top-1/2 -translate-y-1/2 bg-white shadow rounded-full px-3 py-2">â€º</button>
                </div>
            </section>

            <!-- ìµœê³ ì˜ ê°€ê²Œ ì˜ì—­ -->
            <section class="grid grid-cols-12 gap-6 items-stretch">

                <!-- ì¢Œì¸¡: MVP + HIGHLIGHT -->
                <div class="col-span-3 h-full">
                    <div class="neo-card p-4 w-full h-full flex flex-col gap-4">

                        <!-- MVP -->
                        <button id="slot_ncategory2_mvp" data-position="ncategory2_mvp" data-title="MVP"
                            class="flex-1 flex flex-col text-left">
                            <h2 class="font-bold text-2xl text-blue-600 text-center mb-3">MVP</h2>
                            <div
                                class="neo-card p-0 overflow-hidden relative rounded-2xl h-full border-2 border-blue-500">
                                <img data-role="img" src="/uploads/no-image.png" class="w-full h-full object-cover"
                                    alt="MVP">
                                <div
                                    class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                    <div data-role="name" class="font-bold text-lg leading-tight">ë¹„ì–´ìˆìŒ</div>
                                    <div data-role="cat" class="text-sm text-slate-600">ì—…ì¢…:</div>
                                </div>
                            </div>
                        </button>

                        <!-- HIGHLIGHT -->
                        <button id="slot_ncategory2_highlight" data-position="ncategory2_highlight"
                            data-title="HIGHLIGHT" class="flex-1 flex flex-col text-left">
                            <h2 class="font-bold text-2xl text-yellow-600 text-center mb-3">HIGHLIGHT</h2>
                            <div
                                class="neo-card p-0 overflow-hidden relative rounded-2xl h-full border-2 border-yellow-500">
                                <img data-role="img" src="/uploads/no-image.png" class="w-full h-full object-cover"
                                    alt="HIGHLIGHT">
                                <div
                                    class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                    <div data-role="name" class="font-bold text-lg leading-tight">ë¹„ì–´ìˆìŒ</div>
                                    <div data-role="cat" class="text-sm text-slate-600">ì—…ì¢…:</div>
                                </div>
                            </div>
                        </button>

                    </div>
                </div>

                <!-- ìš°ì¸¡: ìµœê³ ì˜ ê°€ê²Œ BEST 6 -->
                <div class="col-span-9 flex flex-col gap-6">
                    <div class="neo-card p-5">
                        <h2 class="font-bold mb-3 text-2xl text-center">ìµœê³ ì˜ ê°€ê²Œ</h2>
                        <div id="bestGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                            <!-- JSì—ì„œ ìŠ¬ë¡¯ 6ê°œ ë Œë” -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- í•˜ë‹¨ ë°•ìŠ¤ 2ê°œ -->
            <div class="grid grid-cols-2 gap-6">
                <button id="slot_ncategory2_bottom_1" data-position="ncategory2_bottom_1" data-title="í•˜ë‹¨ ë°•ìŠ¤ 1"
                    class="neo-card p-6 text-center">
                    <h3 class="font-bold text-lg mb-2">í•˜ë‹¨ ë°•ìŠ¤ 1</h3>
                    <p data-role="text" class="text-gray-600 text-sm">í´ë¦­í•´ì„œ ë‚´ìš© í¸ì§‘</p>
                </button>

                <button id="slot_ncategory2_bottom_2" data-position="ncategory2_bottom_2" data-title="í•˜ë‹¨ ë°•ìŠ¤ 2"
                    class="neo-card p-6 text-center">
                    <h3 class="font-bold text-lg mb-2">í•˜ë‹¨ ë°•ìŠ¤ 2</h3>
                    <p data-role="text" class="text-gray-600 text-sm">í´ë¦­í•´ì„œ ë‚´ìš© í¸ì§‘</p>
                </button>
            </div>

        </main>
    </div>

    <!-- ì˜¤ë¥¸ìª½ í•˜ë‹¨ ë„¤ë¹„ (ìœ ì§€) -->
    <div class="fixed bottom-6 right-6 flex flex-col items-center gap-4 z-40">
        <div class="flex flex-col items-center">
            <button onclick="goBack()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow hover:from-gray-200 hover:to-gray-300 transition">
                â†
            </button>
            <span class="text-xs mt-1 text-gray-600 font-semibold">ì´ì „</span>
        </div>

        <div class="flex flex-col items-center">
            <button onclick="goNext()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow hover:from-gray-200 hover:to-gray-300 transition">
                â†’
            </button>
            <span class="text-xs mt-1 text-gray-600 font-semibold">ë‹¤ìŒ</span>
        </div>

        <div class="flex flex-col items-center">
            <a href="/index.html"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow hover:from-blue-600 hover:to-blue-700 transition">
                ğŸ 
            </a>
            <span class="text-xs mt-1 text-gray-600 font-semibold">í™ˆ</span>
        </div>
    </div>

    <!-- âœ… footer.html ë¶ˆëŸ¬ì˜¤ê¸° -->
    <div id="footer-placeholder"></div>

    <!-- =========================
       âœ… ëª¨ë‹¬ (í‘¸ë“œë ˆì§€ìŠ¤í„°ë§¤ë‹ˆì € ìŠ¤íƒ€ì¼: ê°€ê²Œ/ì»¤ìŠ¤í…€ + ê²€ìƒ‰ì„ íƒ)
  ========================== -->
    <div id="modal" class="fixed inset-0 hidden items-center justify-center z-50">
        <div class="absolute inset-0 bg-black/40"></div>

        <div class="relative w-[95vw] max-w-4xl neo-card p-6">
            <div class="flex items-center justify-between">
                <h3 id="modalTitle" class="text-xl font-extrabold">ìŠ¬ë¡¯ í¸ì§‘</h3>
                <button id="modalClose" class="px-3 py-1 rounded-lg bg-white/70 hover:bg-white">âœ•</button>
            </div>

            <div class="mt-5 grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- ë¯¸ë¦¬ë³´ê¸° -->
                <div class="neo-card p-4">
                    <div class="text-sm font-bold mb-2">í˜„ì¬ ë¯¸ë¦¬ë³´ê¸°</div>
                    <img id="previewImg" src="/uploads/no-image.png" alt=""
                        class="w-full h-48 object-cover rounded-xl bg-white" />
                    <div class="mt-2 text-xs text-slate-600 break-all" id="previewUrl"></div>
                    <div class="mt-2 text-xs text-slate-500 break-all" id="previewLink"></div>
                </div>

                <!-- í¸ì§‘ -->
                <div class="neo-card p-4">
                    <div class="text-sm font-bold mb-3">ê¸°ë³¸ ì •ë³´</div>

                    <input type="hidden" id="f_page" value="ncategory2" />
                    <input type="hidden" id="f_position" />
                    <input type="hidden" id="f_priority" value="1" />

                    <!-- í‘¸ë“œë ˆì§€ìŠ¤í„°ë§¤ë‹ˆì € ìŠ¤íƒ€ì¼: ëª¨ë“œ -->
                    <div class="mt-1">
                        <div class="text-xs font-bold text-slate-700 mb-2">ìŠ¬ë¡¯ ëª¨ë“œ</div>
                        <div class="flex items-center gap-3">
                            <label class="inline-flex items-center gap-2 text-sm">
                                <input type="radio" name="slotMode" value="store" checked />
                                ê°€ê²Œ ì—°ê²°
                            </label>
                            <label class="inline-flex items-center gap-2 text-sm">
                                <input type="radio" name="slotMode" value="custom" />
                                ì»¤ìŠ¤í…€(ì§ì ‘ ì…ë ¥)
                            </label>
                        </div>
                        <div class="text-[11px] text-slate-500 mt-1">
                            ê°€ê²Œ ì—°ê²° ëª¨ë“œ: ì•„ë˜ ê²€ìƒ‰ì—ì„œ â€œì„ íƒâ€í•˜ë©´ í…ìŠ¤íŠ¸/ë§í¬ ìë™ ì…ë ¥
                        </div>
                    </div>

                    <input type="hidden" id="f_store_id" value="" />
                    <input type="hidden" id="f_store_type" value="" />
                    <input type="hidden" id="f_business_no" value="" />
                    <input type="hidden" id="f_category" value="" />

                    <label class="block text-xs font-bold text-slate-700 mt-3">í…ìŠ¤íŠ¸(ìƒí˜¸ëª… ë“±)</label>
                    <input id="f_text" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70" placeholder="ìƒí˜¸ëª…" />

                    <label class="block text-xs font-bold text-slate-700 mt-3">ë§í¬ URL</label>
                    <input id="f_link" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70"
                        placeholder="/ndetail.html?id=1&type=combined" />

                    <label class="block text-xs font-bold text-slate-700 mt-3">ì´ë¯¸ì§€ ì—…ë¡œë“œ</label>
                    <input id="f_image" type="file" accept="image/*" class="w-full mt-1" />

                    <div class="grid grid-cols-2 gap-3 mt-3">
                        <div>
                            <label class="block text-xs font-bold text-slate-700">ì‹œì‘ì¼</label>
                            <input id="f_start" type="date" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70" />
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-slate-700">ì¢…ë£Œì¼</label>
                            <input id="f_end" type="date" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70" />
                            <label class="flex items-center gap-2 text-xs mt-2">
                                <input id="f_noend" type="checkbox" />
                                ì¢…ë£Œ ì—†ìŒ(no_end)
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ê°€ê²Œ ê²€ìƒ‰ -->
            <div class="neo-card p-4 mt-4">
                <div class="flex items-end gap-3 flex-wrap">
                    <div>
                        <div class="text-xs font-bold">ê°€ê²Œëª…/ì—…ì¢… ê²€ìƒ‰</div>
                        <input id="s_q" class="mt-1 px-3 py-2 rounded-xl bg-white/70" placeholder="ì˜ˆ: í•˜ëŠ˜ì‹ë‹¹" />
                    </div>
                    <div>
                        <div class="text-xs font-bold">ì‚¬ì—…ìë²ˆí˜¸ ê²€ìƒ‰</div>
                        <input id="s_biz" class="mt-1 px-3 py-2 rounded-xl bg-white/70" placeholder="ìˆ«ìë§Œ/ì¼ë¶€ ê°€ëŠ¥" />
                    </div>
                    <button id="btnSearch" class="btn-3d">ê²€ìƒ‰</button>
                    <div class="text-xs text-slate-600">ê²€ìƒ‰ ê²°ê³¼ì—ì„œ â€œì„ íƒâ€í•˜ë©´ ìë™ ì…ë ¥</div>
                </div>

                <div id="searchResults" class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3"></div>
            </div>

            <div class="mt-5 flex items-center justify-between gap-3">
                <button id="btnDelete"
                    class="px-4 py-2 rounded-xl bg-red-500 text-white font-bold hover:bg-red-600">ì‚­ì œ</button>
                <div class="flex gap-2">
                    <button id="btnCancel" class="px-4 py-2 rounded-xl bg-white/70 font-bold hover:bg-white">ì·¨ì†Œ</button>
                    <button id="btnSave" class="btn-3d">ì €ì¥</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // âœ… header/footer ë™ì  í¬í•¨
        fetch("/components/header.html").then(r => r.text()).then(d => document.getElementById("header-placeholder").innerHTML = d);
        fetch("/components/footer.html").then(r => r.text()).then(d => document.getElementById("footer-placeholder").innerHTML = d);

        function toggleSub(btn) {
            const ul = btn.nextElementSibling;
            if (!ul) return;
            ul.classList.toggle("hidden");
        }

        function goBack() {
            if (document.referrer && document.referrer !== location.href) window.history.back();
            else window.location.href = "/category.html";
        }
        function goNext() { window.history.forward(); }

        // =========================
        // API
        // =========================
        const API_BASE = "/ncategory2manager/ad";
        const PAGE = "ncategory2";
        const PRIORITY = 1;

        function esc(s) {
            return String(s ?? "").replace(/[&<>"']/g, m => ({ "&": "&amp;", "<": "&lt;", ">": "&gt;", '"': "&quot;", "'": "&#39;" }[m]));
        }

        async function apiGetSlot(position) {
            const url = `${API_BASE}/slot?page=${encodeURIComponent(PAGE)}&position=${encodeURIComponent(position)}&priority=${PRIORITY}`;
            const r = await fetch(url);
            return await r.json();
        }

        async function apiSaveSlot(formData) {
            const r = await fetch(`${API_BASE}/slot`, { method: "POST", body: formData });
            return await r.json();
        }

        async function apiDeleteSlot(position) {
            const url = `${API_BASE}/slot?page=${encodeURIComponent(PAGE)}&position=${encodeURIComponent(position)}&priority=${PRIORITY}`;
            const r = await fetch(url, { method: "DELETE" });
            return await r.json();
        }

        async function apiSearchStore(q, bizNo) {
            const url = `${API_BASE}/store/search?q=${encodeURIComponent(q || "")}&bizNo=${encodeURIComponent(bizNo || "")}`;
            const r = await fetch(url);
            return await r.json();
        }

        // âœ… í”„ë¡œì íŠ¸ ë§í¬ ê·œì¹™(í•„ìš”í•˜ë©´ ì—¬ê¸°ë§Œ)
        function buildStoreLink(store_type, id) {
            if (store_type === "combined") return `/ndetail.html?id=${id}&type=combined`;
            if (store_type === "store_info") return `/ndetail.html?id=${id}&type=store_info`;
            if (store_type === "food") return `/ndetail.html?id=${id}&type=food`;
            return "#";
        }

        // =========================
        // ìŠ¬ë¡¯ ì •ì˜
        // =========================
        const SLOT = {
            sidebar: ["ncategory2_sidebar_ad_1", "ncategory2_sidebar_ad_2"],
            mvp: "ncategory2_mvp",
            highlight: "ncategory2_highlight",
            best: ["ncategory2_best_1", "ncategory2_best_2", "ncategory2_best_3", "ncategory2_best_4", "ncategory2_best_5", "ncategory2_best_6"],
            power: Array.from({ length: 9 }).map((_, i) => `ncategory2_power_${i + 1}`),
            bottom: ["ncategory2_bottom_1", "ncategory2_bottom_2"],
        };

        // =========================
        // ë Œë” helpers
        // =========================
        function parseCategoryText(rawText) {
            // ì €ì¥ëœ í…ìŠ¤íŠ¸ê°€ "ìƒí˜¸ëª… (ì—…ì¢…)" í˜•íƒœë©´ ë¶„ë¦¬í•´ì„œ ë³´ì—¬ì¤Œ
            const t = String(rawText || "").trim();
            const m = t.match(/^(.*)\s*\((.*)\)\s*$/);
            if (m) return { name: m[1].trim(), category: m[2].trim() };
            return { name: t, category: "" };
        }

        function fillSimpleSlotButton(btn, slot) {
            const imgEl = btn.querySelector('[data-role="img"]');
            const textEl = btn.querySelector('[data-role="text"]');
            const img = slot?.image_url || "/uploads/no-image.png";
            const text = slot?.text_content || "";
            if (imgEl) imgEl.src = img;
            if (textEl) textEl.textContent = text;
        }

        function fillMvpOrHighlight(btn, slot) {
            const imgEl = btn.querySelector('[data-role="img"]');
            const nameEl = btn.querySelector('[data-role="name"]');
            const catEl = btn.querySelector('[data-role="cat"]');

            const img = slot?.image_url || "/uploads/no-image.png";
            const { name, category } = parseCategoryText(slot?.text_content || "");

            imgEl.src = img;
            nameEl.textContent = name || "ë¹„ì–´ìˆìŒ";
            catEl.textContent = `ì—…ì¢…: ${category || ""}`;
        }

        function bestCardHtml(position, idx, slot) {
            const img = slot?.image_url || "/uploads/no-image.png";
            const { name, category } = parseCategoryText(slot?.text_content || "");
            const title = `BEST ${idx + 1}`;

            return `
        <button
          class="block group text-left"
          data-position="${esc(position)}"
          data-title="${esc(title)}"
        >
          <div class="neo-card p-0 overflow-hidden relative rounded-2xl transition-transform">
            <div class="w-full h-60">
              <img src="${esc(img)}" alt="${esc(name || title)}" class="w-full h-full object-cover bg-white">
            </div>
            <div class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-3">
              <div class="font-bold text-lg leading-tight">${esc(name || title)}</div>
              <div class="text-sm text-slate-600">ì—…ì¢…: ${esc(category || "")}</div>
            </div>
          </div>
        </button>
      `;
        }

        function powerItemHtml(position, idx, slot) {
            const img = slot?.image_url || "/uploads/no-image.png";
            const { name, category } = parseCategoryText(slot?.text_content || "");
            const title = `íŒŒì›Œ ê´‘ê³  ${idx + 1}`;
            return `
        <div class="w-1/3 px-2">
          <button
            class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200 w-full text-left"
            data-position="${esc(position)}"
            data-title="${esc(title)}"
          >
            <img src="${esc(img)}" alt="${esc(name || title)}" class="w-full h-60 md:h-64 object-cover bg-white">
            <div class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
              <div class="font-bold text-lg">${esc(name || title)}</div>
              <div class="text-sm text-slate-600">ì—…ì¢…: ${esc(category || "")}</div>
            </div>
          </button>
        </div>
      `;
        }

        // =========================
        // ì „ì²´ ë Œë”
        // =========================
        async function renderAll() {
            // 1) ì‚¬ì´ë“œ ìŠ¬ë¡¯ 2ê°œ
            for (const pos of SLOT.sidebar) {
                const btn = document.getElementById(`slot_${pos}`);
                if (!btn) continue;
                const data = await apiGetSlot(pos);
                fillSimpleSlotButton(btn, data?.slot || null);
            }

            // 2) MVP/HIGHLIGHT
            {
                const mvpData = await apiGetSlot(SLOT.mvp);
                const hiData = await apiGetSlot(SLOT.highlight);

                const mvpBtn = document.getElementById(`slot_${SLOT.mvp}`);
                const hiBtn = document.getElementById(`slot_${SLOT.highlight}`);

                if (mvpBtn) fillMvpOrHighlight(mvpBtn, mvpData?.slot || null);
                if (hiBtn) fillMvpOrHighlight(hiBtn, hiData?.slot || null);
            }

            // 3) BEST 6
            {
                const bestGrid = document.getElementById("bestGrid");
                bestGrid.innerHTML = "";
                for (let i = 0; i < SLOT.best.length; i++) {
                    const pos = SLOT.best[i];
                    const data = await apiGetSlot(pos);
                    bestGrid.insertAdjacentHTML("beforeend", bestCardHtml(pos, i, data?.slot || null));
                }
            }

            // 4) íŒŒì›Œ 9ê°œ -> ê·¸ë£¹ 3ê°œ(3ê°œì”©)
            {
                const track = document.getElementById("powerAdTrack");
                track.innerHTML = "";

                // ìŠ¬ë¡¯ 9ê°œ í•œë²ˆì— ì½ê¸°(ìˆœì°¨)
                const slots = [];
                for (let i = 0; i < SLOT.power.length; i++) {
                    const pos = SLOT.power[i];
                    const data = await apiGetSlot(pos);
                    slots.push({ position: pos, slot: data?.slot || null });
                }

                // 3ê°œì”© ë¬¶ê¸°
                const groupCount = Math.ceil(slots.length / 3);
                for (let g = 0; g < groupCount; g++) {
                    const group = slots.slice(g * 3, g * 3 + 3);
                    const groupHtml = `
            <div class="power-group flex basis-full shrink-0">
              ${group.map((x, idxInGroup) => powerItemHtml(x.position, g * 3 + idxInGroup, x.slot)).join("")}
            </div>
          `;
                    track.insertAdjacentHTML("beforeend", groupHtml);
                }

                // ìŠ¬ë¼ì´ë” ì´ˆê¸°í™”(ê·¸ë£¹ ê°œìˆ˜ ê¸°ë°˜)
                initPowerSlider(groupCount);
            }

            // 5) í•˜ë‹¨ë°•ìŠ¤ 2ê°œ(í…ìŠ¤íŠ¸ë§Œ í‘œì‹œ)
            for (const pos of SLOT.bottom) {
                const btn = document.getElementById(`slot_${pos}`);
                if (!btn) continue;
                const data = await apiGetSlot(pos);
                const t = btn.querySelector('[data-role="text"]');
                if (t) t.textContent = (data?.slot?.text_content || "í´ë¦­í•´ì„œ ë‚´ìš© í¸ì§‘");
            }

            // 6) í´ë¦­ í•¸ë“¤ëŸ¬(ìŠ¬ë¡¯ ë²„íŠ¼ë“¤ + best + power ë‚´ë¶€ ë²„íŠ¼ë“¤)
            bindSlotClicks();
        }

        function bindSlotClicks() {
            document.querySelectorAll("[data-position][data-title]").forEach(el => {
                el.addEventListener("click", async () => {
                    const position = el.dataset.position;
                    const title = el.dataset.title;
                    await openModal(position, title);
                }, { once: true });
            });
        }

        // =========================
        // íŒŒì›Œ ìŠ¬ë¼ì´ë” (ëŠë¦¬ê²Œ + ëì—ì„œ ë°©í–¥ ë°˜ì „)
        // =========================
        let powerSliderInited = false;
        function initPowerSlider(groups) {
            const viewport = document.getElementById("powerViewport");
            const track = document.getElementById("powerAdTrack");
            if (!viewport || !track) return;

            // ê¸°ì¡´ íƒ€ì´ë¨¸/ë¦¬ìŠ¤ë„ˆ ì¤‘ë³µ ë°©ì§€(ë‹¨ìˆœ)
            if (powerSliderInited) {
                // transformë§Œ ë‹¤ì‹œ ë§ì¶¤
                requestAnimationFrame(() => {
                    const slideWidth = viewport.clientWidth;
                    track.style.transform = `translateX(0px)`;
                });
                return;
            }
            powerSliderInited = true;

            let index = Math.floor(Math.random() * Math.max(groups, 1));
            let dir = 1;

            function updateSlider() {
                const slideWidth = viewport.clientWidth;
                track.style.transform = `translateX(${-index * slideWidth}px)`;
            }

            function stepAuto() {
                if (groups <= 1) return;
                if (index >= groups - 1) dir = -1;
                else if (index <= 0) dir = 1;
                index = index + dir;
                updateSlider();
            }

            function nextManual() {
                if (groups <= 1) return;
                if (index < groups - 1) index++;
                else { dir = -1; index = Math.max(groups - 2, 0); }
                updateSlider();
            }

            function prevManual() {
                if (groups <= 1) return;
                if (index > 0) index--;
                else { dir = 1; index = Math.min(1, groups - 1); }
                updateSlider();
            }

            const nextBtn = document.getElementById("nextBtn");
            const prevBtn = document.getElementById("prevBtn");

            const INTERVAL = 10000;
            let timer = null;

            function startAuto() { if (!timer) timer = setInterval(stepAuto, INTERVAL); }
            function stopAuto() { if (timer) { clearInterval(timer); timer = null; } }

            if (nextBtn && prevBtn) {
                nextBtn.addEventListener("click", () => { stopAuto(); nextManual(); startAuto(); });
                prevBtn.addEventListener("click", () => { stopAuto(); prevManual(); startAuto(); });
            }

            window.addEventListener("resize", updateSlider);
            document.addEventListener("visibilitychange", () => { document.hidden ? stopAuto() : startAuto(); });
            viewport.addEventListener("mouseenter", stopAuto);
            viewport.addEventListener("mouseleave", startAuto);

            // ì´ˆê¸°
            updateSlider();
            startAuto();
        }

        // =========================
        // ëª¨ë‹¬ ë¡œì§
        // =========================
        const modal = document.getElementById("modal");
        const modalTitle = document.getElementById("modalTitle");
        const previewImg = document.getElementById("previewImg");
        const previewUrl = document.getElementById("previewUrl");
        const previewLink = document.getElementById("previewLink");

        const f_position = document.getElementById("f_position");
        const f_text = document.getElementById("f_text");
        const f_link = document.getElementById("f_link");
        const f_image = document.getElementById("f_image");
        const f_start = document.getElementById("f_start");
        const f_end = document.getElementById("f_end");
        const f_noend = document.getElementById("f_noend");

        const f_store_id = document.getElementById("f_store_id");
        const f_store_type = document.getElementById("f_store_type");
        const f_business_no = document.getElementById("f_business_no");
        const f_category = document.getElementById("f_category");

        let currentPosition = "";
        let currentSlot = null;

        function showModal() { modal.classList.remove("hidden"); modal.classList.add("flex"); }
        function hideModal() { modal.classList.add("hidden"); modal.classList.remove("flex"); }

        function getSlotMode() {
            const el = document.querySelector('input[name="slotMode"]:checked');
            return el ? el.value : "store";
        }

        function setSlotMode(mode) {
            const target = document.querySelector(`input[name="slotMode"][value="${mode}"]`);
            if (target) target.checked = true;
        }

        async function openModal(position, title) {
            currentPosition = position;
            modalTitle.textContent = `ìŠ¬ë¡¯ í¸ì§‘ - ${title}`;
            f_position.value = position;
            f_image.value = "";

            const data = await apiGetSlot(position);
            currentSlot = data?.slot || null;

            const img = currentSlot?.image_url || "/uploads/no-image.png";
            previewImg.src = img;
            previewUrl.textContent = `image: ${img}`;
            previewLink.textContent = `link: ${currentSlot?.link_url || ""}`;

            f_text.value = currentSlot?.text_content || "";
            f_link.value = currentSlot?.link_url || "";
            f_start.value = (currentSlot?.start_at || "").slice(0, 10);
            f_end.value = (currentSlot?.end_at || "").slice(0, 10);
            f_noend.checked = !!currentSlot?.no_end;

            // ê¸°ì¡´ì— ì €ì¥ëœ store_id/store_typeê°€ ë‚´ë ¤ì˜¤ë©´ ë°˜ì˜(ì—†ìœ¼ë©´ ë¹„ì›€)
            f_store_id.value = currentSlot?.store_id ?? "";
            f_store_type.value = currentSlot?.store_type ?? "";
            f_business_no.value = currentSlot?.business_no ?? "";
            f_category.value = currentSlot?.category ?? "";

            // slot_mode ë‚´ë ¤ì˜¤ë©´ ë°˜ì˜(ì—†ìœ¼ë©´ store)
            setSlotMode(currentSlot?.slot_mode || "store");

            document.getElementById("searchResults").innerHTML = "";
            showModal();
        }

        document.getElementById("modalClose").addEventListener("click", hideModal);
        document.getElementById("btnCancel").addEventListener("click", hideModal);

        // ì €ì¥
        document.getElementById("btnSave").addEventListener("click", async () => {
            const mode = getSlotMode();

            const fd = new FormData();
            fd.append("page", PAGE);
            fd.append("position", currentPosition);
            fd.append("priority", String(PRIORITY));

            // âœ… í‘¸ë“œë ˆì§€ìŠ¤í„°ë§¤ë‹ˆì € ìŠ¤íƒ€ì¼: slot_mode ê°™ì´ ë³´ëƒ„(ì„œë²„ê°€ ë°›ìœ¼ë©´ ì €ì¥, ì•ˆ ë°›ìœ¼ë©´ ë¬´ì‹œ)
            fd.append("slot_mode", mode);

            // ê°€ê²Œ ì—°ê²° ëª¨ë“œë©´ store_id/store_typeë„ ê°™ì´
            fd.append("store_id", f_store_id.value || "");
            fd.append("store_type", f_store_type.value || "");
            fd.append("business_no", f_business_no.value || "");
            fd.append("category", f_category.value || "");

            fd.append("text_content", f_text.value || "");
            fd.append("link_url", f_link.value || "");
            fd.append("start_at", f_start.value || "");
            fd.append("end_at", f_end.value || "");
            fd.append("no_end", f_noend.checked ? "true" : "false");

            if (f_image.files && f_image.files[0]) {
                fd.append("slotImage", f_image.files[0]);
            }

            const res = await apiSaveSlot(fd);
            if (!res?.ok) {
                alert("ì €ì¥ ì‹¤íŒ¨: " + (res?.message || "unknown"));
                return;
            }

            hideModal();
            await renderAll();
            powerSliderInited = false; // íŠ¸ë™ ë‹¤ì‹œ ê·¸ë ¸ìœ¼ë‹ˆ ì¬ì´ˆê¸°í™” í—ˆìš©
        });

        // ì‚­ì œ
        document.getElementById("btnDelete").addEventListener("click", async () => {
            if (!confirm("ì´ ìŠ¬ë¡¯ì„ ì‚­ì œí• ê¹Œìš”? (ì´ë¯¸ì§€ íŒŒì¼ì€ ì‚­ì œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤)")) return;
            const res = await apiDeleteSlot(currentPosition);
            if (!res?.ok) {
                alert("ì‚­ì œ ì‹¤íŒ¨: " + (res?.message || "unknown"));
                return;
            }
            hideModal();
            await renderAll();
            powerSliderInited = false;
        });

        // ê°€ê²Œ ê²€ìƒ‰
        document.getElementById("btnSearch").addEventListener("click", async () => {
            const mode = getSlotMode();
            if (mode !== "store") {
                // ì»¤ìŠ¤í…€ ëª¨ë“œì—ì„œë„ ê²€ìƒ‰ì€ ê°€ëŠ¥í•˜ì§€ë§Œ, ë³´í†µì€ storeì—ì„œë§Œ ì“°ëŠ”ê²Œ ë§ìŒ.
                // ê·¸ë˜ë„ ë§‰ì§€ ì•Šê³  ì•ˆë‚´ë§Œ.
                // (ì›í•˜ë©´ ì—¬ê¸°ì„œ returnìœ¼ë¡œ ë§‰ì•„ë„ ë¨)
            }

            const q = document.getElementById("s_q").value || "";
            const biz = document.getElementById("s_biz").value || "";
            const data = await apiSearchStore(q, biz);

            const root = document.getElementById("searchResults");
            root.innerHTML = "";

            const stores = data?.stores || [];
            if (stores.length === 0) {
                root.innerHTML = `<div class="text-sm text-slate-600">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</div>`;
                return;
            }

            stores.forEach(s => {
                const link = buildStoreLink(s.store_type, s.id);
                const card = document.createElement("div");
                card.className = "neo-card p-3";
                card.innerHTML = `
          <div class="font-bold">${esc(s.business_name)}</div>
          <div class="text-xs text-slate-600 mt-1">${esc(s.category || "")}</div>
          <div class="text-[11px] text-slate-500 mt-1">ì‚¬ì—…ì: ${esc(s.business_no || "")}</div>
          <div class="text-[11px] text-slate-500 mt-1 break-all">ë§í¬: ${esc(link)}</div>
          <button class="mt-2 px-3 py-1 rounded-lg bg-blue-600 text-white text-xs font-bold hover:bg-blue-700">ì„ íƒ</button>
        `;

                card.querySelector("button").addEventListener("click", () => {
                    // âœ… ê°€ê²Œ ì„ íƒí•˜ë©´(í‘¸ë“œë ˆì§€ìŠ¤í„°ë§¤ë‹ˆì € ë°©ì‹)
                    setSlotMode("store");

                    // (ì—…ì¢… í‘œê¸°ê¹Œì§€ ê°™ì´ ì €ì¥í•˜ê³  ì‹¶ìœ¼ë©´) "ìƒí˜¸ëª… (ì—…ì¢…)" í˜•íƒœë¡œ ì €ì¥
                    const name = s.business_name || "";
                    const cat = s.category || "";
                    f_text.value = cat ? `${name} (${cat})` : name;
                    f_link.value = link;

                    f_store_id.value = String(s.id ?? "");
                    f_store_type.value = String(s.store_type ?? "");
                    f_business_no.value = String(s.business_no ?? "");
                    f_category.value = String(s.category ?? "");
                });

                root.appendChild(card);
            });
        });

        // =========================
        // ì‹œì‘
        // =========================
        renderAll();
    </script>
</body>

</html>