<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>ncategory2 ë§¤ë‹ˆì €</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .neo-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 1.2rem;
            box-shadow: 6px 6px 16px #d9e0ec, -6px -6px 16px #ffffff;
            backdrop-filter: blur(16px) saturate(120%);
            transition: all .25s ease;
        }

        .neo-card:hover {
            transform: translateY(-4px);
            box-shadow: 4px 4px 12px #cfd8e6, -4px -4px 12px #ffffff, 0 8px 24px rgba(80, 130, 255, 0.15);
        }

        .btn-3d {
            background: linear-gradient(90deg, #6dd5fa, #2980b9);
            border-radius: 1.3rem;
            padding: .5rem 1.5rem;
            font-weight: 800;
            color: white;
            box-shadow: 0 4px 0 #2393b3, 0 8px 16px rgba(0, 64, 128, 0.14);
            transition: all .15s;
        }

        .btn-3d:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #2393b3, 0 4px 10px rgba(0, 64, 128, 0.16);
        }

        .sidebar-scroll {
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: transparent transparent;
        }

        .sidebar-scroll:hover {
            scrollbar-color: #cbd5e1 transparent;
        }

        .sidebar-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar-scroll::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 9999px;
        }

        .sidebar-scroll:hover::-webkit-scrollbar-thumb {
            background: #cbd5e1;
        }

        .sidebar-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 via-white to-blue-100 min-h-screen text-gray-800">
    <div id="header-placeholder"></div>

    <header class="py-6 text-center">
        <h1 class="text-3xl font-bold text-blue-700">ncategory2 ë§¤ë‹ˆì €</h1>
        <p class="text-gray-600 mt-1">ìŠ¬ë¡¯ í´ë¦­ â†’ ëª¨ë‹¬ í¸ì§‘ â†’ ì €ì¥/ì‚­ì œ</p>
    </header>

    <div class="max-w-6xl mx-auto grid grid-cols-12 gap-6 py-6 px-4">

        <!-- ì¢Œì¸¡ ì‚¬ì´ë“œë°” -->
        <aside class="col-span-3 neo-card p-4 h-full max-h-[1346px] sidebar-scroll">
            <div class="text-center mb-4">
                <h2 class="font-extrabold text-2xl tracking-tight">CATEGORY</h2>
                <p class="text-xs text-slate-600 mt-1">ì¹´í…Œê³ ë¦¬ë¥¼ í¼ì³ì„œ ì„ íƒí•˜ì„¸ìš”</p>
            </div>

            <ul class="space-y-4">
                <li>
                    <button class="w-full neo-card flex items-center justify-between px-4 py-3 font-extrabold text-xl"
                        onclick="toggleSub(this)" type="button">
                        <span>ìŒ ì‹</span><span class="text-base">â–¼</span>
                    </button>
                    <ul class="mt-2 ml-2 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=food&category=í•œì‹"
                                class="block neo-card px-4 py-3 text-center font-bold">í•œì‹</a></li>
                        <li><a href="/subcategory.html?type=food&category=ì–‘ì‹"
                                class="block neo-card px-4 py-3 text-center font-bold">ì–‘ì‹</a></li>
                        <li><a href="/subcategory.html?type=food&category=ì¤‘ì‹"
                                class="block neo-card px-4 py-3 text-center font-bold">ì¤‘ì‹</a></li>
                        <li><a href="/subcategory.html?type=food&category=ì¼ì‹"
                                class="block neo-card px-4 py-3 text-center font-bold">ì¼ì‹</a></li>
                        <li><a href="/subcategory.html?type=food&category=ë¶„ì‹"
                                class="block neo-card px-4 py-3 text-center font-bold">ë¶„ì‹</a></li>
                        <li><a href="/subcategory.html?type=food&category=ì¹˜í‚¨"
                                class="block neo-card px-4 py-3 text-center font-bold">ì¹˜í‚¨</a></li>
                        <li><a href="/subcategory.html?type=food&category=í”¼ì"
                                class="block neo-card px-4 py-3 text-center font-bold">í”¼ì</a></li>
                        <li><a href="/subcategory.html?type=food&category=ì¹´í˜/ë””ì €íŠ¸"
                                class="block neo-card px-4 py-3 text-center font-bold">ì¹´í˜/ë””ì €íŠ¸</a></li>
                        <li><a href="/subcategory.html?type=food&category=íŒ¨ìŠ¤íŠ¸í‘¸ë“œ"
                                class="block neo-card px-4 py-3 text-center font-bold">íŒ¨ìŠ¤íŠ¸í‘¸ë“œ</a></li>
                        <li><a href="/subcategory.html?type=food&category=ê¸°íƒ€"
                                class="block neo-card px-4 py-3 text-center font-bold">ê¸°íƒ€</a></li>
                    </ul>
                </li>

                <li>
                    <button class="w-full neo-card flex items-center justify-between px-4 py-3 font-extrabold text-xl"
                        onclick="toggleSub(this)" type="button">
                        <span>ë¯¸ìš©/ì´ë°œ</span><span class="text-base">â–¼</span>
                    </button>
                    <ul class="mt-2 ml-2 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=beauty&category=ë¯¸ìš©"
                                class="block neo-card px-4 py-3 text-center font-bold">ë¯¸ìš©</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=ì´ë°œ"
                                class="block neo-card px-4 py-3 text-center font-bold">ì´ë°œ</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=ë„¤ì¼"
                                class="block neo-card px-4 py-3 text-center font-bold">ë„¤ì¼</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=í”¼ë¶€ê´€ë¦¬"
                                class="block neo-card px-4 py-3 text-center font-bold">í”¼ë¶€ê´€ë¦¬</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=ì™ì‹±"
                                class="block neo-card px-4 py-3 text-center font-bold">ì™ì‹±</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=ê¸°íƒ€"
                                class="block neo-card px-4 py-3 text-center font-bold">ê¸°íƒ€</a></li>
                    </ul>
                </li>

                <li>
                    <button class="w-full neo-card flex items-center justify-between px-4 py-3 font-extrabold text-xl"
                        onclick="toggleSub(this)" type="button">
                        <span>ë³‘ ì›</span><span class="text-base">â–¼</span>
                    </button>
                    <ul class="mt-2 ml-2 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=hospital&category=ì¢…í•©ë³‘ì›"
                                class="block neo-card px-4 py-3 text-center font-bold">ì¢…í•©ë³‘ì›</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=ë‚´ê³¼"
                                class="block neo-card px-4 py-3 text-center font-bold">ë‚´ê³¼</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=ì¹˜ê³¼"
                                class="block neo-card px-4 py-3 text-center font-bold">ì¹˜ê³¼</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=ì†Œì•„ê³¼"
                                class="block neo-card px-4 py-3 text-center font-bold">ì†Œì•„ê³¼</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=ì •í˜•ì™¸ê³¼"
                                class="block neo-card px-4 py-3 text-center font-bold">ì •í˜•ì™¸ê³¼</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=ì‚°ë¶€ì¸ê³¼"
                                class="block neo-card px-4 py-3 text-center font-bold">ì‚°ë¶€ì¸ê³¼</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=í•œì˜ì›"
                                class="block neo-card px-4 py-3 text-center font-bold">í•œì˜ì›</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=ê¸°íƒ€"
                                class="block neo-card px-4 py-3 text-center font-bold">ê¸°íƒ€</a></li>
                    </ul>
                </li>

                <li>
                    <button class="w-full neo-card flex items-center justify-between px-4 py-3 font-extrabold text-xl"
                        onclick="toggleSub(this)" type="button">
                        <span>ì•½ êµ­</span><span class="text-base">â–¼</span>
                    </button>
                    <ul class="mt-2 ml-2 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=pharmacy&category=ì¼ë°˜ì•½êµ­"
                                class="block neo-card px-4 py-3 text-center font-bold">ì¼ë°˜ì•½êµ­</a></li>
                        <li><a href="/subcategory.html?type=pharmacy&category=24ì‹œì•½êµ­"
                                class="block neo-card px-4 py-3 text-center font-bold">24ì‹œì•½êµ­</a></li>
                        <li><a href="/subcategory.html?type=pharmacy&category=í•œì•½ë°©"
                                class="block neo-card px-4 py-3 text-center font-bold">í•œì•½ë°©</a></li>
                        <li><a href="/subcategory.html?type=pharmacy&category=ê¸°íƒ€"
                                class="block neo-card px-4 py-3 text-center font-bold">ê¸°íƒ€</a></li>
                    </ul>
                </li>

                <li>
                    <button class="w-full neo-card flex items-center justify-between px-4 py-3 font-extrabold text-xl"
                        onclick="toggleSub(this)" type="button">
                        <span>ë§ˆ íŠ¸</span><span class="text-base">â–¼</span>
                    </button>
                    <ul class="mt-2 ml-2 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=mart&category=ëŒ€í˜•ë§ˆíŠ¸"
                                class="block neo-card px-4 py-3 text-center font-bold">ëŒ€í˜•ë§ˆíŠ¸</a></li>
                        <li><a href="/subcategory.html?type=mart&category=ì¤‘ì†Œë§ˆíŠ¸"
                                class="block neo-card px-4 py-3 text-center font-bold">ì¤‘ì†Œë§ˆíŠ¸</a></li>
                        <li><a href="/subcategory.html?type=mart&category=ìŠˆí¼ë§ˆì¼“"
                                class="block neo-card px-4 py-3 text-center font-bold">ìŠˆí¼ë§ˆì¼“</a></li>
                        <li><a href="/subcategory.html?type=mart&category=ê¸°íƒ€"
                                class="block neo-card px-4 py-3 text-center font-bold">ê¸°íƒ€</a></li>
                    </ul>
                </li>

                <li>
                    <button class="w-full neo-card flex items-center justify-between px-4 py-3 font-extrabold text-xl"
                        onclick="toggleSub(this)" type="button">
                        <span>í•™ ì›</span><span class="text-base">â–¼</span>
                    </button>
                    <ul class="mt-2 ml-2 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=academy&category=ì…ì‹œí•™ì›"
                                class="block neo-card px-4 py-3 text-center font-bold">ì…ì‹œí•™ì›</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ì˜ì–´"
                                class="block neo-card px-4 py-3 text-center font-bold">ì˜ì–´</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ìˆ˜í•™"
                                class="block neo-card px-4 py-3 text-center font-bold">ìˆ˜í•™</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ìŒì•…"
                                class="block neo-card px-4 py-3 text-center font-bold">ìŒì•…</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ë¯¸ìˆ "
                                class="block neo-card px-4 py-3 text-center font-bold">ë¯¸ìˆ </a></li>
                        <li><a href="/subcategory.html?type=academy&category=ì»´í“¨í„°"
                                class="block neo-card px-4 py-3 text-center font-bold">ì»´í“¨í„°</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ì²´ìœ¡"
                                class="block neo-card px-4 py-3 text-center font-bold">ì²´ìœ¡</a></li>
                        <li><a href="/subcategory.html?type=academy&category=ê¸°íƒ€"
                                class="block neo-card px-4 py-3 text-center font-bold">ê¸°íƒ€</a></li>
                    </ul>
                </li>
            </ul>

            <!-- âœ… ì‚¬ì´ë“œ ê´‘ê³  ìŠ¬ë¡¯ 2ê°œ -->
            <div class="mt-6 space-y-4">
                <button id="slot_ncategory2_sidebar_ad_1" data-position="ncategory2_sidebar_ad_1" data-title="ì‚¬ì´ë“œ ê´‘ê³  1"
                    class="neo-card w-full p-3 text-left" type="button">
                    <div class="font-bold text-lg mb-2">ì‚¬ì´ë“œ ê´‘ê³  1</div>
                    <img data-role="img" src="/uploads/no-image.png" alt="ì‚¬ì´ë“œ ê´‘ê³  1"
                        class="w-full h-[70px] object-cover rounded-xl bg-white" />
                    <div data-role="text" class="text-sm text-slate-700 mt-2 clamp-2"></div>
                </button>

                <button id="slot_ncategory2_sidebar_ad_2" data-position="ncategory2_sidebar_ad_2" data-title="ì‚¬ì´ë“œ ê´‘ê³  2"
                    class="neo-card w-full p-3 text-left" type="button">
                    <div class="font-bold text-lg mb-2">ì‚¬ì´ë“œ ê´‘ê³  2</div>
                    <img data-role="img" src="/uploads/no-image.png" alt="ì‚¬ì´ë“œ ê´‘ê³  2"
                        class="w-full h-[70px] object-cover rounded-xl bg-white" />
                    <div data-role="text" class="text-sm text-slate-700 mt-2 clamp-2"></div>
                </button>
            </div>
        </aside>

        <!-- ì¤‘ì•™ ë©”ì¸ -->
        <main class="col-span-9 space-y-8">

            <!-- âœ… Premium (í´ë¦­ë˜ëŠ” ìŠ¬ë¡¯ ë²„íŠ¼) -->
            <button id="slot_ncategory2_premium" data-position="ncategory2_premium" data-title="í”„ë¦¬ë¯¸ì—„ ë°°ë„ˆ" type="button"
                class="relative h-60 neo-card w-full flex items-center justify-center text-center overflow-hidden">
                <img data-role="img" src="/uploads/no-image.png"
                    class="absolute inset-0 w-full h-full object-cover opacity-30 pointer-events-none" alt="premium" />
                <div class="relative px-6 pointer-events-none">
                    <h1 class="text-3xl font-extrabold mb-2">Premium ì¹´í…Œê³ ë¦¬</h1>
                    <p data-role="text" class="text-gray-700 text-sm font-bold">
                        ì¹´í…Œê³ ë¦¬ ì„¤ëª… ë¬¸êµ¬ë¥¼ ì—¬ê¸°ì— ë„£ìŠµë‹ˆë‹¤.
                    </p>
                    <div class="mt-3 text-xs text-slate-600 break-all" data-role="link"></div>
                </div>
            </button>

            <!-- íŒŒì›Œ ê´‘ê³  -->
            <!-- âœ… ê°•ë ¥ ì¶”ì²œ(íŒŒì›Œ ê´‘ê³  9ê°œ) -->
            <section class="mt-10">
                <h2 class="font-bold text-2xl text-purple-600 text-center mb-4">ê°•ë ¥ ì¶”ì²œ</h2>

                <div class="neo-card p-4">
                    <div id="powerViewport" class="relative overflow-hidden">
                        <div id="powerAdTrack"
                            class="flex gap-4 transition-transform duration-700 ease-in-out will-change-transform">
                            <!-- âœ… JSì—ì„œ íŒŒì›Œ ìŠ¬ë¡¯ 9ê°œ ì¹´ë“œ ìƒì„± -->
                        </div>

                        <button id="prevBtn" type="button"
                            class="absolute left-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white shadow rounded-full w-10 h-10 flex items-center justify-center font-extrabold">
                            â€¹
                        </button>
                        <button id="nextBtn" type="button"
                            class="absolute right-2 top-1/2 -translate-y-1/2 bg-white/80 hover:bg-white shadow rounded-full w-10 h-10 flex items-center justify-center font-extrabold">
                            â€º
                        </button>
                    </div>

                    <p class="text-xs text-slate-600 mt-3 text-center">
                        ì¹´ë“œ í´ë¦­ â†’ ëª¨ë‹¬ í¸ì§‘ â†’ ì €ì¥
                    </p>
                </div>
            </section>

            <!-- ìµœê³ ì˜ ê°€ê²Œ -->
            <section class="grid grid-cols-12 gap-6 items-stretch">
                <div class="col-span-3 h-full">
                    <div class="neo-card p-4 w-full h-full flex flex-col gap-4">
                        <button id="slot_ncategory2_mvp" data-position="ncategory2_mvp" data-title="MVP"
                            class="flex-1 flex flex-col text-left" type="button">
                            <h2 class="font-bold text-2xl text-blue-600 text-center mb-3">MVP</h2>
                            <div
                                class="neo-card p-0 overflow-hidden relative rounded-2xl h-full border-2 border-blue-500">
                                <img data-role="img" src="/uploads/no-image.png" class="w-full h-full object-cover"
                                    alt="MVP">
                                <div
                                    class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                    <div data-role="name" class="font-bold text-lg leading-tight">ë¹„ì–´ìˆìŒ</div>
                                    <div data-role="cat" class="text-sm text-slate-600">ì—…ì¢…:</div>
                                </div>
                            </div>
                        </button>

                        <button id="slot_ncategory2_highlight" data-position="ncategory2_highlight"
                            data-title="HIGHLIGHT" class="flex-1 flex flex-col text-left" type="button">
                            <h2 class="font-bold text-2xl text-yellow-600 text-center mb-3">HIGHLIGHT</h2>
                            <div
                                class="neo-card p-0 overflow-hidden relative rounded-2xl h-full border-2 border-yellow-500">
                                <img data-role="img" src="/uploads/no-image.png" class="w-full h-full object-cover"
                                    alt="HIGHLIGHT">
                                <div
                                    class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                    <div data-role="name" class="font-bold text-lg leading-tight">ë¹„ì–´ìˆìŒ</div>
                                    <div data-role="cat" class="text-sm text-slate-600">ì—…ì¢…:</div>
                                </div>
                            </div>
                        </button>
                    </div>
                </div>

                <div class="col-span-9 flex flex-col gap-6">
                    <div class="neo-card p-5">
                        <h2 class="font-bold mb-3 text-2xl text-center">ìµœê³ ì˜ ê°€ê²Œ</h2>
                        <div id="bestGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"></div>
                    </div>
                </div>
            </section>

            <div class="grid grid-cols-2 gap-6">
                <button id="slot_ncategory2_bottom_1" data-position="ncategory2_bottom_1" data-title="í•˜ë‹¨ ë°•ìŠ¤ 1"
                    class="neo-card p-6 text-center" type="button">
                    <h3 class="font-bold text-lg mb-2">í•˜ë‹¨ ë°•ìŠ¤ 1</h3>
                    <p data-role="text" class="text-gray-600 text-sm">í´ë¦­í•´ì„œ ë‚´ìš© í¸ì§‘</p>
                </button>

                <button id="slot_ncategory2_bottom_2" data-position="ncategory2_bottom_2" data-title="í•˜ë‹¨ ë°•ìŠ¤ 2"
                    class="neo-card p-6 text-center" type="button">
                    <h3 class="font-bold text-lg mb-2">í•˜ë‹¨ ë°•ìŠ¤ 2</h3>
                    <p data-role="text" class="text-gray-600 text-sm">í´ë¦­í•´ì„œ ë‚´ìš© í¸ì§‘</p>
                </button>
            </div>

        </main>
    </div>

    <!-- ì˜¤ë¥¸ìª½ í•˜ë‹¨ ë„¤ë¹„ -->
    <div class="fixed bottom-6 right-6 flex flex-col items-center gap-4 z-40">
        <div class="flex flex-col items-center">
            <button onclick="goBack()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow hover:from-gray-200 hover:to-gray-300 transition"
                type="button">â†</button>
            <span class="text-xs mt-1 text-gray-600 font-semibold">ì´ì „</span>
        </div>

        <div class="flex flex-col items-center">
            <button onclick="goNext()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow hover:from-gray-200 hover:to-gray-300 transition"
                type="button">â†’</button>
            <span class="text-xs mt-1 text-gray-600 font-semibold">ë‹¤ìŒ</span>
        </div>

        <div class="flex flex-col items-center">
            <a href="/index.html"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow hover:from-blue-600 hover:to-blue-700 transition">ğŸ </a>
            <span class="text-xs mt-1 text-gray-600 font-semibold">í™ˆ</span>
        </div>
    </div>

    <div id="footer-placeholder"></div>

    <!-- âœ… ëª¨ë‹¬: neo-card/btn-3dë¡œë§Œ í†µì¼ -->
    <div id="modal" class="fixed inset-0 hidden z-50">
        <div id="modalOverlay" class="absolute inset-0 bg-black/40"></div>

        <div class="relative mx-auto mt-10 w-[95vw] max-w-4xl neo-card p-6">
            <div class="flex items-center justify-between gap-3">
                <div>
                    <h3 id="modalTitle" class="text-xl font-extrabold text-blue-700">ìŠ¬ë¡¯ í¸ì§‘</h3>
                    <p class="text-xs text-slate-600 mt-1">ìŠ¬ë¡¯ í´ë¦­ â†’ ê°€ê²Œ ê²€ìƒ‰(ì„ íƒ) ë˜ëŠ” ì§ì ‘ ì…ë ¥ â†’ ì €ì¥/ì‚­ì œ</p>
                </div>
                <button id="modalClose" class="px-3 py-1 rounded-xl bg-white/70 hover:bg-white font-bold"
                    type="button">âœ•</button>
            </div>

            <div class="mt-5 grid grid-cols-1 lg:grid-cols-12 gap-5">
                <!-- ë¯¸ë¦¬ë³´ê¸° -->
                <div class="lg:col-span-5 neo-card p-4">
                    <div class="flex items-center justify-between">
                        <div class="text-sm font-extrabold">í˜„ì¬ ë¯¸ë¦¬ë³´ê¸°</div>
                        <div class="text-[11px] text-slate-500" id="previewMeta"></div>
                    </div>

                    <div class="mt-3">
                        <img id="previewImg" src="/uploads/no-image.png" alt=""
                            class="w-full h-56 object-cover rounded-2xl bg-white" />
                        <div class="mt-2 text-[11px] text-slate-600 break-all" id="previewUrl"></div>
                    </div>

                    <div class="mt-4 grid grid-cols-2 gap-3">
                        <div class="neo-card p-3">
                            <div class="text-xs font-bold text-slate-700">í…ìŠ¤íŠ¸</div>
                            <div id="previewText" class="text-sm text-slate-800 mt-1 break-words"></div>
                        </div>
                        <div class="neo-card p-3">
                            <div class="text-xs font-bold text-slate-700">ë§í¬</div>
                            <div id="previewLink" class="text-[12px] text-slate-600 mt-1 break-all"></div>
                        </div>
                    </div>
                </div>

                <!-- í¸ì§‘í¼ -->
                <div class="lg:col-span-7 space-y-4">
                    <div class="neo-card p-4">
                        <div class="text-sm font-extrabold mb-3">ìŠ¬ë¡¯ ê¸°ë³¸ ì •ë³´</div>

                        <input type="hidden" id="f_position" />

                        <div class="grid grid-cols-1 gap-3">
                            <div>
                                <label class="block text-xs font-bold text-slate-700">í…ìŠ¤íŠ¸(ìƒí˜¸ëª… ë“±)</label>
                                <input id="f_text" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70"
                                    placeholder="ì˜ˆ: í•˜ëŠ˜ì‹ë‹¹" />
                            </div>

                            <div>
                                <label class="block text-xs font-bold text-slate-700">ë§í¬ URL</label>
                                <input id="f_link" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70"
                                    placeholder="/ndetail.html?id=1&type=combined" />
                            </div>

                            <div>
                                <label class="block text-xs font-bold text-slate-700">ì´ë¯¸ì§€ ì—…ë¡œë“œ</label>
                                <input id="f_image" type="file" accept="image/*" class="w-full mt-1" />
                                <div class="text-[11px] text-slate-500 mt-1">ì´ë¯¸ì§€ ì—†ìœ¼ë©´ ê¸°ì¡´ ì´ë¯¸ì§€ ìœ ì§€</div>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 mt-4">
                            <div>
                                <label class="block text-xs font-bold text-slate-700">ì‹œì‘ì¼</label>
                                <input id="f_start" type="date" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70" />
                            </div>
                            <div>
                                <label class="block text-xs font-bold text-slate-700">ì¢…ë£Œì¼</label>
                                <input id="f_end" type="date" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70" />
                                <label class="mt-2 inline-flex items-center gap-2 text-xs text-slate-700 font-bold">
                                    <input id="f_noend" type="checkbox" />
                                    ì¢…ë£Œ ì—†ìŒ(no_end)
                                </label>
                            </div>
                        </div>
                    </div>

                    <div class="neo-card p-4">
                        <div class="flex items-center justify-between gap-3">
                            <div>
                                <div class="text-sm font-extrabold">ê°€ê²Œ ê²€ìƒ‰</div>
                                <div class="text-[11px] text-slate-600 mt-1">ê²€ìƒ‰ í›„ â€œì„ íƒâ€í•˜ë©´ í…ìŠ¤íŠ¸/ë§í¬ ìë™ ì…ë ¥</div>
                            </div>
                            <button id="btnSearch" class="btn-3d" type="button">ê²€ìƒ‰</button>
                        </div>

                        <div class="mt-3 grid grid-cols-1 md:grid-cols-2 gap-3">
                            <div>
                                <div class="text-xs font-bold text-slate-700">ê°€ê²Œëª…/ì—…ì¢… ê²€ìƒ‰</div>
                                <input id="s_q" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70"
                                    placeholder="ì˜ˆ: í•˜ëŠ˜ì‹ë‹¹" />
                            </div>
                            <div>
                                <div class="text-xs font-bold text-slate-700">ì‚¬ì—…ìë²ˆí˜¸ ê²€ìƒ‰</div>
                                <input id="s_biz" class="w-full mt-1 px-3 py-2 rounded-xl bg-white/70"
                                    placeholder="ìˆ«ìë§Œ/ì¼ë¶€ ê°€ëŠ¥" />
                            </div>
                        </div>

                        <div id="searchResults" class="mt-4 grid grid-cols-1 md:grid-cols-2 gap-3"></div>
                    </div>

                    <div class="flex items-center justify-between gap-3">
                        <button id="btnDelete"
                            class="px-4 py-2 rounded-xl bg-red-500 text-white font-extrabold hover:bg-red-600"
                            type="button">ì‚­ì œ</button>

                        <div class="flex gap-2">
                            <button id="btnCancel"
                                class="px-4 py-2 rounded-xl bg-white/70 font-extrabold hover:bg-white"
                                type="button">ì·¨ì†Œ</button>
                            <button id="btnSave" class="btn-3d" type="button">ì €ì¥</button>
                        </div>
                    </div>

                    <div id="modalMsg" class="text-xs text-slate-600"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // âœ… header/footer
        fetch("/components/header.html").then(r => r.text()).then(d => document.getElementById("header-placeholder").innerHTML = d);
        fetch("/components/footer.html").then(r => r.text()).then(d => document.getElementById("footer-placeholder").innerHTML = d);

        function toggleSub(btn) {
            const ul = btn.nextElementSibling;
            if (!ul) return;
            ul.classList.toggle("hidden");
        }

        function goBack() {
            if (document.referrer && document.referrer !== location.href) window.history.back();
            else window.location.href = "/category.html";
        }
        function goNext() { window.history.forward(); }

        // =========================
        // âœ… ì•ˆì „ JSON fetch
        // =========================
        async function safeJsonFetch(url, options) {
            try {
                const r = await fetch(url, options);
                const text = await r.text();
                let json = null;
                try { json = text ? JSON.parse(text) : null; } catch (e) { }
                if (r.ok) return json ?? { ok: true };
                return json ?? { ok: false, status: r.status, message: text || "HTTP error" };
            } catch (e) {
                return { ok: false, message: e?.message || "network error" };
            }
        }

        const API_BASE = "/ncategory2manager/ad";
        const PAGE = "ncategory2";
        const PRIORITY = 1;
        const NO_IMAGE = "/uploads/no-image.png";

        const esc = (s) => String(s ?? "").replace(/[&<>"']/g, m => ({
            '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;'
        }[m]));

        function setMsg(t) { document.getElementById("modalMsg").textContent = t || ""; }

        async function apiGetSlot(position) {
            const url = `${API_BASE}/slot?page=${encodeURIComponent(PAGE)}&position=${encodeURIComponent(position)}&priority=${encodeURIComponent(PRIORITY)}`;
            const data = await safeJsonFetch(url);
            return { slot: data?.slot ?? null, raw: data };
        }

        async function apiSaveSlot(formData) {
            return await safeJsonFetch(`${API_BASE}/slot`, { method: "POST", body: formData });
        }

        async function apiDeleteSlot(position) {
            const url = `${API_BASE}/slot?page=${encodeURIComponent(PAGE)}&position=${encodeURIComponent(position)}&priority=${encodeURIComponent(PRIORITY)}`;
            return await safeJsonFetch(url, { method: "DELETE" });
        }

        async function apiSearchStore(q, bizNo) {
            const url = `${API_BASE}/store/search?q=${encodeURIComponent(q || "")}&bizNo=${encodeURIComponent(bizNo || "")}`;
            return await safeJsonFetch(url);
        }

        function buildStoreLink(store_type, id) {
            if (store_type === "combined" || store_type === "combined_store_info") return `/ndetail.html?id=${id}&type=combined`;
            if (store_type === "store_info") return `/ndetail.html?id=${id}&type=store_info`;
            if (store_type === "food" || store_type === "food_stores") return `/ndetail.html?id=${id}&type=food`;
            return "#";
        }

        const pickImg = (slot) => slot?.image_url || slot?.image || slot?.img_url || NO_IMAGE;
        const pickText = (slot) => slot?.text_content || "";
        const pickLink = (slot) => slot?.link_url || "";
        const pickName = (slot) => slot?.business_name || slot?.text_content || slot?.name || "ë¹„ì–´ìˆìŒ";
        const pickCategory = (slot) => slot?.category || slot?.business_category || slot?.store_category || "";

        // =========================
        // âœ… ë¬¸ì„œ ì „ì²´ í´ë¦­ ì´ë²¤íŠ¸ë¥¼ â€œí•œ ë°©ì‹â€ìœ¼ë¡œ í†µì¼
        // data-position ê°€ì§„ ë²„íŠ¼ì´ë©´ ë¬´ì¡°ê±´ ëª¨ë‹¬
        // =========================
        document.addEventListener("click", (e) => {
            const btn = e.target.closest("button[data-position]");
            if (!btn) return;
            // ëª¨ë‹¬ ë‚´ë¶€ í´ë¦­ì€ ì œì™¸(ì¤‘ì²© ë°©ì§€)
            if (btn.closest("#modal")) return;
            openModal(btn.dataset.position, btn.dataset.title || "ìŠ¬ë¡¯");
        });

        // =========================
        // BEST ë Œë”
        // =========================
        const BEST_DEFS = Array.from({ length: 6 }).map((_, i) => ({
            position: `ncategory2_best_${i + 1}`,
            title: `BEST ${i + 1}`,
        }));

        function bestCardHtml(def, slot) {
            const img = pickImg(slot);
            const name = pickName(slot);
            const cat = pickCategory(slot);
            const text = pickText(slot);

            return `
        <button class="neo-card p-4 text-left" data-position="${esc(def.position)}" data-title="${esc(def.title)}" type="button">
          <div class="aspect-[4/3] overflow-hidden rounded-2xl bg-white">
            <img src="${esc(img)}" class="w-full h-full object-cover" alt="">
          </div>
          <div class="mt-3">
            <div class="font-extrabold text-lg leading-tight">${esc(name)}</div>
            <div class="text-sm text-slate-600 mt-1">(${esc(cat || "ì—…ì¢… ë¯¸ì„¤ì •")})</div>
            <div class="text-xs text-slate-600 mt-2 clamp-2">${esc(text || "")}</div>
          </div>
        </button>
      `;
        }

        async function renderBest() {
            const root = document.getElementById("bestGrid");
            if (!root) return;

            root.innerHTML = BEST_DEFS.map(def => bestCardHtml(def, null)).join("");

            const rows = await Promise.all(BEST_DEFS.map(async (def) => {
                const { slot } = await apiGetSlot(def.position);
                return { def, slot };
            }));

            root.innerHTML = rows.map(({ def, slot }) => bestCardHtml(def, slot)).join("");
        }



        // =========================
        // POWER ìŠ¬ë¼ì´ë”
        // =========================
        const POWER_DEFS = Array.from({ length: 9 }).map((_, i) => ({
            position: `ncategory2_power_${i + 1}`,
            title: `íŒŒì›Œ ê´‘ê³  ${i + 1}`,
        }));

        function powerCardHtml(def, slot) {
            const img = pickImg(slot);
            const name = pickName(slot);
            const cat = pickCategory(slot);
            return `
        <button class="neo-card p-3 text-left w-full" data-position="${esc(def.position)}" data-title="${esc(def.title)}" type="button">
          <div class="flex gap-3 items-center">
            <div class="w-20 h-16 rounded-xl overflow-hidden bg-white shrink-0">
              <img src="${esc(img)}" class="w-full h-full object-cover" alt="">
            </div>
            <div class="min-w-0 flex-1">
              <div class="font-extrabold truncate">${esc(name)}</div>
              <div class="text-xs text-slate-600 truncate">(${esc(cat || "ì—…ì¢…")})</div>
            </div>
          </div>
        </button>
      `;
        }

        function setPowerTransform() {
            const track = document.getElementById("powerAdTrack");
            const viewport = document.getElementById("powerViewport");
            if (!track || !viewport) return;
            const w = viewport.clientWidth;
            track.style.transform = `translateX(${-powerIndex * w}px)`;
        }

        async function renderPower() {
            const track = document.getElementById("powerAdTrack");
            const viewport = document.getElementById("powerViewport");
            if (!track || !viewport) return;

            track.innerHTML = "";
            const slides = [];

            const rows = await Promise.all(POWER_DEFS.map(async (def) => {
                const { slot } = await apiGetSlot(def.position);
                return { def, slot };
            }));

            for (let i = 0; i < rows.length; i += POWER_PER_VIEW) {
                const slice = rows.slice(i, i + POWER_PER_VIEW);
                slides.push(slice);
            }

            slides.forEach((group) => {
                const slide = document.createElement("div");
                slide.className = "w-full shrink-0 px-1";
                slide.innerHTML = `<div class="grid grid-cols-1 sm:grid-cols-3 gap-4 px-2">
          ${group.map(({ def, slot }) => powerCardHtml(def, slot)).join("")}
        </div>`;
                track.appendChild(slide);
            });

            powerIndex = 0;
            requestAnimationFrame(() => {
                track.style.width = (viewport.clientWidth * slides.length) + "px";
                setPowerTransform();
            });
        }

        function powerNext() {
            const viewport = document.getElementById("powerViewport");
            const track = document.getElementById("powerAdTrack");
            if (!viewport || !track) return;
            const slideCount = track.children.length || 1;
            powerIndex = (powerIndex + 1) % slideCount;
            setPowerTransform();
        }
        function powerPrev() {
            const viewport = document.getElementById("powerViewport");
            const track = document.getElementById("powerAdTrack");
            if (!viewport || !track) return;
            const slideCount = track.children.length || 1;
            powerIndex = (powerIndex - 1 + slideCount) % slideCount;
            setPowerTransform();
        }

        document.getElementById("prevBtn").addEventListener("click", powerPrev);
        document.getElementById("nextBtn").addEventListener("click", powerNext);
        window.addEventListener("resize", setPowerTransform);

        // =========================
        // âœ… ê°•ë ¥ì¶”ì²œ(íŒŒì›Œ ê´‘ê³ ) ë Œë”
        // =========================
        const powerTrack = document.getElementById("powerAdTrack");
        const powerViewport = document.getElementById("powerViewport");
        const prevBtn = document.getElementById("prevBtn");
        const nextBtn = document.getElementById("nextBtn");

        let powerIndex = 0;
        let powerPerView = 3;   // í™”ë©´ì— ë³´ì´ëŠ” ê°œìˆ˜
        let powerStep = 2;      // í•œ ë²ˆì— ì´ë™í•˜ëŠ” ê°œìˆ˜(ì›í•˜ë©´ ë°”ê¿”)
        let powerItemWidth = 0;
        let powerTotal = 9;

        function calcPowerPerView() {
            const w = window.innerWidth;
            if (w < 640) powerPerView = 1;
            else if (w < 1024) powerPerView = 2;
            else powerPerView = 3;

            powerStep = Math.min(2, powerPerView); // ê¸°ë³¸ì€ 2ê°œì”© ì´ë™
        }

        function applyPowerLayout() {
            if (!powerViewport) return;
            const viewportW = powerViewport.clientWidth;
            powerItemWidth = Math.floor(viewportW / powerPerView);

            [...powerTrack.children].forEach((el) => {
                el.style.flex = `0 0 ${powerItemWidth}px`;
            });

            // í˜„ì¬ ì¸ë±ìŠ¤ ìœ„ì¹˜ ë°˜ì˜
            powerIndex = Math.max(0, Math.min(powerIndex, Math.max(0, powerTotal - powerPerView)));
            powerTrack.style.transform = `translateX(${-powerIndex * powerItemWidth}px)`;
        }

        function powerCardHtml(def, slot) {
            const img = slot?.image_url || "/uploads/no-image.png";
            const text = slot?.text_content || "";
            const link = slot?.link_url || "";

            return `
    <button
      type="button"
      class="neo-card p-3 text-left overflow-hidden"
      data-position="${esc(def.position)}"
      data-title="${esc(def.title)}"
    >
      <div class="font-extrabold text-sm mb-2">${esc(def.title)}</div>

      <div class="neo-card p-0 overflow-hidden rounded-2xl">
        <img src="${esc(img)}" class="w-full h-28 object-cover bg-white" alt="">
      </div>

      <div class="mt-2 text-sm font-bold text-slate-800 clamp-2">${esc(text)}</div>
      <div class="mt-1 text-[11px] text-slate-500 break-all clamp-2">${esc(link)}</div>

      <div class="mt-2 inline-flex items-center gap-2">
        <span class="px-2 py-1 rounded-lg bg-purple-600 text-white text-xs font-bold">í¸ì§‘</span>
        <span class="text-xs text-slate-500">${esc(def.position)}</span>
      </div>
    </button>
  `;
        }

        async function renderPowerAds() {
            if (!powerTrack) return;

            calcPowerPerView();

            powerTrack.innerHTML = "";

            // íŒŒì›Œ ìŠ¬ë¡¯ 9ê°œ APIë¡œ ë¶ˆëŸ¬ì™€ ì¹´ë“œ ìƒì„±
            for (const def of SLOT_DEFS.power) {
                const data = await apiGetSlot(def.position);
                const slot = data?.slot || null;
                powerTrack.insertAdjacentHTML("beforeend", powerCardHtml(def, slot));
            }

            // âœ… í´ë¦­ â†’ ëª¨ë‹¬ ì—´ê¸° ë°”ì¸ë”©
            powerTrack.querySelectorAll("[data-position]").forEach((btn) => {
                btn.addEventListener("click", async () => {
                    await openModal(btn.dataset.position, btn.dataset.title);
                });
            });

            // ë ˆì´ì•„ì›ƒ ì ìš©
            powerTotal = SLOT_DEFS.power.length;
            powerIndex = 0;
            applyPowerLayout();
        }

        // ì¢Œìš° ë²„íŠ¼
        if (prevBtn) {
            prevBtn.addEventListener("click", () => {
                powerIndex -= powerStep;
                if (powerIndex < 0) powerIndex = Math.max(0, powerTotal - powerPerView); // ëìœ¼ë¡œ
                powerTrack.style.transform = `translateX(${-powerIndex * powerItemWidth}px)`;
            });
        }

        if (nextBtn) {
            nextBtn.addEventListener("click", () => {
                powerIndex += powerStep;
                if (powerIndex > powerTotal - powerPerView) powerIndex = 0; // ì²˜ìŒìœ¼ë¡œ
                powerTrack.style.transform = `translateX(${-powerIndex * powerItemWidth}px)`;
            });
        }

        // ë¦¬ì‚¬ì´ì¦ˆ ëŒ€ì‘
        window.addEventListener("resize", () => {
            calcPowerPerView();
            applyPowerLayout();
        });

        // =========================
        // âœ… í”„ë¦¬ë¯¸ì—„/ì‚¬ì´ë“œ/MVP/í•˜ë‹¨ ìŠ¬ë¡¯ ë°ì´í„° ë°˜ì˜(ì¼ê´€ì„±)
        // =========================
        async function renderStaticSlots() {
            const list = [
                { id: "slot_ncategory2_premium", position: "ncategory2_premium" },
                { id: "slot_ncategory2_sidebar_ad_1", position: "ncategory2_sidebar_ad_1" },
                { id: "slot_ncategory2_sidebar_ad_2", position: "ncategory2_sidebar_ad_2" },
                { id: "slot_ncategory2_mvp", position: "ncategory2_mvp" },
                { id: "slot_ncategory2_highlight", position: "ncategory2_highlight" },
                { id: "slot_ncategory2_bottom_1", position: "ncategory2_bottom_1" },
                { id: "slot_ncategory2_bottom_2", position: "ncategory2_bottom_2" },
            ];

            for (const def of list) {
                const el = document.getElementById(def.id);
                if (!el) continue;

                const { slot } = await apiGetSlot(def.position);

                // ê³µí†µ: img/text/link
                const imgEl = el.querySelector('[data-role="img"]');
                const textEl = el.querySelector('[data-role="text"]');
                const linkEl = el.querySelector('[data-role="link"]');

                if (imgEl) imgEl.src = pickImg(slot);
                if (textEl) textEl.textContent = pickText(slot) || (def.position === "ncategory2_premium" ? "í´ë¦­í•´ì„œ ë°°ë„ˆ í…ìŠ¤íŠ¸/ë§í¬/ì´ë¯¸ì§€ í¸ì§‘" : "");
                if (linkEl) linkEl.textContent = pickLink(slot) || "";

                // MVP/HIGHLIGHT ì „ìš© í‘œì‹œ
                if (def.position === "ncategory2_mvp" || def.position === "ncategory2_highlight") {
                    const nameEl = el.querySelector('[data-role="name"]');
                    const catEl = el.querySelector('[data-role="cat"]');
                    if (nameEl) nameEl.textContent = pickName(slot);
                    if (catEl) catEl.textContent = `ì—…ì¢…: ${pickCategory(slot) || ""}`;
                }
            }
        }

        // =========================
        // ëª¨ë‹¬
        // =========================
        const modal = document.getElementById("modal");
        const overlay = document.getElementById("modalOverlay");
        const modalTitle = document.getElementById("modalTitle");

        const previewImg = document.getElementById("previewImg");
        const previewUrl = document.getElementById("previewUrl");
        const previewText = document.getElementById("previewText");
        const previewLink = document.getElementById("previewLink");
        const previewMeta = document.getElementById("previewMeta");

        const f_position = document.getElementById("f_position");
        const f_text = document.getElementById("f_text");
        const f_link = document.getElementById("f_link");
        const f_image = document.getElementById("f_image");
        const f_start = document.getElementById("f_start");
        const f_end = document.getElementById("f_end");
        const f_noend = document.getElementById("f_noend");

        let currentPosition = "";

        function showModal() { modal.classList.remove("hidden"); }
        function hideModal() { modal.classList.add("hidden"); setMsg(""); }

        function syncPreview() {
            previewText.textContent = f_text.value || "";
            previewLink.textContent = f_link.value || "";
        }

        async function openModal(position, title) {
            currentPosition = position;
            modalTitle.textContent = `ìŠ¬ë¡¯ í¸ì§‘ - ${title}`;
            f_position.value = position;
            f_image.value = "";
            setMsg("ë¡œë”©...");

            const { slot } = await apiGetSlot(position);

            const img = pickImg(slot);
            previewImg.src = img || NO_IMAGE;
            previewUrl.textContent = img || "";

            f_text.value = pickText(slot) || "";
            f_link.value = pickLink(slot) || "";
            f_start.value = (slot?.start_at || "").slice(0, 10);
            f_end.value = (slot?.end_at || "").slice(0, 10);
            f_noend.checked = !!slot?.no_end;

            previewMeta.textContent = `${position} / priority:${PRIORITY}`;
            document.getElementById("searchResults").innerHTML = "";
            syncPreview();
            setMsg("");

            showModal();
        }

        document.getElementById("modalClose").addEventListener("click", hideModal);
        document.getElementById("btnCancel").addEventListener("click", hideModal);
        overlay.addEventListener("click", hideModal);
        document.addEventListener("keydown", (e) => { if (e.key === "Escape") hideModal(); });

        f_text.addEventListener("input", syncPreview);
        f_link.addEventListener("input", syncPreview);

        document.getElementById("btnSave").addEventListener("click", async () => {
            setMsg("ì €ì¥ ì¤‘...");

            const fd = new FormData();
            fd.append("page", PAGE);
            fd.append("position", currentPosition);
            fd.append("priority", String(PRIORITY));
            fd.append("text_content", f_text.value || "");
            fd.append("link_url", f_link.value || "");
            fd.append("start_at", f_start.value || "");
            fd.append("end_at", f_end.value || "");
            fd.append("no_end", f_noend.checked ? "true" : "false");

            if (f_image.files && f_image.files[0]) fd.append("slotImage", f_image.files[0]);

            const res = await apiSaveSlot(fd);
            if (!(res?.ok || res?.success === true)) {
                alert("ì €ì¥ ì‹¤íŒ¨: " + (res?.message || res?.error || "unknown"));
                setMsg("ì €ì¥ ì‹¤íŒ¨");
                return;
            }

            hideModal();
            await boot();
            await renderPowerAds();
        });

        document.getElementById("btnDelete").addEventListener("click", async () => {
            if (!confirm("ì´ ìŠ¬ë¡¯ì„ ì‚­ì œí• ê¹Œìš”? (ì´ë¯¸ì§€ íŒŒì¼ì€ ì‚­ì œí•˜ì§€ ì•ŠìŠµë‹ˆë‹¤)")) return;
            setMsg("ì‚­ì œ ì¤‘...");

            const res = await apiDeleteSlot(currentPosition);
            if (!(res?.ok || res?.success === true)) {
                alert("ì‚­ì œ ì‹¤íŒ¨: " + (res?.message || res?.error || "unknown"));
                setMsg("ì‚­ì œ ì‹¤íŒ¨");
                return;
            }

            hideModal();
            await boot();
            await renderPowerAds();
        });

        const s_q = document.getElementById("s_q");
        const s_biz = document.getElementById("s_biz");

        function bindEnterSearch(el) {
            el.addEventListener("keydown", (e) => {
                if (e.key === "Enter") {
                    e.preventDefault();
                    document.getElementById("btnSearch").click();
                }
            });
        }
        bindEnterSearch(s_q);
        bindEnterSearch(s_biz);

        document.getElementById("btnSearch").addEventListener("click", async () => {
            setMsg("ê²€ìƒ‰ ì¤‘...");

            const q = s_q.value || "";
            const biz = s_biz.value || "";
            const data = await apiSearchStore(q, biz);

            const root = document.getElementById("searchResults");
            root.innerHTML = "";

            const stores = data?.stores || [];
            if (stores.length === 0) {
                root.innerHTML = `<div class="text-sm text-slate-600">ê²€ìƒ‰ ê²°ê³¼ ì—†ìŒ</div>`;
                setMsg("");
                return;
            }

            stores.forEach(s => {
                const link = buildStoreLink(s.store_type, s.id);

                const card = document.createElement("div");
                card.className = "neo-card p-3";
                card.innerHTML = `
          <div class="font-extrabold">${esc(s.business_name || "")}</div>
          <div class="text-xs text-slate-600 mt-1">${esc(s.category || "")}</div>
          <div class="text-[11px] text-slate-500 mt-1">ì‚¬ì—…ì: ${esc(s.business_no || "")}</div>
          <div class="text-[11px] text-slate-500 mt-1 break-all">ë§í¬: ${esc(link)}</div>
          <button class="mt-2 px-3 py-1 rounded-xl bg-blue-600 text-white text-xs font-extrabold hover:bg-blue-700" type="button">ì„ íƒ</button>
        `;

                card.querySelector("button").addEventListener("click", () => {
                    f_text.value = s.business_name || "";
                    f_link.value = link;
                    syncPreview();
                });

                root.appendChild(card);
            });

            setMsg("");
        });

        // =========================
        // ì‹œì‘
        // =========================
        async function boot() {
            await renderStaticSlots();
            await renderBest();
            await renderPower();
            setPowerTransform();
        }

        boot();
        renderPowerAds();
    </script>
</body>

</html>