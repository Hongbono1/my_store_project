<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <title>MALL HANKOOK - 인덱스 관리자</title>
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .neo-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 1rem;
            box-shadow:
                6px 6px 12px rgba(0, 0, 0, 0.15),
                -6px -6px 12px rgba(255, 255, 255, 0.9);
            transition: all 0.2s ease;
        }

        .neo-card:hover {
            transform: translateY(-2px);
            box-shadow:
                10px 10px 20px rgba(0, 0, 0, 0.2),
                -6px -6px 12px rgba(255, 255, 255, 1);
        }

        .btn-3d {
            border-radius: 9999px;
            padding: 0.45rem 1rem;
            font-size: 0.8rem;
            font-weight: 600;
            background: linear-gradient(135deg, #2563eb, #4f46e5);
            color: white;
            box-shadow:
                0 4px 0 rgba(30, 64, 175, 1),
                0 0 0 1px rgba(255, 255, 255, 0.6) inset;
            transition: transform 0.1s ease, box-shadow 0.1s ease;
        }

        .btn-3d:active {
            transform: translateY(2px);
            box-shadow:
                0 1px 0 rgba(30, 64, 175, 1),
                0 0 0 1px rgba(255, 255, 255, 0.6) inset;
        }
    </style>
</head>

<body class="bg-slate-100 min-h-screen text-gray-800">

    <!-- 상단 바 -->
    <header class="bg-white shadow-sm sticky top-0 z-30">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 py-3 flex items-center justify-between gap-4">
            <div>
                <h1 class="text-lg sm:text-2xl font-bold">INDEX 메인 페이지 관리자</h1>
                <p class="text-xs sm:text-sm text-gray-500 mt-1">
                    인덱스(index.html)에 보이는 모든 슬롯(배너 / 텍스트 / Best Pick / 기능카드)을 여기서 관리합니다.
                </p>
            </div>
            <div class="flex flex-col items-end gap-1 text-right">
                <span class="text-[10px] uppercase tracking-wide text-gray-400">PAGE</span>
                <span class="text-xs font-mono bg-slate-100 px-2 py-1 rounded-full border border-slate-200">
                    page = "index"
                </span>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-1 lg:grid-cols-4 gap-6">

        <!-- 좌측 섹션 네비 -->
        <aside class="neo-card p-4 h-fit sticky top-20">
            <h2 class="text-sm font-semibold mb-3">섹션 이동</h2>
            <nav class="flex flex-col gap-1 text-sm">
                <a href="#sec-main" class="px-2 py-1 rounded hover:bg-slate-100">① 메인 배너 / 프로모</a>
                <a href="#sec-text" class="px-2 py-1 rounded hover:bg-slate-100">② 텍스트 박스 4개</a>
                <a href="#sec-oneword" class="px-2 py-1 rounded hover:bg-slate-100">③ 우리동네 한마디</a>
                <a href="#sec-bestpick" class="px-2 py-1 rounded hover:bg-slate-100">④ Best Pick (1~18)</a>
                <a href="#sec-entry" class="px-2 py-1 rounded hover:bg-slate-100">⑤ 기능 진입 카드</a>
                <a href="#sec-shopping" class="px-2 py-1 rounded hover:bg-slate-100">⑥ 쇼핑몰 영역</a>
                <a href="#sec-support" class="px-2 py-1 rounded hover:bg-slate-100">⑦ 고객 지원 영역</a>
            </nav>
        </aside>

        <!-- 우측 실제 슬롯 카드들 -->
        <section class="lg:col-span-3 space-y-8 pb-16">

            <!-- ① 메인 배너 / 프로모 -->
            <section id="sec-main" class="space-y-3">
                <h2 class="text-base sm:text-lg font-bold flex items-center gap-2">
                    ① 메인 배너 / 프로모
                    <span class="text-[10px] text-gray-400 font-mono">image + link</span>
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <!-- 상단 띠배너 -->
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_main_top" data-label="상단 띠배너" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">상단 띠배너</h3>
                            <p class="text-xs text-gray-500">페이지 맨 위에 노출되는 띠 배너입니다.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_main_top</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <!-- 메인 비주얼 -->
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_main_visual" data-label="메인 비주얼" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">메인 비주얼 배너</h3>
                            <p class="text-xs text-gray-500">가장 큰 메인 이미지 영역입니다.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_main_visual</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <!-- 프로모 1 -->
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_promo_1" data-label="프로모 1" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">프로모 1</h3>
                            <p class="text-xs text-gray-500">메인 우측 상단 작은 배너 1.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_promo_1</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <!-- 프로모 2 -->
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_promo_2" data-label="프로모 2" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">프로모 2</h3>
                            <p class="text-xs text-gray-500">메인 우측 상단 작은 배너 2.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_promo_2</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <!-- 프로모 3 -->
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_promo_3" data-label="프로모 3" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">프로모 3</h3>
                            <p class="text-xs text-gray-500">메인 우측 상단 작은 배너 3.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_promo_3</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>
                </div>
            </section>

            <!-- ② 텍스트 박스 4개 -->
            <section id="sec-text" class="space-y-3">
                <h2 class="text-base sm:text-lg font-bold flex items-center gap-2">
                    ② 텍스트 박스 (검색어 / 최신 소식 / 이벤트 정보 / 추천 제품)
                    <span class="text-[10px] text-gray-400 font-mono">text_content 전용</span>
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_sub_keywords" data-label="검색어" data-kind="text">
                        <div>
                            <h3 class="text-sm font-semibold">검색어</h3>
                            <p class="text-xs text-gray-500">한 줄당 한 개의 검색어로 사용됩니다.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_sub_keywords</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_sub_news" data-label="최신 소식" data-kind="text">
                        <div>
                            <h3 class="text-sm font-semibold">최신 소식</h3>
                            <p class="text-xs text-gray-500">공지/업데이트 등의 문구.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_sub_news</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_sub_events" data-label="이벤트 정보" data-kind="text">
                        <div>
                            <h3 class="text-sm font-semibold">이벤트 정보</h3>
                            <p class="text-xs text-gray-500">진행 중인 이벤트 목록.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_sub_events</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_sub_recommends" data-label="추천 제품" data-kind="text">
                        <div>
                            <h3 class="text-sm font-semibold">추천 제품</h3>
                            <p class="text-xs text-gray-500">추천 상품 리스트.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_sub_recommends</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>
                </div>
            </section>

            <!-- ③ 우리동네 한마디 (일단 UI만, 나중에 /manager/ad/text/set 연결) -->
            <section id="sec-oneword" class="space-y-3">
                <h2 class="text-base sm:text-lg font-bold flex items-center gap-2">
                    ③ 우리동네 한마디
                    <span class="text-[10px] text-gray-400 font-mono">position: index_oneword</span>
                </h2>
                <div class="neo-card p-4 flex items-center justify-between gap-3 cursor-pointer" id="onewordCard">
                    <div>
                        <h3 class="text-sm font-semibold">우리동네 한마디 내용 편집</h3>
                        <p class="text-xs text-gray-500">
                            인덱스 중간의 큰 한 줄 문구입니다. (현재 index.html은 /manager/ad/text/get 기준)
                        </p>
                        <p class="text-[10px] text-gray-400 mt-1">
                            <code>page = "index", position = "index_oneword"</code>
                        </p>
                    </div>
                    <button type="button" class="btn-3d text-xs" id="onewordEditBtn">수정</button>
                </div>
            </section>

            <!-- ④ Best Pick (1~18) -->
            <section id="sec-bestpick" class="space-y-3">
                <h2 class="text-base sm:text-lg font-bold flex items-center gap-2">
                    ④ Best Pick (1~18)
                    <span class="text-[10px] text-gray-400 font-mono">image + link + business_name</span>
                </h2>
                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3">
                    <!-- 1~18 카드 : JS로 만들어도 되지만, 명시적으로 적어둠 -->
                    <!-- 필요한 만큼 복붙해서 늘려도 됨 -->
                    <!-- 여기서는 1~6까지만 예시, 실제로는 18개까지 채우는 걸 추천 -->
                    <!-- best_pick_1 -->
                    <div class="neo-card p-3 flex flex-col gap-2 slot-card cursor-pointer" data-page="index"
                        data-position="best_pick_1" data-label="Best Pick 1" data-kind="banner">
                        <div class="flex items-center justify-between gap-2">
                            <span class="text-xs font-semibold">Best Pick 1</span>
                            <button type="button" class="btn-3d text-[10px]" data-role="edit">수정</button>
                        </div>
                        <p class="text-[10px] text-gray-500">
                            동그란 원형 카드 1번.
                        </p>
                    </div>

                    <div class="neo-card p-3 flex flex-col gap-2 slot-card cursor-pointer" data-page="index"
                        data-position="best_pick_2" data-label="Best Pick 2" data-kind="banner">
                        <div class="flex items-center justify-between gap-2">
                            <span class="text-xs font-semibold">Best Pick 2</span>
                            <button type="button" class="btn-3d text-[10px]" data-role="edit">수정</button>
                        </div>
                        <p class="text-[10px] text-gray-500">동그란 원형 카드 2번.</p>
                    </div>

                    <div class="neo-card p-3 flex flex-col gap-2 slot-card cursor-pointer" data-page="index"
                        data-position="best_pick_3" data-label="Best Pick 3" data-kind="banner">
                        <div class="flex items-center justify-between gap-2">
                            <span class="text-xs font-semibold">Best Pick 3</span>
                            <button type="button" class="btn-3d text-[10px]" data-role="edit">수정</button>
                        </div>
                        <p class="text-[10px] text-gray-500">동그란 원형 카드 3번.</p>
                    </div>

                    <!-- ... 같은 형식으로 best_pick_4 ~ best_pick_18 까지 추가 ... -->
                </div>
            </section>

            <!-- ⑤ 기능 진입 카드 -->
            <section id="sec-entry" class="space-y-3">
                <h2 class="text-base sm:text-lg font-bold flex items-center gap-2">
                    ⑤ 기능 진입 카드 (푸드 / 모든가게 / 핫플 / 추천 / 오픈 / 가게자랑 / 전통시장 / 공연/예술)
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_food_delivery" data-label="홍보의 배달" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">홍보의 배달</h3>
                            <p class="text-xs text-gray-500">foodcategory.html 링크가 기본값.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_food_delivery</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_all_stores" data-label="우리동네 모든가게" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">우리동네 모든가게</h3>
                            <p class="text-xs text-gray-500">ncategory2.html 링크가 기본값.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_all_stores</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_hot_place" data-label="가장 HOT한 우리동네" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">가장 HOT한 우리동네</h3>
                            <p class="text-xs text-gray-500">hot.html 기본, 이미지/링크 변경 가능.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_hot_place</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_suggest" data-label="홍보의 추천" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">홍보의 추천</h3>
                            <p class="text-xs text-gray-500">suggest.html 기본.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_suggest</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_open" data-label="오픈 예정" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">오픈 예정</h3>
                            <p class="text-xs text-gray-500">open.html 기본.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_open</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_store_pride" data-label="가게자랑" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">가게자랑</h3>
                            <p class="text-xs text-gray-500">storepride.html 기본.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_store_pride</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_traditional" data-label="전통시장" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">전통시장</h3>
                            <p class="text-xs text-gray-500">traditionalmarket.html 기본.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_traditional</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_performing" data-label="공연/예술, 축제" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">공연/예술, 축제</h3>
                            <p class="text-xs text-gray-500">performingart.html 기본.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_performing</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>
                </div>
            </section>

            <!-- ⑥ 쇼핑몰 -->
            <section id="sec-shopping" class="space-y-3">
                <h2 class="text-base sm:text-lg font-bold flex items-center gap-2">
                    ⑥ 쇼핑몰 영역 (가로 롱 박스 + 우측 버튼)
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_d2c_banner" data-label="쇼핑몰 배너" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">쇼핑몰 이미지 배너</h3>
                            <p class="text-xs text-gray-500">왼쪽 큰 쇼핑몰 이미지 영역.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_d2c_banner</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_d2c_shop" data-label="쇼핑몰 들어가기" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">쇼핑몰 들어가기 버튼 영역</h3>
                            <p class="text-xs text-gray-500">우측 버튼/문구 부분.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_d2c_shop</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>
                </div>
            </section>

            <!-- ⑦ 고객 지원 -->
            <section id="sec-support" class="space-y-3">
                <h2 class="text-base sm:text-lg font-bold flex items-center gap-2">
                    ⑦ 고객 지원 영역 (리뷰 / 중앙 박스 / 문의게시판)
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_support_review" data-label="리뷰/후기" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">리뷰/후기</h3>
                            <p class="text-xs text-gray-500">review.html 기본.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_support_review</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_support_empty" data-label="중앙 박스" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">중앙 박스</h3>
                            <p class="text-xs text-gray-500">비워두거나, 임시 공지 등.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_support_empty</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>

                    <div class="neo-card p-4 flex items-center justify-between gap-3 slot-card cursor-pointer"
                        data-page="index" data-position="index_support_inquiry" data-label="문의게시판" data-kind="banner">
                        <div>
                            <h3 class="text-sm font-semibold">문의게시판 (Q&A)</h3>
                            <p class="text-xs text-gray-500">inquiryBoard.html 기본.</p>
                            <p class="text-[10px] text-gray-400 mt-1">position: index_support_inquiry</p>
                        </div>
                        <button type="button" class="btn-3d text-xs" data-role="edit">수정</button>
                    </div>
                </div>
            </section>

        </section>
    </main>

    <!-- 공통 슬롯 수정 모달 -->
    <div id="slotModal" class="fixed inset-0 bg-black/40 hidden items-center justify-center z-40">
        <div class="bg-white rounded-2xl max-w-2xl w-full mx-4 p-6 relative">
            <button type="button" id="slotModalClose"
                class="absolute top-3 right-3 text-gray-400 hover:text-gray-600 text-xl leading-none">
                ×
            </button>

            <h2 id="slotModalTitle" class="text-lg font-bold">슬롯 수정</h2>
            <p id="slotModalSubtitle" class="text-xs text-gray-500 mt-1 font-mono"></p>

            <form id="slotForm" class="mt-4 space-y-4">
                <!-- 숨김 필드 -->
                <input type="hidden" name="page" value="index" />
                <input type="hidden" name="position" />

                <!-- 이미지 영역 -->
                <div id="slotSectionImage" data-section="image" class="space-y-2">
                    <h3 class="text-sm font-semibold">이미지 배너</h3>
                    <div class="flex flex-col sm:flex-row gap-4 items-start">
                        <div class="flex-1 space-y-2">
                            <label class="block text-xs text-gray-600 mb-1">
                                새 이미지 업로드 (선택)
                            </label>
                            <input type="file" name="image" accept="image/*"
                                class="block w-full text-xs border border-gray-200 rounded-lg px-2 py-1" />
                            <p class="text-[10px] text-gray-400">
                                * 업로드하면 기존 이미지를 교체합니다. (최대 20MB 가정)
                            </p>
                        </div>
                        <div class="w-32 h-24 bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center">
                            <img id="slotImagePreview" src="" alt="현재 이미지" class="w-full h-full object-cover hidden" />
                            <span id="slotImageEmpty" class="text-[10px] text-gray-400 text-center px-2">
                                등록된 이미지 없음
                            </span>
                        </div>
                    </div>
                </div>

                <!-- 링크 URL -->
                <div id="slotSectionLink" data-section="link" class="space-y-1">
                    <h3 class="text-sm font-semibold">링크(URL)</h3>
                    <input type="text" name="link_url" placeholder="/ndetail.html?id=1&type=food 또는 https://…"
                        class="w-full text-xs border border-gray-200 rounded-lg px-2 py-1" />
                    <p class="text-[10px] text-gray-400">
                        * 비워두면 클릭 시 이동하지 않습니다.
                    </p>
                </div>

                <!-- 텍스트 내용 -->
                <div id="slotSectionText" data-section="text" class="space-y-1">
                    <h3 class="text-sm font-semibold">텍스트 내용 (text_content)</h3>
                    <textarea name="text_content" rows="6"
                        class="w-full text-xs border border-gray-200 rounded-lg px-2 py-2 leading-relaxed"
                        placeholder="여러 줄 입력 가능합니다.&#10;각 줄이 인덱스에서 한 줄씩 표시됩니다."></textarea>
                    <p class="text-[10px] text-gray-400">
                        * 검색어 / 최신 소식 / 이벤트 정보 / 추천 제품 등은 줄단위로 사용됩니다.
                    </p>
                </div>

                <!-- 노출 기간 / 우선순위 -->
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4" data-section="meta">
                    <div class="space-y-1">
                        <h3 class="text-sm font-semibold">노출 기간</h3>
                        <label class="block text-[10px] text-gray-500">
                            시작 일시 (start_at)
                        </label>
                        <input type="datetime-local" name="start_at"
                            class="w-full text-xs border border-gray-200 rounded-lg px-2 py-1" />
                        <label class="block text-[10px] text-gray-500 mt-2">
                            종료 일시 (end_at)
                        </label>
                        <input type="datetime-local" name="end_at"
                            class="w-full text-xs border border-gray-200 rounded-lg px-2 py-1" />
                        <label class="inline-flex items-center gap-1 mt-2 text-[11px] text-gray-600">
                            <input type="checkbox" name="no_end" value="true" class="w-3 h-3" />
                            종료일 없음 (상시 노출)
                        </label>
                    </div>
                    <div class="space-y-2">
                        <h3 class="text-sm font-semibold">기타 설정</h3>
                        <label class="block text-[10px] text-gray-500">
                            우선순위 (priority)
                        </label>
                        <input type="number" name="priority"
                            class="w-24 text-xs border border-gray-200 rounded-lg px-2 py-1" value="1" />
                        <p class="text-[10px] text-gray-400 mt-1">
                            * 숫자가 낮을수록 우선순위가 높다고 가정합니다. (서버 로직에 맞게 조정)
                        </p>
                    </div>
                </div>

                <!-- 버튼들 -->
                <div class="flex items-center justify-between pt-3 border-t border-gray-100 mt-2">
                    <button type="button" id="slotDeleteBtn" class="text-xs text-red-500 hover:text-red-600">
                        슬롯 비우기 (삭제)
                    </button>

                    <div class="flex items-center gap-2">
                        <button type="button" id="slotCancelBtn"
                            class="text-xs px-3 py-1 rounded-full border border-gray-200 text-gray-600">
                            취소
                        </button>
                        <button type="submit" class="btn-3d text-xs">
                            저장
                        </button>
                    </div>
                </div>
            </form>

            <p id="slotModalMessage" class="text-[11px] mt-2 text-right text-gray-400"></p>
        </div>
    </div>

    <script>
        // ------- 공통 헬퍼 -------

        function toAbs(u) {
            if (!u) return "";
            if (/^https?:\/\//i.test(u)) return u;
            return u.startsWith("/") ? u : "/" + u;
        }

        function toLocalInputValue(isoString) {
            if (!isoString) return "";
            const d = new Date(isoString);
            if (Number.isNaN(d.getTime())) return "";
            const pad = (n) => String(n).padStart(2, "0");
            return (
                d.getFullYear() +
                "-" +
                pad(d.getMonth() + 1) +
                "-" +
                pad(d.getDate()) +
                "T" +
                pad(d.getHours()) +
                ":" +
                pad(d.getMinutes())
            );
        }

        function fromLocalInputValue(local) {
            // 그대로 서버에 넘기고, 서버에서 timezone 처리한다고 가정
            return local || "";
        }

        // ------- 모달 제어 -------

        const slotModal = document.getElementById("slotModal");
        const slotModalTitle = document.getElementById("slotModalTitle");
        const slotModalSubtitle = document.getElementById("slotModalSubtitle");
        const slotForm = document.getElementById("slotForm");
        const slotModalMessage = document.getElementById("slotModalMessage");

        const secImage = document.getElementById("slotSectionImage");
        const secLink = document.getElementById("slotSectionLink");
        const secText = document.getElementById("slotSectionText");

        const imgPreview = document.getElementById("slotImagePreview");
        const imgEmpty = document.getElementById("slotImageEmpty");

        const slotDeleteBtn = document.getElementById("slotDeleteBtn");
        const slotCancelBtn = document.getElementById("slotCancelBtn");
        const slotModalClose = document.getElementById("slotModalClose");

        let currentKind = "banner";

        function openSlotModal(cardEl) {
            const page = cardEl.dataset.page || "index";
            const position = cardEl.dataset.position || "";
            const label = cardEl.dataset.label || position;
            currentKind = cardEl.dataset.kind || "banner";

            // 모달 타이틀/정보
            slotModalTitle.textContent = `슬롯 수정: ${label}`;
            slotModalSubtitle.textContent = `page = "${page}", position = "${position}"`;
            slotModalMessage.textContent = "";

            // 폼 초기화
            slotForm.reset();
            slotForm.elements.page.value = page;
            slotForm.elements.position.value = position;
            slotForm.elements.priority.value = 1;
            imgPreview.classList.add("hidden");
            imgPreview.src = "";
            imgEmpty.classList.remove("hidden");

            // kind에 따라 섹션 표시/숨김
            if (currentKind === "text") {
                secImage.classList.add("hidden");
                secLink.classList.add("hidden");
                secText.classList.remove("hidden");
            } else if (currentKind === "banner") {
                secImage.classList.remove("hidden");
                secLink.classList.remove("hidden");
                secText.classList.add("hidden");
            } else {
                // both
                secImage.classList.remove("hidden");
                secLink.classList.remove("hidden");
                secText.classList.remove("hidden");
            }

            // 슬롯 데이터 로드
            loadSlotDetail(page, position);

            slotModal.classList.remove("hidden");
            slotModal.classList.add("flex");
        }

        function closeSlotModal() {
            slotModal.classList.add("hidden");
            slotModal.classList.remove("flex");
        }

        slotModalClose.addEventListener("click", closeSlotModal);
        slotCancelBtn.addEventListener("click", closeSlotModal);
        slotModal.addEventListener("click", (e) => {
            if (e.target === slotModal) closeSlotModal();
        });

        // ------- 슬롯 조회/저장/삭제 -------

        async function loadSlotDetail(page, position) {
            try {
                const url = `/manager/ad/slot?page=${encodeURIComponent(
                    page
                )}&position=${encodeURIComponent(position)}`;
                const res = await fetch(url, { cache: "no-store" });
                if (!res.ok) {
                    slotModalMessage.textContent = `슬롯 조회 실패 (status: ${res.status})`;
                    return;
                }
                const json = await res.json().catch(() => ({}));
                const slot = json.slot || json.data || null;
                if (!slot) {
                    slotModalMessage.textContent = "등록된 슬롯 데이터가 없습니다.";
                    return;
                }

                // 이미지
                const rawImg =
                    slot.image_url ||
                    slot.imageUrl ||
                    slot.image_path ||
                    slot.image ||
                    "";
                if (rawImg) {
                    imgPreview.src = toAbs(rawImg);
                    imgPreview.classList.remove("hidden");
                    imgEmpty.classList.add("hidden");
                } else {
                    imgPreview.src = "";
                    imgPreview.classList.add("hidden");
                    imgEmpty.classList.remove("hidden");
                }

                // 링크
                if (slotForm.elements.link_url) {
                    slotForm.elements.link_url.value = slot.link_url || slot.linkUrl || "";
                }

                // 텍스트
                if (slotForm.elements.text_content) {
                    slotForm.elements.text_content.value = slot.text_content || "";
                }

                // 날짜 / no_end / priority
                if (slotForm.elements.start_at) {
                    slotForm.elements.start_at.value = toLocalInputValue(slot.start_at);
                }
                if (slotForm.elements.end_at) {
                    slotForm.elements.end_at.value = toLocalInputValue(slot.end_at);
                }
                if (slotForm.elements.no_end) {
                    const bool =
                        String(slot.no_end || "")
                            .toLowerCase()
                            .trim() === "true" || slot.no_end === true;
                    slotForm.elements.no_end.checked = bool;
                }
                if (slotForm.elements.priority && slot.priority != null) {
                    slotForm.elements.priority.value = slot.priority;
                }

                slotModalMessage.textContent = "기존 슬롯 데이터를 불러왔습니다.";
            } catch (e) {
                console.error("슬롯 조회 오류:", e);
                slotModalMessage.textContent = "슬롯 조회 중 오류가 발생했습니다.";
            }
        }

        slotForm.addEventListener("submit", async (e) => {
            e.preventDefault();
            slotModalMessage.textContent = "";

            const formData = new FormData(slotForm);

            // datetime-local 값 직접 정리
            if (slotForm.elements.start_at) {
                formData.set(
                    "start_at",
                    fromLocalInputValue(slotForm.elements.start_at.value)
                );
            }
            if (slotForm.elements.end_at) {
                formData.set(
                    "end_at",
                    fromLocalInputValue(slotForm.elements.end_at.value)
                );
            }
            if (slotForm.elements.no_end) {
                formData.set("no_end", slotForm.elements.no_end.checked ? "true" : "false");
            }

            try {
                const res = await fetch("/manager/ad/slot", {
                    method: "POST",
                    body: formData,
                });
                if (!res.ok) {
                    slotModalMessage.textContent = `저장 실패 (status: ${res.status})`;
                    return;
                }
                const json = await res.json().catch(() => ({}));
                if (json.success || json.ok) {
                    slotModalMessage.textContent = "저장되었습니다. 인덱스 페이지를 새로고침하면 반영됩니다.";
                } else {
                    slotModalMessage.textContent =
                        "응답은 왔지만 success 플래그가 없습니다. 서버 로그를 확인해주세요.";
                }
            } catch (err) {
                console.error("슬롯 저장 오류:", err);
                slotModalMessage.textContent = "슬롯 저장 중 오류가 발생했습니다.";
            }
        });

        slotDeleteBtn.addEventListener("click", async () => {
            const page = slotForm.elements.page.value;
            const position = slotForm.elements.position.value;
            if (!page || !position) return;

            if (!confirm("이 슬롯 데이터를 삭제하시겠습니까?")) return;

            try {
                const url = `/manager/ad/slot?page=${encodeURIComponent(
                    page
                )}&position=${encodeURIComponent(position)}`;
                const res = await fetch(url, { method: "DELETE" });
                if (!res.ok) {
                    slotModalMessage.textContent = `삭제 실패 (status: ${res.status})`;
                    return;
                }
                const json = await res.json().catch(() => ({}));
                if (json.success || json.ok) {
                    slotModalMessage.textContent = "슬롯이 비워졌습니다.";
                    // 미리보기 초기화
                    imgPreview.src = "";
                    imgPreview.classList.add("hidden");
                    imgEmpty.classList.remove("hidden");
                    if (slotForm.elements.text_content) {
                        slotForm.elements.text_content.value = "";
                    }
                    if (slotForm.elements.link_url) {
                        slotForm.elements.link_url.value = "";
                    }
                } else {
                    slotModalMessage.textContent =
                        "응답은 왔지만 success 플래그가 없습니다. 서버 로그를 확인해주세요.";
                }
            } catch (err) {
                console.error("슬롯 삭제 오류:", err);
                slotModalMessage.textContent = "슬롯 삭제 중 오류가 발생했습니다.";
            }
        });

        // ------- 카드 클릭 연결 -------

        document.querySelectorAll(".slot-card").forEach((card) => {
            card.addEventListener("click", (e) => {
                // 카드 안의 버튼을 눌러도 동일 동작
                openSlotModal(card);
            });
            const btn = card.querySelector('[data-role="edit"]');
            if (btn) {
                btn.addEventListener("click", (e) => {
                    e.stopPropagation();
                    openSlotModal(card);
                });
            }
        });

        // ------- 우리동네 한마디 (UI만, 나중에 /manager/ad/text set 연결) -------

        const onewordEditBtn = document.getElementById("onewordEditBtn");
        const onewordCard = document.getElementById("onewordCard");

        onewordEditBtn.addEventListener("click", () => {
            alert(
                "우리동네 한마디(index_oneword)는 현재 index.html에서 /manager/ad/text/get API를 사용하고 있습니다.\n" +
                "이 관리 페이지에서 수정 기능을 붙이려면, 서버에 /manager/ad/text/set 같은 저장 API를 하나 더 만드는 방향으로 다음 단계에서 맞춰봅시다."
            );
        });
        onewordCard.addEventListener("click", () => {
            onewordEditBtn.click();
        });
    </script>
</body>

</html>