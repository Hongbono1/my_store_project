<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MALL HANKOOK | 카테고리 레이아웃 관리자</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Noto Sans KR', system-ui, -apple-system, BlinkMacSystemFont,
        'Segoe UI', sans-serif;
    }

    .neo-card {
      background: rgba(255, 255, 255, 0.8);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border-radius: 1rem;
      box-shadow:
        6px 6px 16px rgba(0, 0, 0, 0.12),
        -6px -6px 16px rgba(255, 255, 255, 0.95);
      transition: all 0.25s ease;
    }

    .neo-card:hover {
      transform: translateY(-3px);
      box-shadow:
        10px 10px 22px rgba(0, 0, 0, 0.2),
        -8px -8px 18px rgba(255, 255, 255, 1);
    }

    .slot-card {
      transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease,
        background-color .2s ease;
    }

    .slot-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 12px 22px rgba(15, 23, 42, 0.16);
      border-color: rgba(59, 130, 246, 0.8);
      background-color: rgba(239, 246, 255, 0.85);
    }

    .layout-bg {
      background:
        radial-gradient(circle at top left, #dbeafe 0, transparent 55%),
        radial-gradient(circle at bottom right, #fef3c7 0, transparent 55%);
    }

    .badge-ad {
      background: rgba(59, 130, 246, 0.12);
      color: #1d4ed8;
    }

    .badge-img {
      background: rgba(34, 197, 94, 0.12);
      color: #15803d;
    }

    .badge-info {
      background: rgba(148, 163, 184, 0.16);
      color: #475569;
    }

    .modal-bg {
      backdrop-filter: blur(6px);
    }

    .tab-btn.active {
      border-bottom: 2px solid #3b82f6;
      color: #2563eb;
    }

    .tab-btn {
      border-bottom: 2px solid transparent;
      transition: all 0.2s ease;
    }
  </style>
</head>

<body class="bg-slate-50 text-slate-900">

  <!-- 전체 레이아웃 -->
  <div class="flex min-h-screen">

    <!-- 🔵 왼쪽 사이드바 -->
    <aside class="w-64 bg-white/85 backdrop-blur-xl border-r border-slate-200 px-5 py-6 flex flex-col gap-6">
      <div>
        <h1
          class="text-2xl font-extrabold bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 bg-clip-text text-transparent">
          MALL HANKOOK
        </h1>
        <p class="mt-1 text-xs text-slate-500">카테고리(category.html) 레이아웃 관리</p>
      </div>

      <div class="space-y-2 text-sm">
        <p class="text-[11px] font-semibold text-slate-500 uppercase tracking-wide mb-1">
          관리 대상
        </p>
        <div class="border border-slate-200 rounded-lg px-3 py-2 bg-slate-50 text-xs leading-relaxed">
          <p class="font-semibold text-slate-700">FOOD 카테고리 페이지</p>
          <p class="text-slate-500 mt-1">
            왼쪽 FOOD CATEGORY 메뉴는 고정.<br>
            오른쪽 <span class="font-semibold">광고 / MVP / HIGHLIGHT / 최고의 가게 / 파워 광고</span> 영역을
            이미지 + 링크/텍스트로 관리합니다.
          </p>
        </div>
      </div>

      <div class="space-y-2 text-xs text-slate-500">
        <p class="font-semibold text-[11px] uppercase tracking-wide">
          사용 방법
        </p>
        <ol class="list-decimal list-inside space-y-1">
          <li>오른쪽 레이아웃에서 <span class="font-semibold">파란 박스(슬롯)</span>를 클릭</li>
          <li>이미지/링크 or 텍스트를 입력 후 <span class="font-semibold">저장</span></li>
          <li>카테고리 페이지(category.html)에 반영</li>
        </ol>
      </div>

      <div class="mt-auto text-[11px] text-slate-400 leading-relaxed">
        이 페이지에서 설정되는 값은<br>
        <span class="font-semibold">admin_ad_slots (page = 'food_category')</span> 에 저장됩니다.
      </div>
    </aside>

    <!-- 🟣 오른쪽 메인 -->
    <main class="flex-1 p-6 md:p-8 space-y-6">

      <!-- 상단 타이틀 -->
      <header class="flex items-center justify-between gap-3">
        <div>
          <h2 class="text-2xl font-bold flex items-center gap-2">
            FOOD 카테고리 레이아웃
          </h2>
          <p class="text-sm text-slate-500 mt-1">
            실제 <span class="font-semibold">카테고리 페이지</span>의 구조를 단순화해서 보여주고,
            각 영역을 슬롯으로 관리합니다.
          </p>
        </div>
      </header>

      <!-- 🧩 카테고리 페이지 레이아웃 미리보기 -->
      <section class="neo-card layout-bg p-5 md:p-7 border border-slate-200/70 max-w-6xl mx-auto space-y-5">
        <div class="flex items-center justify-between mb-2">
          <h3 class="text-lg font-semibold">
            🍱 FOOD 카테고리 레이아웃 미리보기
          </h3>
          <div class="flex items-center gap-2 text-[11px]">
            <span
              class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 badge-img border border-emerald-200 text-[10px]">
              ● 이미지 배너 슬롯
            </span>
            <span
              class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 badge-ad border border-blue-200 text-[10px]">
              ● 광고/가게 슬롯
            </span>
            <span
              class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 badge-info border border-slate-200 text-[10px]">
              ● 텍스트 슬롯
            </span>
          </div>
        </div>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-4 text-xs md:text-sm">

          <!-- 🔹 왼쪽: FOOD CATEGORY + 광고박스 -->
          <div class="lg:col-span-4 space-y-3">
            <!-- FOOD CATEGORY 설명 -->
            <div class="border border-slate-200 rounded-xl bg-white/80 p-3">
              <p class="font-semibold mb-1">FOOD CATEGORY 메뉴</p>
              <p class="text-[11px] text-slate-500">
                한식 / 중식 / 양식 / 분식 / 치킨 / 카페 / 패스트푸드 / 기타 등
                왼쪽 카테고리 버튼 영역 (고정 구조 설명).
              </p>
            </div>

            <!-- 🔧 FOOD CATEGORY 관리 박스 -->
            <div class="border border-slate-200 rounded-xl bg-white/90 p-3">
              <p class="font-semibold mb-2 text-sm">FOOD CATEGORY 관리</p>

              <div class="flex gap-2 mb-2">
                <input id="newCategoryName" type="text"
                  class="flex-1 border border-slate-300 rounded-lg px-2 py-1 text-sm"
                  placeholder="예) 한식, 중식, 양식, 분식...">
                <button id="addCategoryBtn" type="button"
                  class="px-3 py-1 rounded-lg bg-blue-600 text-white text-xs hover:bg-blue-700">
                  추가
                </button>
              </div>

              <ul id="categoryList"
                class="space-y-1 text-xs text-slate-700 max-h-48 overflow-y-auto border border-slate-100 rounded-lg p-1">
                <!-- JS로 카테고리 목록이 채워집니다 -->
              </ul>
            </div>

            <!-- 사이드 광고 박스 슬롯 -->
            <div
              class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-xl p-3 bg-white/90 js-slot"
              data-page="food_category" data-position="category_sidebar_ad" data-label="좌측 사이드 광고 박스">
              <div class="flex items-center justify-between">
                <p class="font-semibold">사이드 광고 박스</p>
                <span class="badge-ad text-[10px] border border-blue-200 px-2 py-0.5 rounded-full">이미지/배너</span>
              </div>
              <p class="mt-1 text-[11px] text-slate-500">
                category.html 왼쪽 하단 광고 이미지 박스에 들어가는 이미지 + 링크.
              </p>
            </div>
          </div>

          <!-- 🔹 오른쪽: 상단 메인 + 설명 -->
          <div class="lg:col-span-8 space-y-3">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-3 items-stretch">

              <!-- 상단 메인 배너 -->
              <div class="md:col-span-2">
                <div
                  class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-xl p-3 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_main_banner" data-label="상단 메인 배너">
                  <div class="flex items-center justify-between">
                    <p class="font-semibold">상단 메인 배너</p>
                    <span class="badge-img text-[10px] border border-emerald-200 px-2 py-0.5 rounded-full">이미지 배너</span>
                  </div>
                  <p class="mt-1 text-[11px] text-slate-500">
                    "Premium 카테고리" 영역의 상단 배경/이미지 (필요 시 텍스트 위에 배경처럼 사용).
                  </p>
                </div>
              </div>

              <!-- 설명 문구 (텍스트 슬롯) -->
              <div>
                <div
                  class="slot-card cursor-pointer border border-dashed border-slate-300 rounded-xl p-3 bg-white/95 js-text-slot"
                  data-page="food_category" data-position="category_main_text" data-slot-type="text"
                  data-label="상단 설명 문구">
                  <div class="flex items-center justify-between">
                    <p class="font-semibold">카테고리 설명 문구</p>
                    <span class="badge-info text-[10px] border border-slate-200 px-2 py-0.5 rounded-full">텍스트 슬롯</span>
                  </div>
                  <p class="mt-1 text-[11px] text-slate-500">
                    "카테고리 설명 문구를 여기에 넣습니다." 자리에 들어갈 안내 문구를 설정합니다.
                  </p>
                </div>
              </div>
            </div>

            <!-- 파워 광고 영역 -->
            <div class="neo-card border border-slate-200 p-3 bg-white/90 space-y-2">
              <div class="flex items-center justify-between">
                <p class="font-semibold text-[13px]">파워 광고 슬라이더 (3장 × 3그룹)</p>
                <span class="badge-ad text-[10px] border border-blue-200 px-2 py-0.5 rounded-full">가게/광고 슬롯</span>
              </div>
              <p class="text-[11px] text-slate-500">
                category.html의 "파워 광고" 영역입니다. 각 카드에 이미지 + 링크를 등록합니다.
              </p>

              <div class="grid grid-cols-3 gap-2 text-[11px]">
                <!-- 1~9 슬롯 -->
                <!-- 1 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_1" data-label="파워 광고 1번 카드">
                  <p class="font-semibold">파워 광고 1</p>
                  <p class="text-slate-500 mt-1">첫 번째 그룹, 첫 번째 카드.</p>
                </div>
                <!-- 2 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_2" data-label="파워 광고 2번 카드">
                  <p class="font-semibold">파워 광고 2</p>
                  <p class="text-slate-500 mt-1">첫 번째 그룹, 두 번째 카드.</p>
                </div>
                <!-- 3 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_3" data-label="파워 광고 3번 카드">
                  <p class="font-semibold">파워 광고 3</p>
                  <p class="text-slate-500 mt-1">첫 번째 그룹, 세 번째 카드.</p>
                </div>
                <!-- 4 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_4" data-label="파워 광고 4번 카드">
                  <p class="font-semibold">파워 광고 4</p>
                  <p class="text-slate-500 mt-1">두 번째 그룹, 첫 번째 카드.</p>
                </div>
                <!-- 5 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_5" data-label="파워 광고 5번 카드">
                  <p class="font-semibold">파워 광고 5</p>
                  <p class="text-slate-500 mt-1">두 번째 그룹, 두 번째 카드.</p>
                </div>
                <!-- 6 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_6" data-label="파워 광고 6번 카드">
                  <p class="font-semibold">파워 광고 6</p>
                  <p class="text-slate-500 mt-1">두 번째 그룹, 세 번째 카드.</p>
                </div>
                <!-- 7 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_7" data-label="파워 광고 7번 카드">
                  <p class="font-semibold">파워 광고 7</p>
                  <p class="text-slate-500 mt-1">세 번째 그룹, 첫 번째 카드.</p>
                </div>
                <!-- 8 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_8" data-label="파워 광고 8번 카드">
                  <p class="font-semibold">파워 광고 8</p>
                  <p class="text-slate-500 mt-1">세 번째 그룹, 두 번째 카드.</p>
                </div>
                <!-- 9 -->
                <div
                  class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                  data-page="food_category" data-position="category_power_9" data-label="파워 광고 9번 카드">
                  <p class="font-semibold">파워 광고 9</p>
                  <p class="text-slate-500 mt-1">세 번째 그룹, 세 번째 카드.</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- 🔹 MVP / HIGHLIGHT / 최고의 가게 -->
        <div class="mt-4 grid grid-cols-1 lg:grid-cols-12 gap-4">
          <!-- MVP + HIGHLIGHT -->
          <div class="lg:col-span-4 space-y-3">
            <div
              class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-xl p-3 bg-white/95 js-slot"
              data-page="food_category" data-position="category_mvp" data-label="MVP 카드">
              <div class="flex items-center justify-between">
                <p class="font-semibold text-blue-600">MVP</p>
                <span class="badge-img text-[10px] border border-emerald-200 px-2 py-0.5 rounded-full">대표 가게</span>
              </div>
              <p class="mt-1 text-[11px] text-slate-500">
                왼쪽 상단 "MVP" 박스에 들어갈 대표 가게 이미지 + 링크를 설정합니다.
              </p>
            </div>

            <div
              class="slot-card cursor-pointer border border-dashed border-amber-300 rounded-xl p-3 bg-white/95 js-slot"
              data-page="food_category" data-position="category_highlight" data-label="HIGHLIGHT 카드">
              <div class="flex items-center justify-between">
                <p class="font-semibold text-yellow-600">HIGHLIGHT</p>
                <span class="badge-img text-[10px] border border-amber-200 px-2 py-0.5 rounded-full">하이라이트</span>
              </div>
              <p class="mt-1 text-[11px] text-slate-500">
                왼쪽 하단 "HIGHLIGHT" 박스에 들어갈 이미지 + 링크.
              </p>
            </div>
          </div>

          <!-- 최고의 가게 6개 -->
          <div class="lg:col-span-8 neo-card border border-slate-200 p-4 bg-white/92">
            <div class="flex items-center justify-between mb-2">
              <p class="font-semibold text-[13px]">최고의 가게 6개</p>
              <span class="badge-ad text-[10px] border border-blue-200 px-2 py-0.5 rounded-full">가게 카드 슬롯</span>
            </div>
            <p class="text-[11px] text-slate-500 mb-3">
              category.html 우측 "최고의 가게" 그리드에 노출되는 6개 카드입니다.
            </p>

            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 text-[11px]">
              <!-- 1~6 -->
              <div
                class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-lg p-2 bg-white/95 js-slot"
                data-page="food_category" data-position="category_best_1" data-label="최고의 가게 1번 카드">
                <p class="font-semibold">최고의 가게 1</p>
                <p class="text-slate-500 mt-1">첫 번째 카드.</p>
              </div>

              <div
                class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-lg p-2 bg-white/95 js-slot"
                data-page="food_category" data-position="category_best_2" data-label="최고의 가게 2번 카드">
                <p class="font-semibold">최고의 가게 2</p>
                <p class="text-slate-500 mt-1">두 번째 카드.</p>
              </div>

              <div
                class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-lg p-2 bg-white/95 js-slot"
                data-page="food_category" data-position="category_best_3" data-label="최고의 가게 3번 카드">
                <p class="font-semibold">최고의 가게 3</p>
                <p class="text-slate-500 mt-1">세 번째 카드.</p>
              </div>

              <div
                class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-lg p-2 bg-white/95 js-slot"
                data-page="food_category" data-position="category_best_4" data-label="최고의 가게 4번 카드">
                <p class="font-semibold">최고의 가게 4</p>
                <p class="text-slate-500 mt-1">네 번째 카드.</p>
              </div>

              <div
                class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-lg p-2 bg-white/95 js-slot"
                data-page="food_category" data-position="category_best_5" data-label="최고의 가게 5번 카드">
                <p class="font-semibold">최고의 가게 5</p>
                <p class="text-slate-500 mt-1">다섯 번째 카드.</p>
              </div>

              <div
                class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-lg p-2 bg-white/95 js-slot"
                data-page="food_category" data-position="category_best_6" data-label="최고의 가게 6번 카드">
                <p class="font-semibold">최고의 가게 6</p>
                <p class="text-slate-500 mt-1">여섯 번째 카드.</p>
              </div>
            </div>
          </div>
        </div>
      </section>

    </main>
  </div>

  <!-- ======================== -->
  <!-- 광고/이미지/텍스트 등록 모달 -->
  <!-- ======================== -->
  <div id="adModal" class="fixed inset-0 bg-black/40 modal-bg hidden justify-center items-center p-4 z-50">
    <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-7 max-w-lg w-full border border-slate-200">

      <h2 id="modalTitle" class="text-lg font-bold mb-4">
        슬롯 설정
      </h2>

      <!-- 탭 선택 -->
      <div class="flex border-b border-slate-200 mb-4">
        <button id="imageTab" class="tab-btn active px-4 py-2 text-sm font-medium border-b-2 border-blue-500 text-blue-600">
          이미지/배너
        </button>
        <button id="storeTab" class="tab-btn px-4 py-2 text-sm font-medium text-slate-500 hover:text-slate-700">
          가게 연결
        </button>
      </div>

      <!-- 이미지/배너 폼 -->
      <form id="adForm" class="space-y-4">
        <!-- 슬롯 설명 -->
        <div class="text-xs text-slate-600 bg-slate-50 border border-slate-100 rounded-lg p-3" id="slotInfo">
          선택된 슬롯 정보가 여기에 표시됩니다.
        </div>

        <!-- 이미지 업로드 -->
        <div>
          <label class="block font-semibold mb-1 text-sm">이미지 파일 (선택)</label>
          <input id="imageInput" type="file" class="w-full border border-slate-300 p-2 rounded-lg text-sm">
          <p class="text-[11px] text-slate-400 mt-1">
            가게/광고 이미지 또는 배너 이미지를 선택하세요. (이미지 없이 링크만 관리도 가능)
          </p>
        </div>

        <!-- 링크 입력 -->
        <div>
          <label class="block font-semibold mb-1 text-sm">클릭 시 이동 링크 (선택)</label>
          <input id="linkInput" type="text" placeholder="https://www.hongbono1.com/ndetail.html?id=1&type=food"
            class="w-full border border-slate-300 p-2 rounded-lg text-sm">
          <p class="text-[11px] text-slate-400 mt-1">
            비워두면 링크 없이 이미지/텍스트만 표시됩니다.
          </p>
        </div>

        <!-- 사업자번호 + 상호명 입력 (가게 연결용) -->
        <div class="border-t border-slate-200 pt-3 mt-3">
          <p class="text-sm font-semibold mb-2 text-slate-700">또는 등록된 가게 연결</p>
          
          <div class="grid grid-cols-2 gap-2">
            <div>
              <label class="block font-medium mb-1 text-xs">사업자번호</label>
              <input id="bizNumberInput" type="text" placeholder="123-45-67890"
                class="w-full border border-slate-300 p-2 rounded-lg text-xs">
            </div>
            <div>
              <label class="block font-medium mb-1 text-xs">상호명</label>
              <input id="bizNameInput" type="text" placeholder="맛있는 한식집"
                class="w-full border border-slate-300 p-2 rounded-lg text-xs">
            </div>
          </div>
          
          <p class="text-[10px] text-slate-400 mt-1">
            사업자번호와 상호명을 입력하면 등록된 가게 정보로 슬롯을 채웁니다.
          </p>
        </div>

        <div class="flex justify-end gap-3 pt-3">
          <button type="button" id="closeModal"
            class="px-4 py-2 border border-slate-300 rounded-lg text-sm text-slate-600 hover:bg-slate-50">
            취소
          </button>
          <button type="button" id="saveAdBtn"
            class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow text-sm hover:bg-blue-700">
            저장
          </button>
        </div>
      </form>

      <!-- 가게 연결 폼 -->
      <form id="storeForm" class="space-y-4 hidden">
        <div class="text-xs text-slate-600 bg-slate-50 border border-slate-100 rounded-lg p-3">
          등록된 가게를 사업자번호와 상호명으로 검색해서 이 슬롯에 연결합니다.
        </div>

        <!-- 사업자번호 입력 -->
        <div>
          <label class="block font-semibold mb-1 text-sm">사업자번호</label>
          <input id="businessNoInput" type="text" placeholder="123-45-67890"
            class="w-full border border-slate-300 p-2 rounded-lg text-sm">
          <p class="text-[11px] text-slate-400 mt-1">
            숫자와 하이픈(-) 포함해서 입력하세요.
          </p>
        </div>

        <!-- 상호명 입력 -->
        <div>
          <label class="block font-semibold mb-1 text-sm">상호명</label>
          <input id="businessNameInput" type="text" placeholder="맛있는 한식집"
            class="w-full border border-slate-300 p-2 rounded-lg text-sm">
          <p class="text-[11px] text-slate-400 mt-1">
            정확한 상호명을 입력해주세요. (대소문자 구분)
          </p>
        </div>

        <div class="flex justify-end gap-3 pt-3">
          <button type="button" id="closeStoreModal"
            class="px-4 py-2 border border-slate-300 rounded-lg text-sm text-slate-600 hover:bg-slate-50">
            취소
          </button>
          <button type="button" id="saveStoreBtn"
            class="px-4 py-2 bg-emerald-600 text-white rounded-lg shadow text-sm hover:bg-emerald-700">
            가게 연결
          </button>
        </div>
      </form>

      <input type="hidden" id="selectedPage">
      <input type="hidden" id="selectedPosition">
    </div>
  </div>

  <!-- ======================== -->
  <!-- 🟢 텍스트 입력 전용 모달 -->
  <!-- ======================== -->
  <div id="textModal" class="fixed inset-0 bg-black/40 modal-bg hidden justify-center items-center p-4 z-50">
    <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-7 max-w-lg w-full border border-slate-200">
      <h2 id="textModalTitle" class="text-lg font-bold mb-3">
        텍스트 설정
      </h2>

      <form id="textForm" class="space-y-3">
        <div class="text-xs text-slate-600 bg-slate-50 border border-slate-100 rounded-lg p-3" id="textSlotInfo">
          상단 설명 문구처럼 <span class="font-semibold">글만 들어가는 영역</span>을 설정합니다.
        </div>

        <div>
          <label class="block font-semibold mb-1 text-sm">표시할 텍스트</label>
          <textarea id="textContentInput" class="w-full border border-slate-300 rounded-lg p-2 text-sm min-h-[120px]"
            placeholder="예) 오늘은 '따끈한 국밥'이 생각나는 날이에요. 우리동네 인기 한식 가게를 만나보세요."></textarea>
        </div>

        <input type="hidden" id="textSelectedPage">
        <input type="hidden" id="textSelectedPosition">

        <div class="flex justify-end gap-3 pt-2">
          <button type="button" id="closeTextModal"
            class="px-4 py-2 border border-slate-300 rounded-lg text-sm text-slate-600 hover:bg-slate-50">
            취소
          </button>
          <button type="button" id="saveTextBtn"
            class="px-4 py-2 bg-emerald-600 text-white rounded-lg shadow text-sm hover:bg-emerald-700">
            저장
          </button>
        </div>
      </form>
    </div>
  </div>

  <script>
    // ============================
    // 슬롯 클릭 → 모달 열기
    // ============================
    function setupSlotClick() {
      document.addEventListener("click", (e) => {
        const slotEl = e.target.closest(".js-slot, .js-text-slot");
        if (!slotEl) return;

        const page = slotEl.dataset.page || "category_page";
        const position = slotEl.dataset.position || "";
        const label = slotEl.dataset.label || "선택된 슬롯";
        const slotType =
          slotEl.dataset.slotType ||
          (slotEl.classList.contains("js-text-slot") ? "text" : "banner");

        if (slotType === "text") {
          document.getElementById("textSelectedPage").value = page;
          document.getElementById("textSelectedPosition").value = position;
          document.getElementById("textModalTitle").textContent = `텍스트 설정: ${label}`;
          document.getElementById("textSlotInfo").innerHTML =
            `${page} / ${position} 슬롯에 표시될 텍스트를 입력합니다.`;

          document.getElementById("textModal").classList.remove("hidden");
          document.getElementById("textModal").classList.add("flex");
        } else {
          document.getElementById("selectedPage").value = page;
          document.getElementById("selectedPosition").value = position;
          document.getElementById("modalTitle").textContent = `슬롯 설정: ${label}`;
          document.getElementById("slotInfo").textContent = `${page} / ${position}`;

          document.getElementById("adModal").classList.remove("hidden");
          document.getElementById("adModal").classList.add("flex");
        }
      });
    }

    // ============================
    // 모달 닫기 공통
    // ============================
    function setupModalClose() {
      ["adModal", "textModal"].forEach((id) => {
        const modal = document.getElementById(id);
        modal?.addEventListener("click", (e) => {
          if (e.target === e.currentTarget) {
            modal.classList.add("hidden");
            modal.classList.remove("flex");
          }
        });
      });
      document.getElementById("closeModal")?.addEventListener("click", () => {
        adModal.classList.add("hidden");
        adModal.classList.remove("flex");
      });
      document.getElementById("closeTextModal")?.addEventListener("click", () => {
        textModal.classList.add("hidden");
        textModal.classList.remove("flex");
      });
    }

    // ============================
    // 이미지/배너 저장
    // ============================
    function setupSaveBanner() {
      const saveBtn = document.getElementById("saveAdBtn");
      if (!saveBtn) return;

      saveBtn.addEventListener("click", async () => {
        const page = document.getElementById("selectedPage").value;
        const position = document.getElementById("selectedPosition").value;
        const imageFile = document.getElementById("imageInput").files[0];
        const link = document.getElementById("linkInput").value.trim();

        const bizNum = document.getElementById("bizNumberInput").value.trim();
        const bizName = document.getElementById("bizNameInput").value.trim();

        const useBizMode = bizNum && bizName; // 사업자 입력 있으면 이 모드

        const formData = new FormData();
        formData.append("page", page);
        formData.append("position", position);
        formData.append("link_url", link || "");

        if (useBizMode) {
          formData.append("biz_number", bizNum);
          formData.append("biz_name", bizName);
        } else if (imageFile) {
          formData.append("image", imageFile);
        }

        const url = useBizMode
          ? "/category/ad/store" // 가게 슬롯 지정 모드
          : "/category/ad/upload"; // 단순 배너 업로드

        try {
          const res = await fetch(url, {
            method: "POST",
            body: formData,
          });
          const data = await res.json();
          if (data.ok) {
            alert("저장 완료되었습니다.");
            document.getElementById("adModal").classList.add("hidden");
          } else {
            alert("오류: " + (data.message || "저장 실패"));
          }
        } catch (err) {
          console.error(err);
          alert("저장 중 오류 발생");
        }
      });
    }

    // ============================
    // 텍스트 슬롯 저장
    // ============================
    function setupSaveText() {
      const saveTextBtn = document.getElementById("saveTextBtn");
      if (!saveTextBtn) return;

      saveTextBtn.addEventListener("click", async () => {
        const page = document.getElementById("textSelectedPage").value;
        const position = document.getElementById("textSelectedPosition").value;
        const content = document.getElementById("textContentInput").value.trim();

        const body = { page, position, content };
        const res = await fetch("/category/ad/text/save", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify(body),
        });
        const data = await res.json();
        if (data.ok) {
          alert("텍스트 저장 완료");
          document.getElementById("textModal").classList.add("hidden");
        }
      });
    }

    document.addEventListener("DOMContentLoaded", () => {
      setupSlotClick();
      setupModalClose();
      setupSaveBanner();
      setupSaveText();
    });
  </script>
</body>

</html>