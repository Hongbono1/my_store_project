<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MALL HANKOOK | FOOD 서브 카테고리 레이아웃 관리자</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', system-ui, -apple-system, BlinkMacSystemFont,
                'Segoe UI', sans-serif;
        }

        .neo-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 1rem;
            box-shadow:
                6px 6px 16px rgba(0, 0, 0, 0.12),
                -6px -6px 16px rgba(255, 255, 255, 0.95);
            transition: all 0.25s ease;
        }

        .neo-card:hover {
            transform: translateY(-3px);
            box-shadow:
                10px 10px 22px rgba(0, 0, 0, 0.2),
                -8px -8px 18px rgba(255, 255, 255, 1);
        }

        .slot-card {
            transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease,
                background-color .2s ease;
        }

        .slot-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 22px rgba(15, 23, 42, 0.16);
            border-color: rgba(59, 130, 246, 0.8);
            background-color: rgba(239, 246, 255, 0.85);
        }

        .layout-bg {
            background:
                radial-gradient(circle at top left, #dbeafe 0, transparent 55%),
                radial-gradient(circle at bottom right, #fef3c7 0, transparent 55%);
        }

        .badge-ad {
            background: rgba(59, 130, 246, 0.12);
            color: #1d4ed8;
        }

        .badge-img {
            background: rgba(34, 197, 94, 0.12);
            color: #15803d;
        }

        .badge-info {
            background: rgba(148, 163, 184, 0.16);
            color: #475569;
        }

        .modal-bg {
            backdrop-filter: blur(6px);
        }

        .tab-btn.active {
            border-bottom: 2px solid #3b82f6;
            color: #2563eb;
        }

        .tab-btn {
            border-bottom: 2px solid transparent;
            transition: all 0.2s ease;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-900">

    <!-- 전체 레이아웃 -->
    <div class="flex min-h-screen">

        <!-- 🔵 왼쪽 사이드바 -->
        <aside class="w-64 bg-white/85 backdrop-blur-xl border-r border-slate-200 px-5 py-6 flex flex-col gap-6">
            <div>
                <h1
                    class="text-2xl font-extrabold bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 bg-clip-text text-transparent">
                    MALL HANKOOK
                </h1>
                <p class="mt-1 text-xs text-slate-500">FOOD 서브 카테고리(subcategory.html) 레이아웃 관리</p>
            </div>

            <div class="space-y-2 text-sm">
                <p class="text-[11px] font-semibold text-slate-500 uppercase tracking-wide mb-1">
                    관리 대상
                </p>
                <div class="border border-slate-200 rounded-lg px-3 py-2 bg-slate-50 text-xs leading-relaxed">
                    <p class="font-semibold text-slate-700">FOOD 서브 카테고리 페이지</p>
                    <p class="text-slate-500 mt-1">
                        <code class="text-[10px]">subcategory.html?type=food&amp;category=한식&amp;sub=밥</code><br>
                        처럼 <span class="font-semibold">밥 / 찌개탕 / 국밥 / 반찬 / 기타한식</span> 등
                        서브 카테고리 화면의 <span class="font-semibold">상단 배너, 설명 문구, Best Seller, New 등록 영역</span>을
                        이미지 + 링크/텍스트로 관리합니다.
                    </p>
                </div>
            </div>

            <div class="space-y-2 text-xs text-slate-500">
                <p class="font-semibold text-[11px] uppercase tracking-wide">
                    사용 방법
                </p>
                <ol class="list-decimal list-inside space-y-1">
                    <li>오른쪽 레이아웃에서 <span class="font-semibold">파란 박스(슬롯)</span>를 클릭</li>
                    <li>이미지/링크 또는 텍스트를 입력 후 <span class="font-semibold">저장</span></li>
                    <li>FOOD 서브 페이지(subcategory.html)에 반영</li>
                </ol>
            </div>

            <div class="space-y-2 text-xs text-slate-500">
                <p class="font-semibold text-[11px] uppercase tracking-wide">
                    서브 카테고리 예시
                </p>
                <ul
                    class="text-[11px] text-slate-500 space-y-1 border border-slate-200 rounded-lg px-3 py-2 bg-slate-50">
                    <li>한식 · 밥 / 찌개탕 / 국밥 / 반찬 / 기타한식</li>
                    <li>양식 · 파스타 / 스테이크 / 피자</li>
                    <li>분식 · 떡볶이 / 튀김 / 순대</li>
                    <li class="text-[10px] text-slate-400">※ 실제 서브 카테고리 구조는 별도 DB/페이지에서 관리</li>
                </ul>
            </div>

            <div class="mt-auto text-[11px] text-slate-400 leading-relaxed">
                이 페이지에서 설정되는 값은<br>
                <span class="font-semibold">admin_ad_slots (page = 'food_subcategory')</span> 에 저장됩니다.
            </div>
        </aside>

        <!-- 🟣 오른쪽 메인 -->
        <main class="flex-1 p-6 md:p-8 space-y-6">

            <!-- 상단 타이틀 -->
            <header class="flex items-center justify-between gap-3">
                <div>
                    <h2 class="text-2xl font-bold flex items-center gap-2">
                        FOOD 서브 카테고리 레이아웃
                    </h2>
                    <p class="text-sm text-slate-500 mt-1">
                        실제 <span class="font-semibold">FOOD 서브 카테고리 페이지(subcategory.html)</span>의 구조를 단순화해서
                        보여주고,
                        각 영역을 슬롯으로 관리합니다.
                    </p>
                </div>
            </header>

            <!-- 🧩 FOOD 서브 카테고리 레이아웃 미리보기 -->
            <section class="neo-card layout-bg p-5 md:p-7 border border-slate-200/70 max-w-6xl mx-auto space-y-5">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="text-lg font-semibold">
                        🍱 FOOD 서브 카테고리 레이아웃 미리보기
                    </h3>
                    <div class="flex items-center gap-2 text-[11px]">
                        <span
                            class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 badge-img border border-emerald-200 text-[10px]">
                            ● 이미지 배너 슬롯
                        </span>
                        <span
                            class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 badge-ad border border-blue-200 text-[10px]">
                            ● 가게/광고 슬롯
                        </span>
                        <span
                            class="inline-flex items-center gap-1 rounded-full px-2 py-0.5 badge-info border border-slate-200 text-[10px]">
                            ● 텍스트 슬롯
                        </span>
                    </div>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-12 gap-4 text-xs md:text-sm">

                    <!-- 🔹 왼쪽: 서브 카테고리 설명 + 상단 사이드 광고 -->
                    <div class="lg:col-span-4 space-y-3">
                        <!-- 서브 카테고리 설명 -->
                        <div class="border border-slate-200 rounded-xl bg-white/80 p-3">
                            <p class="font-semibold mb-1">FOOD 서브 카테고리</p>
                            <p class="text-[11px] text-slate-500">
                                한식의 '밥 / 찌개탕 / 국밥 / 반찬 / 기타한식'처럼
                                <span class="font-semibold">카테고리 안쪽에 있는 소분류</span> 페이지입니다.<br>
                                상단 배너, 설명 문구, Best Seller / New 영역을 슬롯으로 관리합니다.
                            </p>
                        </div>

                        <!-- 서브 페이지 상단 사이드 광고 박스 -->
                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-xl p-3 bg-white/90 js-slot"
                            data-page="food_subcategory" data-position="sub_side_ad" data-label="서브 페이지 사이드 광고 박스">
                            <div class="flex items-center justify-between">
                                <p class="font-semibold">서브 페이지 사이드 광고</p>
                                <span
                                    class="badge-ad text-[10px] border border-blue-200 px-2 py-0.5 rounded-full">이미지/배너</span>
                            </div>
                            <p class="mt-1 text-[11px] text-slate-500">
                                subcategory.html 우측/하단에 들어가는 서브 전용 광고 이미지 + 링크 슬롯입니다.
                            </p>
                        </div>
                    </div>

                    <!-- 🔹 오른쪽: 상단 Hero + 설명 -->
                    <div class="lg:col-span-8 space-y-3">
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-3 items-stretch">

                            <!-- 상단 메인 배너 (Hero 이미지) -->
                            <div class="md:col-span-2">
                                <div class="slot-card cursor-pointer border border-dashed border-emerald-300 rounded-xl p-3 bg-white/90 js-slot"
                                    data-page="food_subcategory" data-position="sub_main_banner"
                                    data-label="서브 상단 메인 배너">
                                    <div class="flex items-center justify-between">
                                        <p class="font-semibold">서브 상단 메인 배너 (Hero)</p>
                                        <span
                                            class="badge-img text-[10px] border border-emerald-200 px-2 py-0.5 rounded-full">이미지
                                            배너</span>
                                    </div>
                                    <p class="mt-1 text-[11px] text-slate-500">
                                        subcategory.html 상단에 보이는 메인 배너 이미지입니다.
                                        밥 / 찌개탕 / 국밥 등 서브 카테고리 분위기에 맞게 설정해주세요.
                                    </p>
                                </div>
                            </div>

                            <!-- 상단 설명 문구 (텍스트 슬롯) -->
                            <div>
                                <div class="slot-card cursor-pointer border border-dashed border-slate-300 rounded-xl p-3 bg-white/95 js-text-slot"
                                    data-page="food_subcategory" data-position="sub_main_text" data-slot-type="text"
                                    data-label="서브 상단 설명 문구">
                                    <div class="flex items-center justify-between">
                                        <p class="font-semibold">서브 상단 설명 문구</p>
                                        <span
                                            class="badge-info text-[10px] border border-slate-200 px-2 py-0.5 rounded-full">텍스트
                                            슬롯</span>
                                    </div>
                                    <p class="mt-1 text-[11px] text-slate-500">
                                        "오늘은 국밥이 생각나는 날이에요." 같은 서브 카테고리 전용 한 줄 설명을 설정합니다.
                                    </p>
                                </div>
                            </div>
                        </div>

                        <!-- All of the items / Best Seller / New registration -->
                        <div class="neo-card border border-slate-200 p-4 bg-white/92 space-y-4">

                            <!-- All of the items 영역 -->
                            <div class="space-y-2">
                                <div class="flex items-center justify-between">
                                    <p class="font-semibold text-[13px]">All of the items 영역</p>
                                    <span
                                        class="badge-info text-[10px] border border-slate-200 px-2 py-0.5 rounded-full">텍스트/설명</span>
                                </div>
                                <p class="text-[11px] text-slate-500">
                                    subcategory.html의 <span class="font-semibold">"All of the items"</span> 섹션 상단에 들어가는
                                    안내 문구/설명을 설정합니다.
                                </p>

                                <div class="slot-card cursor-pointer border border-dashed border-slate-300 rounded-lg p-3 bg-white/95 js-text-slot"
                                    data-page="food_subcategory" data-position="sub_all_text" data-slot-type="text"
                                    data-label="All of the items 설명 문구">
                                    <p class="font-semibold text-[12px]">All of the items 설명 문구</p>
                                    <p class="text-[11px] text-slate-500 mt-1">
                                        "이 서브 카테고리에 등록된 모든 가게를 한눈에 모아봤어요." 같은 문구를 설정합니다.
                                    </p>
                                </div>
                            </div>

                            <!-- Best Seller / New registration 2열 -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-3">

                                <!-- Best Seller 쪽 -->
                                <div class="space-y-2">
                                    <div class="flex items-center justify-between">
                                        <p class="font-semibold text-[13px]">Best Seller 영역</p>
                                        <span
                                            class="badge-ad text-[10px] border border-blue-200 px-2 py-0.5 rounded-full">가게
                                            슬롯</span>
                                    </div>
                                    <p class="text-[11px] text-slate-500">
                                        subcategory.html의 <span class="font-semibold">"Best Seller"</span> 섹션에서
                                        상단 설명과 4개 카드에 노출할 대표 가게/광고를 설정합니다.
                                    </p>

                                    <!-- Best Seller 설명 텍스트 -->
                                    <div class="slot-card cursor-pointer border border-dashed border-slate-300 rounded-lg p-2 bg-white/95 js-text-slot"
                                        data-page="food_subcategory" data-position="sub_best_text" data-slot-type="text"
                                        data-label="Best Seller 설명 문구">
                                        <p class="font-semibold text-[12px]">Best Seller 설명 문구</p>
                                        <p class="text-[11px] text-slate-500 mt-1">
                                            "이 서브 카테고리에서 가장 많이 찾는 가게들이에요." 같은 안내 문구.
                                        </p>
                                    </div>

                                    <!-- Best Seller 4슬롯 -->
                                    <div class="grid grid-cols-2 gap-2 text-[11px]">
                                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                                            data-page="food_subcategory" data-position="sub_best_1"
                                            data-label="Best Seller 1번">
                                            <p class="font-semibold">Best Seller 1</p>
                                            <p class="text-slate-500 mt-1">첫 번째 카드.</p>
                                        </div>
                                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                                            data-page="food_subcategory" data-position="sub_best_2"
                                            data-label="Best Seller 2번">
                                            <p class="font-semibold">Best Seller 2</p>
                                            <p class="text-slate-500 mt-1">두 번째 카드.</p>
                                        </div>
                                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                                            data-page="food_subcategory" data-position="sub_best_3"
                                            data-label="Best Seller 3번">
                                            <p class="font-semibold">Best Seller 3</p>
                                            <p class="text-slate-500 mt-1">세 번째 카드.</p>
                                        </div>
                                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                                            data-page="food_subcategory" data-position="sub_best_4"
                                            data-label="Best Seller 4번">
                                            <p class="font-semibold">Best Seller 4</p>
                                            <p class="text-slate-500 mt-1">네 번째 카드.</p>
                                        </div>
                                    </div>
                                </div>

                                <!-- New registration 쪽 -->
                                <div class="space-y-2">
                                    <div class="flex items-center justify-between">
                                        <p class="font-semibold text-[13px]">New registration 영역</p>
                                        <span
                                            class="badge-ad text-[10px] border border-blue-200 px-2 py-0.5 rounded-full">가게
                                            슬롯</span>
                                    </div>
                                    <p class="text-[11px] text-slate-500">
                                        subcategory.html의 <span class="font-semibold">"New registration"</span> 섹션에서
                                        방금 등록된 가게/홍보를 강조하는 용도로 사용합니다.
                                    </p>

                                    <!-- New registration 설명 텍스트 -->
                                    <div class="slot-card cursor-pointer border border-dashed border-slate-300 rounded-lg p-2 bg-white/95 js-text-slot"
                                        data-page="food_subcategory" data-position="sub_new_text" data-slot-type="text"
                                        data-label="New registration 설명 문구">
                                        <p class="font-semibold text-[12px]">New registration 설명 문구</p>
                                        <p class="text-[11px] text-slate-500 mt-1">
                                            "최근 등록된 새 가게들을 만나보세요." 같은 안내 문구.
                                        </p>
                                    </div>

                                    <!-- New registration 4슬롯 -->
                                    <div class="grid grid-cols-2 gap-2 text-[11px]">
                                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                                            data-page="food_subcategory" data-position="sub_new_1"
                                            data-label="New registration 1번">
                                            <p class="font-semibold">New 1</p>
                                            <p class="text-slate-500 mt-1">첫 번째 카드.</p>
                                        </div>
                                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                                            data-page="food_subcategory" data-position="sub_new_2"
                                            data-label="New registration 2번">
                                            <p class="font-semibold">New 2</p>
                                            <p class="text-slate-500 mt-1">두 번째 카드.</p>
                                        </div>
                                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                                            data-page="food_subcategory" data-position="sub_new_3"
                                            data-label="New registration 3번">
                                            <p class="font-semibold">New 3</p>
                                            <p class="text-slate-500 mt-1">세 번째 카드.</p>
                                        </div>
                                        <div class="slot-card cursor-pointer border border-dashed border-blue-300 rounded-lg p-2 bg-white/90 js-slot"
                                            data-page="food_subcategory" data-position="sub_new_4"
                                            data-label="New registration 4번">
                                            <p class="font-semibold">New 4</p>
                                            <p class="text-slate-500 mt-1">네 번째 카드.</p>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>

                    </div>
                </div>
            </section>

        </main>
    </div>

    <!-- ======================== -->
    <!-- 광고/이미지/텍스트 등록 모달 -->
    <!-- ======================== -->
    <div id="adModal" class="fixed inset-0 bg-black/40 modal-bg hidden justify-center items-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-7 max-w-lg w-full border border-slate-200">

            <h2 id="modalTitle" class="text-lg font-bold mb-4">
                슬롯 설정
            </h2>

            <form id="adForm" class="space-y-4">
                <!-- 슬롯 설명 -->
                <div class="text-xs text-slate-600 bg-slate-50 border border-slate-100 rounded-lg p-3" id="slotInfo">
                    선택된 슬롯 정보가 여기에 표시됩니다.
                </div>

                <!-- 입력 방식 선택 -->
                <div>
                    <label class="block font-semibold mb-1 text-sm">입력 방식 선택</label>
                    <div class="flex flex-col gap-1 text-xs sm:flex-row sm:items-center sm:gap-4">
                        <label class="inline-flex items-center gap-1">
                            <input type="radio" name="adMode" id="modeCustom" value="custom" class="text-blue-600"
                                checked>
                            <span>이미지 + 링크 직접 입력</span>
                        </label>
                        <label class="inline-flex items-center gap-1">
                            <input type="radio" name="adMode" id="modeStore" value="store" class="text-blue-600">
                            <span>등록된 가게로 연결 (사업자번호 + 상호)</span>
                        </label>
                    </div>
                    <p class="text-[11px] text-slate-400 mt-1">
                        서브 상단 배너는 <span class="font-semibold">'이미지 + 링크'</span>를,
                        Best / New 영역은 <span class="font-semibold">'등록된 가게'</span> 모드도 활용할 수 있습니다.
                    </p>
                </div>

                <!-- 🔸 노출 기간/시간 -->
                <div class="space-y-2">
                    <label class="block font-semibold mb-1 text-sm">노출 기간</label>
                    <div class="flex items-center gap-2">
                        <input id="startDateInput" type="date"
                            class="flex-1 border border-slate-300 rounded-lg px-2 py-1 text-xs md:text-sm">
                        <span class="text-[11px] text-slate-500">~</span>
                        <input id="endDateInput" type="date"
                            class="flex-1 border border-slate-300 rounded-lg px-2 py-1 text-xs md:text-sm">
                    </div>
                    <p class="text-[11px] text-slate-400">
                        시작일과 종료일을 설정하지 않으면 상시 노출로 간주합니다.
                    </p>

                    <label class="block font-semibold mb-1 text-sm mt-2">노출 시간대</label>
                    <div class="flex items-center gap-2">
                        <input id="startTimeInput" type="time"
                            class="flex-1 border border-slate-300 rounded-lg px-2 py-1 text-xs md:text-sm">
                        <span class="text-[11px] text-slate-500">~</span>
                        <input id="endTimeInput" type="time"
                            class="flex-1 border border-slate-300 rounded-lg px-2 py-1 text-xs md:text-sm">
                    </div>
                    <p class="text-[11px] text-slate-400">
                        노출 시간을 비워두면 하루 종일 노출됩니다.
                    </p>
                </div>

                <!-- 등록된 가게로 연결 (사업자번호 + 상호) -->
                <div id="storeModeFields" class="space-y-2 hidden">
                    <div>
                        <label for="businessNoInput" class="block font-semibold mb-1 text-sm">사업자 등록번호</label>
                        <input id="businessNoInput" type="text"
                            class="w-full border border-slate-300 p-2 rounded-lg text-sm" placeholder="예) 123-45-67890">
                    </div>
                    <div>
                        <label for="businessNameInput" class="block font-semibold mb-1 text-sm">상호명</label>
                        <input id="businessNameInput" type="text"
                            class="w-full border border-slate-300 p-2 rounded-lg text-sm" placeholder="예) 홍길동식당">
                    </div>
                    <p class="text-[11px] text-slate-400">
                        등록/가게 관리 페이지에 저장된 <span class="font-semibold">사업자번호 + 상호</span>와 일치하는 가게를 찾아,
                        해당 가게의 이미지와 상세 페이지 링크를 이 슬롯에 자동으로 연결합니다.
                    </p>
                </div>

                <!-- 이미지/링크 직접 입력 -->
                <div id="customModeFields" class="space-y-3">
                    <!-- 이미지 업로드 -->
                    <div>
                        <label class="block font-semibold mb-1 text-sm">이미지 파일 (선택)</label>
                        <input id="imageInput" type="file"
                            class="w-full border border-slate-300 p-2 rounded-lg text-sm">
                        <p class="text-[11px] text-slate-400 mt-1">
                            배너/카드에 들어갈 이미지를 선택하세요. (이미지 없이 링크/텍스트만 관리하는 용도로도 사용 가능)
                        </p>
                    </div>

                    <!-- 링크 입력 -->
                    <div>
                        <label class="block font-semibold mb-1 text-sm">클릭 시 이동 링크 (선택)</label>
                        <input id="linkInput" type="text"
                            placeholder="https://www.hongbono1.com/ndetail.html?id=1&type=food"
                            class="w-full border border-slate-300 p-2 rounded-lg text-sm">
                        <p class="text-[11px] text-slate-400 mt-1">
                            비워두면 링크 없이 이미지/배너만 표시됩니다.
                        </p>
                    </div>
                </div>

                <input type="hidden" id="selectedPage">
                <input type="hidden" id="selectedPosition">

                <div class="flex justify-end gap-3 pt-3">
                    <button type="button" id="closeModal"
                        class="px-4 py-2 border border-slate-300 rounded-lg text-sm text-slate-600 hover:bg-slate-50">
                        취소
                    </button>
                    <button type="button" id="saveAdBtn"
                        class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow text-sm hover:bg-blue-700">
                        저장
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- ======================== -->
    <!-- 🟢 텍스트 입력 전용 모달 -->
    <!-- ======================== -->
    <div id="textModal" class="fixed inset-0 bg-black/40 modal-bg hidden justify-center items-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-7 max-w-lg w-full border border-slate-200">
            <h2 id="textModalTitle" class="text-lg font-bold mb-3">
                텍스트 설정
            </h2>

            <form id="textForm" class="space-y-3">
                <div class="text-xs text-slate-600 bg-slate-50 border border-slate-100 rounded-lg p-3"
                    id="textSlotInfo">
                    서브 카테고리의 <span class="font-semibold">설명 문구 / 영역 안내 문구</span>를 설정합니다.
                </div>

                <div>
                    <label class="block font-semibold mb-1 text-sm">표시할 텍스트</label>
                    <textarea id="textContentInput"
                        class="w-full border border-slate-300 rounded-lg p-2 text-sm min-h-[120px]"
                        placeholder="예) 오늘은 따끈한 국밥이 생각나는 날이에요. 우리동네 인기 한식 국밥 가게를 만나보세요."></textarea>
                </div>

                <input type="hidden" id="textSelectedPage">
                <input type="hidden" id="textSelectedPosition">

                <div class="flex justify-end gap-3 pt-2">
                    <button type="button" id="closeTextModal"
                        class="px-4 py-2 border border-slate-300 rounded-lg text-sm text-slate-600 hover:bg-slate-50">
                        취소
                    </button>
                    <button type="button" id="saveTextBtn"
                        class="px-4 py-2 bg-emerald-600 text-white rounded-lg shadow text-sm hover:bg-emerald-700">
                        저장
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ============================
        // 슬롯 클릭 → 모달 열기
        // ============================
        function setupSlotClick() {
            document.addEventListener("click", (e) => {
                const slotEl = e.target.closest(".js-slot, .js-text-slot");
                if (!slotEl) return;

                const page = slotEl.dataset.page || "food_subcategory";
                const position = slotEl.dataset.position || "";
                const label = slotEl.dataset.label || "선택된 슬롯";
                const slotType =
                    slotEl.dataset.slotType ||
                    (slotEl.classList.contains("js-text-slot") ? "text" : "banner");

                if (slotType === "text") {
                    // 🟢 텍스트 전용 모달
                    document.getElementById("textSelectedPage").value = page;
                    document.getElementById("textSelectedPosition").value = position;
                    document.getElementById("textModalTitle").textContent = `텍스트 설정: ${label}`;
                    document.getElementById("textSlotInfo").innerHTML =
                        `FOOD 서브 카테고리의 <span class="font-semibold">${position}</span> 슬롯에 표시될 텍스트를 입력합니다.`;

                    document.getElementById("textModal").classList.remove("hidden");
                    document.getElementById("textModal").classList.add("flex");
                } else {
                    // 🔵 이미지/배너 모달
                    document.getElementById("selectedPage").value = page;
                    document.getElementById("selectedPosition").value = position;
                    document.getElementById("modalTitle").textContent = `슬롯 설정: ${label}`;
                    document.getElementById("slotInfo").textContent = `${page} / ${position}`;

                    document.getElementById("adModal").classList.remove("hidden");
                    document.getElementById("adModal").classList.add("flex");
                }
            });
        }

        // ============================
        // 모달 닫기
        // ============================
        function setupModalClose() {
            document.getElementById("closeModal").addEventListener("click", () => {
                document.getElementById("adModal").classList.add("hidden");
                document.getElementById("adModal").classList.remove("flex");
            });

            document.getElementById("adModal").addEventListener("click", (e) => {
                if (e.target === e.currentTarget) {
                    document.getElementById("adModal").classList.add("hidden");
                    document.getElementById("adModal").classList.remove("flex");
                }
            });
        }

        // ============================
        // 텍스트 모달 닫기
        // ============================
        function setupTextModalClose() {
            document.getElementById("closeTextModal").addEventListener("click", () => {
                document.getElementById("textModal").classList.add("hidden");
                document.getElementById("textModal").classList.remove("flex");
            });

            document.getElementById("textModal").addEventListener("click", (e) => {
                if (e.target === e.currentTarget) {
                    document.getElementById("textModal").classList.add("hidden");
                    document.getElementById("textModal").classList.remove("flex");
                }
            });
        }

        // ============================
        // 입력 모드 토글 (가게 / 커스텀)
        // ============================
        function setupModeToggle() {
            const customFields = document.getElementById("customModeFields");
            const storeFields = document.getElementById("storeModeFields");
            const modeCustom = document.getElementById("modeCustom");
            const modeStore = document.getElementById("modeStore");

            if (!customFields || !storeFields || !modeCustom || !modeStore) return;

            const updateVisibility = () => {
                if (modeStore.checked) {
                    storeFields.classList.remove("hidden");
                    customFields.classList.add("hidden");
                } else {
                    customFields.classList.remove("hidden");
                    storeFields.classList.add("hidden");
                }
            };

            modeCustom.addEventListener("change", updateVisibility);
            modeStore.addEventListener("change", updateVisibility);

            // 초기 상태
            updateVisibility();
        }

        // ============================
        // 저장 버튼 → /category/ad/upload 또는 /category/ad/store
        // (page = 'food_subcategory' 로 구분 저장)
        // ============================
        function setupSave() {
            document.getElementById("saveAdBtn").addEventListener("click", async () => {
                const page = document.getElementById("selectedPage").value || "food_subcategory";
                const position = document.getElementById("selectedPosition").value;
                const modeInput = document.querySelector('input[name="adMode"]:checked');
                const mode = modeInput ? modeInput.value : "custom";

                const startDate = document.getElementById("startDateInput").value;
                const endDate = document.getElementById("endDateInput").value;
                const startTime = document.getElementById("startTimeInput").value;
                const endTime = document.getElementById("endTimeInput").value;

                if (!page || !position) {
                    alert("슬롯 정보가 없습니다. 다시 선택해주세요.");
                    return;
                }

                // 🍽 등록된 가게로 연결 모드
                if (mode === "store") {
                    const businessNo = (document.getElementById("businessNoInput").value || "").trim();
                    const businessName = (document.getElementById("businessNameInput").value || "").trim();

                    if (!businessNo || !businessName) {
                        alert("사업자번호와 상호를 모두 입력해주세요.");
                        return;
                    }

                    const body = {
                        page,
                        position,
                        biz_number: businessNo,
                        biz_name: businessName,
                        start_date: startDate || null,
                        end_date: endDate || null,
                        start_time: startTime || null,
                        end_time: endTime || null,
                    };

                    try {
                        const res = await fetch("/category/ad/store", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify(body),
                        });
                        const data = await res.json();
                        if (data.ok) {
                            alert("가게가 이 슬롯에 연결되었습니다.");
                            document.getElementById("adModal").classList.add("hidden");
                            document.getElementById("adModal").classList.remove("flex");
                            document.getElementById("businessNoInput").value = "";
                            document.getElementById("businessNameInput").value = "";
                            document.getElementById("startDateInput").value = "";
                            document.getElementById("endDateInput").value = "";
                            document.getElementById("startTimeInput").value = "";
                            document.getElementById("endTimeInput").value = "";
                        } else {
                            alert("오류: " + (data.message || "가게 연결에 실패했습니다."));
                        }
                    } catch (err) {
                        console.error(err);
                        alert("가게 연결 중 오류가 발생했습니다.");
                    }

                    return; // 여기서 종료
                }

                // 🎨 이미지 + 링크 직접 입력 모드
                const imageFile = document.getElementById("imageInput").files[0];
                const link = document.getElementById("linkInput").value.trim();

                // 이미지 없이 링크만 저장하는 것도 허용
                if (!imageFile && !link) {
                    const ok = confirm("이미지와 링크가 모두 비어 있습니다.\n그래도 이 슬롯 정보만 저장하시겠습니까?");
                    if (!ok) return;
                }

                const formData = new FormData();
                formData.append("page", page);
                formData.append("position", position);
                formData.append("link_url", link);
                if (startDate) formData.append("start_date", startDate);
                if (endDate) formData.append("end_date", endDate);
                if (startTime) formData.append("start_time", startTime);
                if (endTime) formData.append("end_time", endTime);
                if (imageFile) {
                    formData.append("image", imageFile);
                }

                try {
                    const res = await fetch("/category/ad/upload", {
                        method: "POST",
                        body: formData
                    });
                    const data = await res.json();
                    if (data.ok) {
                        alert("저장 완료되었습니다.");
                        document.getElementById("adModal").classList.add("hidden");
                        document.getElementById("adModal").classList.remove("flex");
                        document.getElementById("imageInput").value = "";
                        document.getElementById("linkInput").value = "";
                        document.getElementById("startDateInput").value = "";
                        document.getElementById("endDateInput").value = "";
                        document.getElementById("startTimeInput").value = "";
                        document.getElementById("endTimeInput").value = "";
                    } else {
                        alert("오류: " + (data.message || "저장에 실패했습니다."));
                    }
                } catch (err) {
                    console.error(err);
                    alert("저장 중 오류가 발생했습니다.");
                }
            });
        }

        // ============================
        // 텍스트 저장 → /category/ad/text/save
        // ============================
        function setupSaveText() {
            document.getElementById("saveTextBtn").addEventListener("click", async () => {
                const page = document.getElementById("textSelectedPage").value || "food_subcategory";
                const position = document.getElementById("textSelectedPosition").value;
                const content = document.getElementById("textContentInput").value.trim();

                if (!page || !position) {
                    alert("슬롯 정보가 없습니다. 다시 선택해주세요.");
                    return;
                }
                if (!content) {
                    alert("표시할 텍스트를 입력해주세요.");
                    return;
                }

                const body = { page, position, content };

                try {
                    const res = await fetch("/category/ad/text/save", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(body),
                    });
                    const data = await res.json();
                    if (data.ok) {
                        alert("텍스트가 저장되었습니다.");
                        document.getElementById("textModal").classList.add("hidden");
                        document.getElementById("textModal").classList.remove("flex");
                        document.getElementById("textContentInput").value = "";
                    } else {
                        alert("오류: " + (data.message || "저장에 실패했습니다."));
                    }
                } catch (err) {
                    console.error(err);
                    alert("저장 중 오류가 발생했습니다.");
                }
            });
        }

        // ============================
        // 초기화
        // ============================
        document.addEventListener("DOMContentLoaded", () => {
            setupSlotClick();
            setupModalClose();
            setupTextModalClose();
            setupModeToggle();
            setupSave();
            setupSaveText();
        });
    </script>
</body>

</html>