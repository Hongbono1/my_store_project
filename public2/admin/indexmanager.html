<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MALL HANKOOK | ë©”ì¸(index) ë ˆì´ì•„ì›ƒ ê´€ë¦¬ì</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', system-ui, sans-serif;
        }

        .neo-card {
            background: rgba(255, 255, 255, 0.92);
            backdrop-filter: blur(16px);
            border-radius: 1rem;
            box-shadow:
                6px 6px 16px rgba(15, 23, 42, 0.12),
                -3px -3px 10px rgba(255, 255, 255, 0.8);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }

        .slot-card {
            transition: all 0.2s;
        }

        .slot-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="min-h-screen bg-gradient-to-br from-slate-100 via-slate-50 to-sky-100 text-slate-800">

    <!-- ìƒë‹¨ í—¤ë” -->
    <header class="bg-white/80 backdrop-blur border-b border-slate-200 sticky top-0 z-20">
        <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <a href="/mainmanager.html" class="text-sky-600 hover:text-sky-800 text-sm">â† ë©”ì¸ ê´€ë¦¬ì</a>
                <h1 class="text-lg font-bold">ë©”ì¸(index.html) ë ˆì´ì•„ì›ƒ ìŠ¬ë¡¯ ê´€ë¦¬</h1>
            </div>
            <span class="text-xs text-slate-500">1ìˆœìœ„: ê´€ë¦¬ì ì„¤ì •ê°’ â†’ 2ìˆœìœ„: ê¸°ë³¸ê°’</span>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 py-6 space-y-6">

        <!-- ë°°ë„ˆ ìŠ¬ë¡¯ ì„¹ì…˜ -->
        <section class="neo-card p-5">
            <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                ğŸ–¼ï¸ ë°°ë„ˆ/ì´ë¯¸ì§€ ìŠ¬ë¡¯
                <span class="text-xs font-normal text-slate-500">(ì´ë¯¸ì§€ + ë§í¬)</span>
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">

                <!-- ìƒë‹¨ ë ë°°ë„ˆ -->
                <div class="slot-card border rounded-lg p-4 bg-white">
                    <p class="font-semibold text-sm mb-2">ìƒë‹¨ ë ë°°ë„ˆ</p>
                    <p class="text-xs text-slate-500 mb-3">slot_index_main_top</p>
                    <form onsubmit="saveBanner(event, 'index', 'main_top')">
                        <input type="file" name="image" accept="image/*"
                            class="w-full text-xs mb-2 file:mr-2 file:py-1 file:px-3 file:rounded file:border-0 file:bg-sky-100 file:text-sky-700">
                        <input type="text" name="link_url" placeholder="ë§í¬ URL (ì„ íƒ)"
                            class="w-full text-xs border rounded px-2 py-1 mb-2">
                        <button type="submit"
                            class="w-full text-xs py-2 bg-sky-600 text-white rounded hover:bg-sky-700">ì €ì¥</button>
                    </form>
                    <div id="preview_main_top" class="mt-2"></div>
                </div>

                <!-- í”„ë¡œëª¨ì…˜ ë°°ë„ˆ 1 -->
                <div class="slot-card border rounded-lg p-4 bg-white">
                    <p class="font-semibold text-sm mb-2">í”„ë¡œëª¨ì…˜ ë°°ë„ˆ 1</p>
                    <p class="text-xs text-slate-500 mb-3">slot_index_promo_1</p>
                    <form onsubmit="saveBanner(event, 'index', 'promo_1')">
                        <input type="file" name="image" accept="image/*"
                            class="w-full text-xs mb-2 file:mr-2 file:py-1 file:px-3 file:rounded file:border-0 file:bg-sky-100 file:text-sky-700">
                        <input type="text" name="link_url" placeholder="ë§í¬ URL (ì„ íƒ)"
                            class="w-full text-xs border rounded px-2 py-1 mb-2">
                        <button type="submit"
                            class="w-full text-xs py-2 bg-sky-600 text-white rounded hover:bg-sky-700">ì €ì¥</button>
                    </form>
                    <div id="preview_promo_1" class="mt-2"></div>
                </div>

                <!-- í”„ë¡œëª¨ì…˜ ë°°ë„ˆ 2 -->
                <div class="slot-card border rounded-lg p-4 bg-white">
                    <p class="font-semibold text-sm mb-2">í”„ë¡œëª¨ì…˜ ë°°ë„ˆ 2</p>
                    <p class="text-xs text-slate-500 mb-3">slot_index_promo_2</p>
                    <form onsubmit="saveBanner(event, 'index', 'promo_2')">
                        <input type="file" name="image" accept="image/*"
                            class="w-full text-xs mb-2 file:mr-2 file:py-1 file:px-3 file:rounded file:border-0 file:bg-sky-100 file:text-sky-700">
                        <input type="text" name="link_url" placeholder="ë§í¬ URL (ì„ íƒ)"
                            class="w-full text-xs border rounded px-2 py-1 mb-2">
                        <button type="submit"
                            class="w-full text-xs py-2 bg-sky-600 text-white rounded hover:bg-sky-700">ì €ì¥</button>
                    </form>
                    <div id="preview_promo_2" class="mt-2"></div>
                </div>

            </div>
        </section>

        <!-- í…ìŠ¤íŠ¸ ìŠ¬ë¡¯ ì„¹ì…˜ -->
        <section class="neo-card p-5">
            <h2 class="text-lg font-bold mb-4 flex items-center gap-2">
                âœï¸ í…ìŠ¤íŠ¸ ìŠ¬ë¡¯
                <span class="text-xs font-normal text-slate-500">(ë¬¸êµ¬ë§Œ)</span>
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">

                <!-- ìš°ë¦¬ë™ë„¤ í•œë§ˆë”” -->
                <div class="slot-card border rounded-lg p-4 bg-white">
                    <p class="font-semibold text-sm mb-2">ìš°ë¦¬ë™ë„¤ í•œë§ˆë”” ì œëª©</p>
                    <p class="text-xs text-slate-500 mb-3">slot_index_oneword</p>
                    <form onsubmit="saveText(event, 'index', 'oneword')">
                        <textarea name="text_content" rows="2" placeholder="í‘œì‹œí•  í…ìŠ¤íŠ¸"
                            class="w-full text-xs border rounded px-2 py-1 mb-2"></textarea>
                        <button type="submit"
                            class="w-full text-xs py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700">ì €ì¥</button>
                    </form>
                    <div id="preview_oneword" class="mt-2 text-xs text-slate-600"></div>
                </div>

                <!-- Best Pick ì œëª© -->
                <div class="slot-card border rounded-lg p-4 bg-white">
                    <p class="font-semibold text-sm mb-2">Best Pick ì„¹ì…˜ ì œëª©</p>
                    <p class="text-xs text-slate-500 mb-3">slot_index_bestpick_title</p>
                    <form onsubmit="saveText(event, 'index', 'bestpick_title')">
                        <textarea name="text_content" rows="2" placeholder="í‘œì‹œí•  í…ìŠ¤íŠ¸"
                            class="w-full text-xs border rounded px-2 py-1 mb-2"></textarea>
                        <button type="submit"
                            class="w-full text-xs py-2 bg-emerald-600 text-white rounded hover:bg-emerald-700">ì €ì¥</button>
                    </form>
                    <div id="preview_bestpick_title" class="mt-2 text-xs text-slate-600"></div>
                </div>

            </div>
        </section>

    </main>

    <script>
        // ë°°ë„ˆ ì €ì¥
        async function saveBanner(e, page, position) {
            e.preventDefault();
            const form = e.target;
            const formData = new FormData(form);
            formData.append("page", page);
            formData.append("position", position);

            try {
                const res = await fetch("/manager/ad/upload", {
                    method: "POST",
                    body: formData
                });
                const data = await res.json();
                if (data.ok) {
                    alert("ì €ì¥ ì™„ë£Œ!");
                    loadPreview(page, position);
                } else {
                    alert("ì €ì¥ ì‹¤íŒ¨: " + (data.error || ""));
                }
            } catch (err) {
                alert("ì˜¤ë¥˜: " + err.message);
            }
        }

        // í…ìŠ¤íŠ¸ ì €ì¥
        async function saveText(e, page, position) {
            e.preventDefault();
            const form = e.target;
            const textContent = form.text_content.value;

            try {
                const res = await fetch("/manager/ad/text/save", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ page, position, text_content: textContent })
                });
                const data = await res.json();
                if (data.ok) {
                    alert("ì €ì¥ ì™„ë£Œ!");
                    document.getElementById(`preview_${position}`).textContent = textContent;
                } else {
                    alert("ì €ì¥ ì‹¤íŒ¨");
                }
            } catch (err) {
                alert("ì˜¤ë¥˜: " + err.message);
            }
        }

        // ë¯¸ë¦¬ë³´ê¸° ë¡œë“œ
        async function loadPreview(page, position) {
            try {
                const res = await fetch(`/manager/ad/slot?page=${page}&position=${position}`);
                const data = await res.json();
                const previewEl = document.getElementById(`preview_${position}`);
                if (data.ok && data.slot && data.slot.image_url) {
                    previewEl.innerHTML = `<img src="${data.slot.image_url}" class="w-full h-20 object-cover rounded">`;
                }
            } catch (err) {
                console.error(err);
            }
        }

        // ì´ˆê¸° ë¡œë“œ
        document.addEventListener("DOMContentLoaded", () => {
            ["main_top", "promo_1", "promo_2"].forEach(pos => loadPreview("index", pos));
        });
    </script>

</body>

</html>