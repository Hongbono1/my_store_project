<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MALL HANKOOK ë©”ì¸ ë ˆì´ì•„ì›ƒ ê´€ë¦¬ì | indexmanager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Noto Sans KR', system-ui, -apple-system, BlinkMacSystemFont,
                'Segoe UI', sans-serif;
        }

        /* âœ… ìˆ˜ì •ëœ neo-card ìŠ¤íƒ€ì¼ - ë” ëª…í™•í•œ í…Œë‘ë¦¬ì™€ ë°°ê²½ */
        .neo-card {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(59, 130, 246, 0.2);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-radius: 1rem;
            box-shadow:
                4px 4px 12px rgba(0, 0, 0, 0.1),
                -2px -2px 8px rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            min-height: 120px;
        }

        .neo-card:hover {
            transform: translateY(-2px);
            box-shadow:
                6px 6px 16px rgba(0, 0, 0, 0.15),
                -3px -3px 10px rgba(255, 255, 255, 0.9);
            border: 2px solid rgba(59, 130, 246, 0.4);
            background: rgba(255, 255, 255, 0.98);
        }

        /* ë””ë²„ê¹…ìš© - ë°•ìŠ¤ê°€ ì•ˆë³´ì¼ ë•Œ í™œì„±í™” */
        .debug-neo-card {
            outline: 2px dashed #ef4444 !important;
            background: rgba(255, 0, 0, 0.05) !important;
        }

        /* ìŠ¬ë¡¯ ê¸°ë³¸ ìŠ¤íƒ€ì¼ ê°•í™” */
        .slot-banner {
            position: relative;
            overflow: hidden;
            min-height: 100px;
            border: 1px solid #e2e8f0;
            background: #f8fafc;
        }

        .slot-banner img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block;
        }

        .slot-banner .slot-default {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
            background: #f1f5f9;
            border: 2px dashed #cbd5e1;
        }

        /* í…ìŠ¤íŠ¸ ìŠ¬ë¡¯ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .js-text-slot .slot-default-text {
            min-height: 80px;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        /* ê´€ë¦¬ì ëª¨ë‹¬ ê³µí†µ */
        .modal-bg {
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
        }

        .badge-ad {
            background: rgba(59, 130, 246, 0.12);
            color: #1d4ed8;
        }

        .badge-img {
            background: rgba(34, 197, 94, 0.12);
            color: #15803d;
        }

        .badge-info {
            background: rgba(148, 163, 184, 0.16);
            color: #475569;
        }
    </style>
</head>

<body class="bg-white text-gray-800">

    <!-- ìƒë‹¨ ê´€ë¦¬ì ì•ˆë‚´ ë  -->
    <header class="w-full border-b border-slate-200/70 bg-slate-50/80 backdrop-blur sticky top-0 z-40">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 py-2 flex items-center justify-between text-xs">
            <div class="flex items-center gap-2">
                <span
                    class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-blue-600 text-white text-[11px] font-bold">ADM</span>
                <div>
                    <p class="font-semibold text-slate-700">MALL HANKOOK Â· ë©”ì¸ ë ˆì´ì•„ì›ƒ ê´€ë¦¬ì</p>
                    <p class="text-[11px] text-slate-500">index.html í™”ë©´ì˜ ê´‘ê³ /ì´ë¯¸ì§€/í…ìŠ¤íŠ¸ ìŠ¬ë¡¯ì„ ì„¤ì •í•©ë‹ˆë‹¤. (í´ë¦­í•˜ë©´
                        ëª¨ë‹¬ ì—´ë¦¼)</p>
                </div>
            </div>
            <div class="hidden sm:flex flex-col items-end gap-0.5 text-[10px] text-slate-500">
                <span>page = <span class="font-mono font-semibold text-slate-800">"index"</span></span>
                <span>router: <span class="font-mono">/manager/ad/*</span></span>
            </div>
        </div>
    </header>

    <!-- í—¤ë” -->
    <div id="header-placeholder"></div>

    <!-- â‘  ìƒë‹¨ ë ë°°ë„ˆ -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 mt-16">
        <div id="slot_index_main_top"
            class="neo-card h-28 flex flex-col items-center justify-center text-center cursor-pointer slot-banner js-slot"
            data-page="index" data-position="index_main_top" data-label="ìƒë‹¨ ë ë°°ë„ˆ">
            <img class="slot-img hidden rounded-lg" alt="ê´‘ê³ ">
            <div class="slot-default">
                <div>
                    <p class="text-lg sm:text-xl md:text-2xl font-bold">ë„¤ì´ë²„ì— ìƒˆì§‘ë§ˆë ¨</p>
                    <p class="text-gray-600 text-sm sm:text-base">ë‚´ ì·¨í–¥ì„ ê¸°ë¡í•  ìƒˆë¡œìš´ ê³µê°„</p>
                </div>
            </div>
        </div>
    </div>

    <!-- â‘¡ ë©”ì¸ ë¹„ì£¼ì–¼ + â‘¢â‘£â‘¤ í”„ë¡œëª¨ 1/2/3 -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 py-8">

        <div class="grid grid-cols-1 lg:grid-cols-4 gap-6 items-stretch">

            <!-- ë©”ì¸ ë°°ë„ˆ -->
            <div class="lg:col-span-3">
                <div id="slot_index_main_visual"
                    class="slot-banner js-slot rounded-2xl overflow-hidden bg-gray-100 shadow-lg aspect-[21/9] w-full h-full cursor-pointer"
                    data-page="index" data-position="index_main_visual" data-label="ë©”ì¸ ë¹„ì£¼ì–¼ ë°°ë„ˆ">

                    <img class="slot-img hidden w-full h-full object-contain" alt="ë©”ì¸ ë°°ë„ˆ">

                    <div class="slot-default w-full h-full flex items-center justify-center bg-gray-100">
                        <img src="/uploads/main-banner.png" alt="ê¸°ë³¸ ë©”ì¸ ë°°ë„ˆ" class="w-full h-full object-contain">
                    </div>
                </div>
            </div>

            <!-- ì˜¤ë¥¸ìª½ í”„ë¡œëª¨ 3ê°œ -->
            <div class="lg:col-span-1 flex flex-col gap-4 h-full">

                <div id="slot_index_promo_1"
                    class="slot-banner js-slot rounded-2xl border border-gray-100 bg-white shadow-sm overflow-hidden flex-1 min-h-[90px] cursor-pointer"
                    data-page="index" data-position="index_promo_1" data-label="í”„ë¡œëª¨ì…˜ 1ë²ˆ">
                    <img class="slot-img hidden w-full h-full object-cover" alt="í”„ë¡œëª¨ 1">
                    <div
                        class="slot-default w-full h-full flex items-center justify-center text-xs text-gray-500 bg-gray-100">
                        Promo 1
                    </div>
                </div>

                <div id="slot_index_promo_2"
                    class="slot-banner js-slot rounded-2xl border border-gray-100 bg-white shadow-sm overflow-hidden flex-1 min-h-[90px] cursor-pointer"
                    data-page="index" data-position="index_promo_2" data-label="í”„ë¡œëª¨ì…˜ 2ë²ˆ">
                    <img class="slot-img hidden w-full h-full object-cover" alt="í”„ë¡œëª¨ 2">
                    <div
                        class="slot-default w-full h-full flex items-center justify-center text-xs text-gray-500 bg-gray-100">
                        Promo 2
                    </div>
                </div>

                <div id="slot_index_promo_3"
                    class="slot-banner js-slot rounded-2xl border border-gray-100 bg-white shadow-sm overflow-hidden flex-1 min-h-[90px] cursor-pointer"
                    data-page="index" data-position="index_promo_3" data-label="í”„ë¡œëª¨ì…˜ 3ë²ˆ">
                    <img class="slot-img hidden w-full h-full object-cover" alt="í”„ë¡œëª¨ 3">
                    <div
                        class="slot-default w-full h-full flex items-center justify-center text-xs text-gray-500 bg-gray-100">
                        Promo 3
                    </div>
                </div>

            </div>
        </div>
    </section>

    <!-- â‘¥ ìƒë‹¨ ì„œë¸Œ ë°•ìŠ¤ -->
    <section
        class="max-w-7xl mx-auto px-4 sm:px-6 py-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 text-center">
        <div>
            <h3 class="font-bold text-xl sm:text-2xl mb-2">ê²€ìƒ‰ì–´</h3>
            <a href="search.html">
                <div id="slot_index_sub_keywords" class="neo-card min-h-28 p-4 cursor-pointer js-text-slot"
                    data-page="index" data-position="index_sub_keywords" data-slot-type="text" data-label="ê²€ìƒ‰ì–´ ë°•ìŠ¤">
                    <div class="slot-default-text"></div>
                </div>
            </a>
        </div>
        <div>
            <h3 class="font-bold text-xl sm:text-2xl mb-2">ìµœì‹  ì†Œì‹</h3>
            <a href="news.html">
                <div id="slot_index_sub_news" class="neo-card min-h-28 p-4 cursor-pointer js-text-slot"
                    data-page="index" data-position="index_sub_news" data-slot-type="text" data-label="ìµœì‹  ì†Œì‹ ë°•ìŠ¤">
                    <div class="slot-default-text"></div>
                </div>
            </a>
        </div>
        <div>
            <h3 class="font-bold text-xl sm:text-2xl mb-2">ì´ë²¤íŠ¸ ì •ë³´</h3>
            <div id="slot_index_sub_events" class="neo-card min-h-28 p-4 cursor-pointer js-text-slot" data-page="index"
                data-position="index_sub_events" data-slot-type="text" data-label="ì´ë²¤íŠ¸ ì •ë³´ ë°•ìŠ¤">
                <div class="slot-default-text"></div>
            </div>
        </div>
        <div>
            <h3 class="font-bold text-xl sm:text-2xl mb-2">ì¶”ì²œ ì œí’ˆ</h3>
            <a href="recommend.html">
                <div id="slot_index_sub_recommends" class="neo-card min-h-28 p-4 cursor-pointer js-text-slot"
                    data-page="index" data-position="index_sub_recommends" data-slot-type="text" data-label="ì¶”ì²œ ì œí’ˆ ë°•ìŠ¤">
                    <div class="slot-default-text"></div>
                </div>
            </a>
        </div>
    </section>

    <!-- â‘¦ Best Pick (ì›ë˜ ì¸ë±ìŠ¤ ìœ„ì¹˜/ëª¨ì–‘ ìœ ì§€) -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 py-10">
        <div class="flex items-center justify-between mb-4">
            <h2 class="text-2xl sm:text-3xl font-bold">Best Pick ê´€ë¦¬</h2>
            <button id="btnBestPickReload"
                class="px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors">
                ìƒˆë¡œê³ ì¹¨
            </button>
        </div>

        <div id="bestPickGrid" class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-4">
            <!-- Best Pick ìŠ¬ë¡¯ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
        </div>
    </section>

    <!-- â‘§ ìš°ë¦¬ë™ë„¤ í•œë§ˆë”” -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 py-6">
        <div class="w-[73%] mx-auto">
            <div id="slot_index_oneword"
                class="neo-card h-28 sm:h-32 rounded-2xl flex flex-col items-center justify-center p-5 shadow-xl border-2 border-blue-400 cursor-pointer js-text-slot"
                data-page="index" data-position="index_oneword" data-slot-type="text" data-label="ìš°ë¦¬ë™ë„¤ í•œë§ˆë””">
                <div class="text-2xl sm:text-3xl font-semibold mb-3 text-blue-600">ğŸ“ ìš°ë¦¬ë™ë„¤ í•œë§ˆë””</div>
                <p id="oneword-content"
                    class="text-2xl sm:text-3xl md:text-4xl font-bold text-gray-800 text-center leading-tight">
                    ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
            </div>
        </div>
    </section>

    <!-- â‘¨ ê¸°ëŠ¥ ì§„ì… ì¹´ë“œë“¤ -->
    <section class="max-w-7xl mx-auto px-4 sm:px-6 py-10 grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div class="grid grid-rows-2 gap-4">
            <a href="foodcategory.html" id="slot_index_food_delivery"
                class="slot-banner rounded-lg overflow-hidden js-slot" data-page="index"
                data-position="index_food_delivery" data-label="í™ë³´ì˜ ë°°ë‹¬ ì§„ì… ì¹´ë“œ">
                <img class="slot-img hidden" alt="í™ë³´ì˜ ë°°ë‹¬">
                <div class="slot-default bg-gray-200 h-32 sm:h-full hover:bg-gray-300 flex items-center justify-center">
                    <span class="text-lg font-bold text-gray-700">í™ë³´ì˜ ë°°ë‹¬</span>
                </div>
            </a>
            <a href="ncategory2.html" id="slot_index_all_stores" class="slot-banner rounded-lg overflow-hidden js-slot"
                data-page="index" data-position="index_all_stores" data-label="ìš°ë¦¬ë™ë„¤ ëª¨ë“ ê°€ê²Œ ì§„ì… ì¹´ë“œ">
                <img class="slot-img hidden" alt="ìš°ë¦¬ë™ë„¤ ëª¨ë“ ê°€ê²Œ">
                <div class="slot-default bg-gray-200 h-32 sm:h-full hover:bg-gray-300 flex items-center justify-center">
                    <span class="text-lg font-bold text-gray-700">ìš°ë¦¬ë™ë„¤ ëª¨ë“ ê°€ê²Œ</span>
                </div>
            </a>
        </div>
        <div class="lg:col-span-2 grid grid-cols-1 sm:grid-cols-2 gap-4">
            <a href="hot.html" id="slot_index_hot_place" class="slot-banner rounded-lg overflow-hidden js-slot"
                data-page="index" data-position="index_hot_place" data-label="ê°€ì¥ HOTí•œ ìš°ë¦¬ë™ë„¤">
                <img class="slot-img hidden" alt="ê°€ì¥ HOTí•œ ìš°ë¦¬ë™ë„¤">
                <div class="slot-default bg-gray-200 aspect-[4/3] flex items-center justify-center hover:bg-gray-300">
                    <span class="text-lg font-bold text-gray-700">ê°€ì¥ HOTí•œ ìš°ë¦¬ë™ë„¤</span>
                </div>
            </a>
            <a href="suggest.html" id="slot_index_suggest" class="slot-banner rounded-lg overflow-hidden js-slot"
                data-page="index" data-position="index_suggest" data-label="í™ë³´ì˜ ì¶”ì²œ">
                <img class="slot-img hidden" alt="í™ë³´ì˜ ì¶”ì²œ">
                <div class="slot-default bg-gray-200 aspect-[4/3] flex items-center justify-center hover:bg-gray-300">
                    <span class="text-lg font-bold text-gray-700">í™ë³´ì˜ ì¶”ì²œ</span>
                </div>
            </a>
            <a href="open.html" id="slot_index_open" class="slot-banner rounded-lg overflow-hidden js-slot"
                data-page="index" data-position="index_open" data-label="ì˜¤í”ˆ ì˜ˆì •">
                <img class="slot-img hidden" alt="ì˜¤í”ˆ ì˜ˆì •">
                <div class="slot-default bg-gray-200 aspect-[4/3] flex items-center justify-center hover:bg-gray-300">
                    <span class="text-lg font-bold text-gray-700">ì˜¤í”ˆ ì˜ˆì •</span>
                </div>
            </a>
            <a href="storepride.html" id="slot_index_store_pride" class="slot-banner rounded-lg overflow-hidden js-slot"
                data-page="index" data-position="index_store_pride" data-label="ê°€ê²Œìë‘">
                <img class="slot-img hidden" alt="ê°€ê²Œìë‘">
                <div class="slot-default bg-gray-200 aspect-[4/3] flex items-center justify-center hover:bg-gray-300">
                    <span class="text-lg font-bold text-gray-700">ê°€ê²Œìë‘</span>
                </div>
            </a>
            <a href="traditionalmarket.html" id="slot_index_traditional"
                class="slot-banner rounded-lg overflow-hidden js-slot" data-page="index"
                data-position="index_traditional" data-label="ì „í†µì‹œì¥">
                <img class="slot-img hidden" alt="ì „í†µì‹œì¥">
                <div class="slot-default bg-gray-200 aspect-[4/3] flex items-center justify-center hover:bg-gray-300">
                    <span class="text-lg font-bold text-gray-700">ì „í†µì‹œì¥</span>
                </div>
            </a>
            <a href="performingart.html" id="slot_index_performing"
                class="slot-banner rounded-lg overflow-hidden js-slot" data-page="index"
                data-position="index_performing" data-label="ê³µì—°/ì˜ˆìˆ , ì¶•ì œ">
                <img class="slot-img hidden" alt="ê³µì—°/ì˜ˆìˆ , ì¶•ì œ">
                <div
                    class="slot-default bg-gray-200 aspect-[4/3] font-bold flex items-center justify-center hover:bg-gray-300">
                    <span class="text-lg font-bold text-gray-700">ê³µì—°/ì˜ˆìˆ , ì¶•ì œ</span>
                </div>
            </a>
        </div>
    </section>

    <!-- â‘® ê³ ê°ì§€ì› ë°•ìŠ¤ -->
    <section
        class="max-w-7xl mx-auto px-4 sm:px-6 py-10 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 text-center">
        <a href="review.html" id="slot_index_support_review" class="slot-banner rounded-lg overflow-hidden js-slot"
            data-page="index" data-position="index_support_review" data-label="ë¦¬ë·°/í›„ê¸° ë°•ìŠ¤">
            <img class="slot-img hidden" alt="ë¦¬ë·°/í›„ê¸°">
            <div
                class="slot-default bg-gray-200 min-h-28 sm:min-h-40 flex items-center justify-center hover:bg-gray-300">
                <span class="text-lg font-bold text-gray-700">ë¦¬ë·°/í›„ê¸°</span>
            </div>
        </a>
        <div id="slot_index_support_empty" class="slot-banner rounded-lg overflow-hidden js-slot cursor-pointer"
            data-page="index" data-position="index_support_empty" data-label="ì¤‘ì•™ ë°•ìŠ¤">
            <img class="slot-img hidden" alt="ì¤‘ì•™ ë°•ìŠ¤">
            <div
                class="slot-default bg-gray-200 min-h-28 sm:min-h-40 flex items-center justify-center hover:bg-gray-300">
                <span class="text-sm text-gray-500">í´ë¦­í•˜ì—¬ ì„¤ì •</span>
            </div>
        </div>
        <a href="inquiryBoard.html" id="slot_index_support_inquiry"
            class="slot-banner rounded-lg overflow-hidden js-slot" data-page="index"
            data-position="index_support_inquiry" data-label="ë¬¸ì˜ê²Œì‹œíŒ ë°•ìŠ¤">
            <img class="slot-img hidden" alt="ë¬¸ì˜ê²Œì‹œíŒ">
            <div
                class="slot-default bg-gray-200 min-h-28 sm:min-h-40 hover:bg-gray-300 flex flex-col items-center justify-center p-3">
                <h4 class="font-bold text-base text-gray-700">ë¬¸ì˜ê²Œì‹œíŒ (Q&A)</h4>
                <p class="text-xs text-gray-600 mt-1 text-center">ê¶ê¸ˆí•œ ì ì„ ë‚¨ê²¨ì£¼ì„¸ìš”</p>
            </div>
        </a>
    </section>

    <!-- D2C ì˜ì—­ -->
    <div id="slot_index_d2c_banner" class="hidden js-slot" data-page="index" data-position="index_d2c_banner"
        data-label="D2C ìƒë‹¨ ë°°ë„ˆ"></div>
    <div id="slot_index_d2c_shop" class="hidden js-slot" data-page="index" data-position="index_d2c_shop"
        data-label="D2C ì‡¼í•‘ ë°•ìŠ¤"></div>

    <!-- í‘¸í„° -->
    <div id="footer-placeholder"></div>

    <!-- ì˜¤ë¥¸ìª½ í•˜ë‹¨ ë„¤ë¹„ -->
    <div class="fixed bottom-6 right-6 flex flex-col items-center gap-4 z-50">
        <div class="flex flex-col items-center">
            <button onclick="goBack()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow">â†</button>
            <span class="text-xs mt-1">ì´ì „</span>
        </div>
        <div class="flex flex-col items-center">
            <button onclick="goNext()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow">â†’</button>
            <span class="text-xs mt-1">ë‹¤ìŒ</span>
        </div>
        <div class="flex flex-col items-center">
            <a href="/index.html"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow">ğŸ </a>
            <span class="text-xs mt-1">í™ˆ</span>
        </div>
    </div>

    <!-- ======================== -->
    <!-- ğŸ› ê´‘ê³ /ì´ë¯¸ì§€/í…ìŠ¤íŠ¸ ë“±ë¡ ëª¨ë‹¬ -->
    <!-- ======================== -->
    <div id="adModal" class="fixed inset-0 bg-black/40 modal-bg hidden justify-center items-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl max-w-lg w-full border border-slate-200
              flex flex-col max-h-[85vh] overflow-hidden">

            <!-- í—¤ë” -->
            <h2 id="modalTitle" class="text-lg font-bold shrink-0 px-6 md:px-7 pt-6 md:pt-7 pb-4">
                ìŠ¬ë¡¯ ì„¤ì •
            </h2>

            <!-- í¼ ì „ì²´: ì„¸ë¡œ í”Œë ‰ìŠ¤ + ë‚´ë¶€ ìŠ¤í¬ë¡¤ ì˜ì—­ ë¶„ë¦¬ -->
            <form id="adForm" class="flex-1 flex flex-col min-h-0">

                <!-- âœ… ìŠ¤í¬ë¡¤ ì˜ì—­: ë‚´ìš©ì´ ê¸¸ì–´ì ¸ë„ ì´ ì˜ì—­ë§Œ ìŠ¤í¬ë¡¤ -->
                <div class="grow min-h-0 overflow-y-auto px-6 md:px-7 space-y-4 pb-24">

                    <div class="text-xs text-slate-600 bg-slate-50 border border-slate-100 rounded-lg p-3"
                        id="slotInfo">
                        ì„ íƒëœ ìŠ¬ë¡¯ ì •ë³´ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.
                    </div>

                    <!-- ì…ë ¥ ë°©ì‹ ì„ íƒ -->
                    <div>
                        <label class="block font-semibold mb-1 text-sm">ì…ë ¥ ë°©ì‹ ì„ íƒ</label>
                        <div class="flex flex-col gap-1 text-xs sm:flex-row sm:items-center sm:gap-4">
                            <label class="inline-flex items-center gap-1">
                                <input type="radio" name="adMode" id="modeCustom" value="custom" class="text-blue-600"
                                    checked>
                                <span>ì´ë¯¸ì§€ + ë§í¬ ì§ì ‘ ì…ë ¥</span>
                            </label>
                            <label class="inline-flex items-center gap-1">
                                <input type="radio" name="adMode" id="modeStore" value="store" class="text-blue-600">
                                <span>ë“±ë¡ëœ ê°€ê²Œë¡œ ì—°ê²° (ì‚¬ì—…ìë²ˆí˜¸ + ìƒí˜¸)</span>
                            </label>
                        </div>
                        <p class="text-[11px] text-slate-400 mt-1">
                            ë©”ì¸ ì¸ë±ìŠ¤ì˜ ë°°ë„ˆëŠ” <span class="font-semibold">'ì´ë¯¸ì§€ + ë§í¬'</span>,
                            ê°€ê²Œ ê´‘ê³  ìŠ¬ë¡¯ì€ <span class="font-semibold">'ë“±ë¡ëœ ê°€ê²Œ'</span>ë¥¼ ì„ íƒí•˜ì„¸ìš”.
                        </p>
                    </div>

                    <!-- âœ… ë“±ë¡ëœ ê°€ê²Œë¡œ ì—°ê²°: ê²°ê³¼ ìŠ¤í¬ë¡¤ + ì—¬ë°± -->
                    <div id="storeModeFields" class="space-y-2 hidden">
                        <div>
                            <label for="businessNoInput" class="block font-semibold mb-1 text-sm">ì‚¬ì—…ì ë“±ë¡ë²ˆí˜¸</label>
                            <input id="businessNoInput" type="text"
                                class="w-full border border-slate-300 p-2 rounded-lg text-sm"
                                placeholder="ì˜ˆ) 123-45-67890">
                        </div>

                        <!-- âœ… ê²°ê³¼ ë¦¬ìŠ¤íŠ¸: ë†’ì´ ì œí•œ + ë‚´ë¶€ ìŠ¤í¬ë¡¤ -->
                        <div id="bizSearchResult" class="hidden border border-slate-200 rounded-lg p-2 bg-white space-y-1
                      max-h-48 overflow-y-auto"></div>

                        <div>
                            <label for="businessNameInput" class="block font-semibold mb-1 text-sm">ìƒí˜¸ëª…</label>
                            <input id="businessNameInput" type="text"
                                class="w-full border border-slate-300 p-2 rounded-lg text-sm" placeholder="ì˜ˆ) í™ê¸¸ë™ì‹ë‹¹">
                        </div>

                        <p class="text-[11px] text-slate-400">
                            âœ… ì‚¬ì—…ìë²ˆí˜¸ ì…ë ¥ ì‹œ, ì¼ì¹˜ ê°€ê²Œê°€ ìˆìœ¼ë©´ ìƒí˜¸ í›„ë³´ê°€ í‘œì‹œë˜ê³  í´ë¦­í•˜ë©´ ìë™ ì…ë ¥ë©ë‹ˆë‹¤.
                        </p>
                    </div>

                    <!-- ì´ë¯¸ì§€ + ë§í¬ ì§ì ‘ ì…ë ¥ -->
                    <div id="customModeFields" class="space-y-3">
                        <div>
                            <label class="block font-semibold mb-1 text-sm">ì´ë¯¸ì§€ íŒŒì¼ (ì„ íƒ)</label>
                            <input id="imageInput" type="file"
                                class="w-full border border-slate-300 p-2 rounded-lg text-sm" accept="image/*">
                            <p class="text-[11px] text-slate-400 mt-1">ë°°ë„ˆ/ì¹´ë“œì— ë“¤ì–´ê°ˆ ì´ë¯¸ì§€ë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>
                        </div>

                        <div>
                            <label class="block font-semibold mb-1 text-sm">í´ë¦­ ì‹œ ì´ë™ ë§í¬ (ì„ íƒ)</label>
                            <input id="linkInput" type="text"
                                placeholder="https://www.hongbono1.com/ndetail.html?id=1&type=food"
                                class="w-full border border-slate-300 p-2 rounded-lg text-sm">
                            <p class="text-[11px] text-slate-400 mt-1">ë¹„ì›Œë‘ë©´ ë§í¬ ì—†ì´ ì´ë¯¸ì§€/ë°°ë„ˆë§Œ í‘œì‹œë©ë‹ˆë‹¤.</p>
                        </div>
                    </div>

                    <!-- âœ… ê´‘ê³  ê¸°ê°„ (ëˆ„ë½ë¶„ ë³´ê°•) -->
                    <div class="mt-2 border-t border-slate-100 pt-3">
                        <label class="block font-semibold mb-2 text-sm">ê´‘ê³  ê¸°ê°„</label>

                        <div class="grid grid-cols-1 sm:grid-cols-2 gap-3 text-sm">
                            <!-- ì‹œì‘ -->
                            <div>
                                <div class="text-xs text-slate-500 mb-1">ì‹œì‘</div>
                                <div class="flex gap-2">
                                    <input id="startDateInput" type="date"
                                        class="w-full border border-slate-300 p-2 rounded-lg" />
                                    <input id="startTimeInput" type="time"
                                        class="w-full border border-slate-300 p-2 rounded-lg" />
                                </div>
                            </div>

                            <!-- ì¢…ë£Œ -->
                            <div>
                                <div class="flex items-center justify-between mb-1">
                                    <span class="text-xs text-slate-500">ì¢…ë£Œ</span>
                                    <label class="inline-flex items-center gap-2 text-xs">
                                        <input id="noEndCheckbox" type="checkbox" class="accent-blue-600" />
                                        <span>ì¢…ë£Œ ì—†ìŒ</span>
                                    </label>
                                </div>
                                <div class="flex gap-2">
                                    <input id="endDateInput" type="date"
                                        class="w-full border border-slate-300 p-2 rounded-lg" />
                                    <input id="endTimeInput" type="time"
                                        class="w-full border border-slate-300 p-2 rounded-lg" />
                                </div>
                            </div>
                        </div>
                    </div>

                    <input type="hidden" id="selectedPage">
                    <input type="hidden" id="selectedPosition">
                </div>

                <!-- âœ… í•˜ë‹¨ ë²„íŠ¼ ë°”: sticky ë¡œ í•­ìƒ ë³´ì´ê²Œ -->
                <div class="shrink-0 sticky bottom-0 left-0 right-0
                  px-6 md:px-7 pt-3 pb-3 bg-white/95 backdrop-blur border-t">
                    <div class="flex justify-end gap-3">
                        <button type="button" id="closeModal"
                            class="px-4 py-2 border border-slate-300 rounded-lg text-sm text-slate-600 hover:bg-slate-50">
                            ì·¨ì†Œ
                        </button>
                        <button type="button" id="saveAdBtn"
                            class="px-4 py-2 bg-blue-600 text-white rounded-lg shadow text-sm hover:bg-blue-700">
                            ì €ì¥
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>


    <!-- ======================== -->
    <!-- ğŸŸ¢ í…ìŠ¤íŠ¸ ì…ë ¥ ì „ìš© ëª¨ë‹¬ -->
    <!-- ======================== -->
    <div id="textModal" class="fixed inset-0 bg-black/40 modal-bg hidden justify-center items-center p-4 z-50">
        <div class="bg-white rounded-2xl shadow-2xl p-6 md:p-7 max-w-lg w-full border border-slate-200">
            <h2 id="textModalTitle" class="text-lg font-bold mb-3">
                í…ìŠ¤íŠ¸ ì„¤ì •
            </h2>

            <form id="textForm" class="space-y-3">
                <div class="text-xs text-slate-600 bg-slate-50 border border-slate-100 rounded-lg p-3"
                    id="textSlotInfo">
                    ì¸ë±ìŠ¤ í˜ì´ì§€ì˜ <span class="font-semibold">í…ìŠ¤íŠ¸ ìŠ¬ë¡¯</span> ë‚´ìš©ì„ ì„¤ì •í•©ë‹ˆë‹¤.
                </div>

                <div>
                    <label class="block font-semibold mb-1 text-sm">í‘œì‹œí•  í…ìŠ¤íŠ¸</label>
                    <textarea id="textContentInput"
                        class="w-full border border-slate-300 rounded-lg p-2 text-sm min-h-[120px]"
                        placeholder="í•œ ì¤„ì— í•˜ë‚˜ì”© ì…ë ¥í•˜ë©´ ìë™ìœ¼ë¡œ ë¦¬ìŠ¤íŠ¸ë¡œ í‘œì‹œë©ë‹ˆë‹¤."></textarea>
                    <p class="text-[11px] text-slate-400 mt-1">
                        âœ… ê²€ìƒ‰ì–´/ìµœì‹ ì†Œì‹/ì´ë²¤íŠ¸/ì¶”ì²œì œí’ˆ ë°•ìŠ¤ëŠ” <b>í•œ ì¤„ = í•œ í•­ëª©</b> ë°©ì‹ìœ¼ë¡œ ì…ë ¥í•˜ì„¸ìš”.
                    </p>
                </div>

                <input type="hidden" id="textSelectedPage">
                <input type="hidden" id="textSelectedPosition">

                <div class="flex justify-end gap-3 pt-2">
                    <button type="button" id="closeTextModal"
                        class="px-4 py-2 border border-slate-300 rounded-lg text-sm text-slate-600 hover:bg-slate-50">
                        ì·¨ì†Œ
                    </button>
                    <button type="button" id="saveTextBtn"
                        class="px-4 py-2 bg-emerald-600 text-white rounded-lg shadow text-sm hover:bg-emerald-700">
                        ì €ì¥
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // ============================
        // ê¸°ë³¸ í…ìŠ¤íŠ¸ ë”ë¯¸ ë°ì´í„°
        // ============================
        const DEFAULT_DATA = {
            keywords: ["ê²€ìƒ‰ì–´1", "ê²€ìƒ‰ì–´2", "ê²€ìƒ‰ì–´3", "ê²€ìƒ‰ì–´4", "ê²€ìƒ‰ì–´5"],
            news: ["ì‹ ì œí’ˆ ì¶œì‹œ", "ì—…ë°ì´íŠ¸ ì†Œì‹", "ê³µì§€ì‚¬í•­", "ì ê²€ ì•ˆë‚´", "ì„œë¹„ìŠ¤ ê°œì„ "],
            events: ["ë´„ë§ì´ ì„¸ì¼", "íšŒì› ì „ìš© ì¿ í°", "í¬ì¸íŠ¸ 2ë°° ì ë¦½", "ì‹ ê·œ ê°€ì… ì´ë²¤íŠ¸", "ë¦¬ë·° ì‘ì„± ì´ë²¤íŠ¸"],
            recommends: ["ì¶”ì²œ ìƒí’ˆ A", "ì¶”ì²œ ìƒí’ˆ B", "ì¶”ì²œ ìƒí’ˆ C", "ì¶”ì²œ ìƒí’ˆ D", "ì¶”ì²œ ìƒí’ˆ E"]
        };

        function renderDefaultList(container, items) {
            const textEl = container.querySelector(".slot-default-text") || container;
            textEl.innerHTML = items
                .map(t => `<p class="text-xl leading-relaxed tracking-wide">${t}</p>`)
                .join("");
        }

        // ============================
        // âœ… ë¦¬ìŠ¤íŠ¸í˜• í…ìŠ¤íŠ¸ ìŠ¬ë¡¯ ì •ì˜
        // ============================
        const LIST_TEXT_POSITIONS = new Set([
            "index_sub_keywords",
            "index_sub_news",
            "index_sub_events",
            "index_sub_recommends",
        ]);

        function isListTextPosition(position) {
            return LIST_TEXT_POSITIONS.has(position);
        }

        function escapeHtml(str = "") {
            return String(str)
                .replaceAll("&", "&amp;")
                .replaceAll("<", "&lt;")
                .replaceAll(">", "&gt;")
                .replaceAll('"', "&quot;")
                .replaceAll("'", "&#39;");
        }

        function formatListHTMLFromRaw(raw = "") {
            const lines = String(raw)
                .split(/\r?\n/)
                .map(l => l.trim())
                .filter(Boolean);

            if (lines.length === 0) return "";
            return lines
                .map(t => `<p class="text-xl leading-relaxed tracking-wide">${escapeHtml(t)}</p>`)
                .join("");
        }

        function extractListTextFromSlot(slotEl) {
            if (!slotEl) return "";
            const textRoot = slotEl.querySelector(".slot-default-text") || slotEl;
            const ps = textRoot.querySelectorAll("p");
            const lines = Array.from(ps)
                .map(p => (p.innerText || "").trim())
                .filter(Boolean);
            return lines.join("\n");
        }

        // ============================
        // âœ… ê²€ìƒ‰ ê²°ê³¼ ë°•ìŠ¤ ê°„ë‹¨ ì œì–´(ì´ˆê¸°í™”ìš©)
        // ============================
        function showBizResultBox(html = "") {
            const box = document.getElementById("bizSearchResult");
            if (!box) return;
            box.innerHTML = html;
            if (html) box.classList.remove("hidden");
            else box.classList.add("hidden");
        }

        // ============================
        // âœ… ì—…ë¡œë“œ/ì €ì¥ ì§í›„ DOM ì¦‰ì‹œ ë°˜ì˜ ìœ í‹¸
        // ============================
        function getSlotContainerByPosition(position) {
            if (!position) return null;

            const byId = document.getElementById(`slot_${position}`);
            if (byId) return byId;

            return document.querySelector(`.js-slot[data-position="${position}"]`);
        }

        function applyBannerSlotToDom(slot) {
            if (!slot) return;

            const position = slot.position;
            const imageUrl = slot.image_url || slot.image || "";

            const container = getSlotContainerByPosition(position);
            if (!container) return;

            const img = container.querySelector(".slot-img");
            const defaultEl = container.querySelector(".slot-default");

            if (imageUrl) {
                if (img) {
                    img.src = imageUrl;
                    img.classList.remove("hidden");
                }
                if (defaultEl) defaultEl.classList.add("hidden");
            } else {
                if (img) {
                    img.src = "";
                    img.classList.add("hidden");
                }
                if (defaultEl) defaultEl.classList.remove("hidden");
            }
        }

        // ============================
        // ìŠ¬ë¡¯ ë¡œë“œ (ì´ë¯¸ì§€ ë°°ë„ˆ)
        // ============================
        async function loadBannerSlotById(slotId, page, position) {
            const container = document.getElementById(slotId);
            if (!container) return;

            const img = container.querySelector(".slot-img");
            const defaultEl = container.querySelector(".slot-default");

            try {
                const res = await fetch(
                    `/manager/ad/slot?page=${encodeURIComponent(page)}&position=${encodeURIComponent(position)}`
                );
                if (!res.ok) return;

                const json = await res.json();
                const imageUrl =
                    json?.slot?.image_url ||
                    json?.slot?.image ||
                    "";

                if ((json.ok || json.success) && imageUrl) {
                    if (img) {
                        img.src = imageUrl;
                        img.classList.remove("hidden");
                    }
                    if (defaultEl) defaultEl.classList.add("hidden");
                } else {
                    if (img) img.classList.add("hidden");
                    if (defaultEl) defaultEl.classList.remove("hidden");
                }
            } catch (err) {
                console.error(`ìŠ¬ë¡¯ ë¡œë“œ ì‹¤íŒ¨ [${position}]:`, err);
            }
        }

        // ============================
        // âœ… ìŠ¬ë¡¯ ë¡œë“œ (í…ìŠ¤íŠ¸)
        // ============================
        async function loadTextSlotById(slotId, page, position, fallbackRenderer) {
            const container = document.getElementById(slotId);
            if (!container) return;

            const textBox = container.querySelector(".slot-default-text") || container;

            try {
                const res = await fetch(
                    `/manager/ad/text/get?page=${encodeURIComponent(page)}&position=${encodeURIComponent(position)}`
                );
                if (!res.ok) {
                    if (fallbackRenderer) fallbackRenderer(container);
                    return;
                }

                const data = await res.json();
                const text =
                    data?.slot?.text_content ??
                    data?.slot?.content ??
                    data?.text?.content ??
                    "";

                if (data && data.ok && text) {
                    if (isListTextPosition(position)) {
                        textBox.innerHTML = formatListHTMLFromRaw(text);
                    } else {
                        textBox.innerHTML = text;
                    }
                } else {
                    if (fallbackRenderer) fallbackRenderer(container);
                }
            } catch (err) {
                console.error("í…ìŠ¤íŠ¸ ìŠ¬ë¡¯ ë¡œë“œ ì‹¤íŒ¨:", err);
                if (fallbackRenderer) fallbackRenderer(container);
            }
        }

        // ============================
        // ìš°ë¦¬ë™ë„¤ í•œë§ˆë””
        // ============================
        async function loadOneWord() {
            const contentEl = document.getElementById("oneword-content");
            if (!contentEl) return;

            try {
                const slotRes = await fetch("/manager/ad/text/get?page=index&position=index_oneword");
                if (slotRes.ok) {
                    const slotJson = await slotRes.json();
                    const text =
                        slotJson?.slot?.text_content ??
                        slotJson?.slot?.content ??
                        slotJson?.text?.content ??
                        "";

                    if (slotJson.ok && text) {
                        contentEl.innerHTML = text;
                        return;
                    }
                }

                const userRegion = localStorage.getItem("userRegion") || "ì˜ì •ë¶€";
                const onewordRes = await fetch(`/api/oneword?region=${encodeURIComponent(userRegion)}`);

                if (onewordRes.ok) {
                    const onewordData = await onewordRes.json();
                    let displayMessage = onewordData.message;

                    if (onewordData.keyword) {
                        displayMessage = displayMessage.replace(
                            `'${onewordData.keyword}'`,
                            `<span class="text-orange-500">'${onewordData.keyword}'</span>`
                        );
                    }
                    contentEl.innerHTML = displayMessage;
                } else {
                    contentEl.textContent = "ìš°ë¦¬ë™ë„¤ê°€ ì˜¤ëŠ˜ì€ ì°¨ë¶„í•œ í•˜ë£¨ë„¤ìš” ğŸ™‚";
                }

            } catch (err) {
                console.error("ìš°ë¦¬ë™ë„¤ í•œë§ˆë”” ë¡œë“œ ì‹¤íŒ¨:", err);
                contentEl.textContent = "ìš°ë¦¬ë™ë„¤ê°€ ì˜¤ëŠ˜ì€ ì°¨ë¶„í•œ í•˜ë£¨ë„¤ìš” ğŸ™‚";
            }
        }

        // ============================
        // âœ… Best Pick ìŠ¬ë¡¯ (ì›ë˜ ìœ„ì¹˜ìš©)
        // ============================
        const BEST_PICK_MAX = 18;

        function bestPickSlotId(n) {
            return `slot_best_pick_${n}`;
        }

        function bestPickPosition(n) {
            return `best_pick_${n}`;
        }

        // âœ… (ëˆ„ë½ ë³´ê°•) Best Pick ì¹´ë“œ ë‚´ë¶€ì— í”„ë¦¬ë·° êµ¬ì¡° ì¶”ê°€
        function renderBestPickGridInline() {
            const container = document.getElementById("bestPickGrid");
            if (!container) return;

            container.innerHTML = "";

            for (let i = 1; i <= BEST_PICK_MAX; i++) {
                const slotId = bestPickSlotId(i);
                const position = bestPickPosition(i);

                const card = document.createElement("div");
                card.className = "neo-card p-3 cursor-pointer js-slot";
                card.id = slotId;
                card.setAttribute("data-page", "index");
                card.setAttribute("data-position", position);
                card.setAttribute("data-label", `Best Pick ${i}`);

                card.innerHTML = `
                    <div class="slot-banner rounded-lg overflow-hidden">
                        <img class="slot-img hidden w-full h-24 object-cover" alt="Best Pick ${i}">
                        <div class="slot-default flex flex-col items-center justify-center h-24 bg-gray-100">
                            <div class="w-12 h-12 rounded-full bg-white border border-slate-200 flex items-center justify-center shadow">
                                <span class="text-xs text-gray-500">${i}</span>
                            </div>
                            <p class="text-[11px] text-gray-500 mt-1">í´ë¦­í•˜ì—¬ ë“±ë¡</p>
                        </div>
                    </div>
                    <p class="text-xs font-medium mt-2 text-center">Best Pick ${i}</p>
                `;

                container.appendChild(card);
            }
        }

        async function loadBestPickInlineSlots() {
            for (let i = 1; i <= BEST_PICK_MAX; i++) {
                const slotId = bestPickSlotId(i);
                const position = bestPickPosition(i);
                await loadBannerSlotById(slotId, "index", position);
            }
        }

        // ============================
        // ê´‘ê³  ê¸°ê°„ ìˆ˜ì§‘/ê²€ì¦
        // ============================
        function collectAdPeriod() {
            const startDate = (document.getElementById("startDateInput")?.value || "").trim();
            const startTime = (document.getElementById("startTimeInput")?.value || "").trim();
            const endDate = (document.getElementById("endDateInput")?.value || "").trim();
            const endTime = (document.getElementById("endTimeInput")?.value || "").trim();
            const noEnd = !!document.getElementById("noEndCheckbox")?.checked;

            if ((startDate && !startTime) || (!startDate && startTime)) {
                alert("ê´‘ê³  ì‹œì‘ ì‹œì ì€ ë‚ ì§œì™€ ì‹œê°„ì„ í•¨ê»˜ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return null;
            }

            if (!noEnd && ((endDate && !endTime) || (!endDate && endTime))) {
                alert("ê´‘ê³  ì¢…ë£Œ ì‹œì ì€ ë‚ ì§œì™€ ì‹œê°„ì„ í•¨ê»˜ ì…ë ¥í•˜ê±°ë‚˜, 'ì¢…ë£Œ ì—†ìŒ'ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
                return null;
            }

            return {
                startDate,
                startTime,
                endDate: noEnd ? "" : endDate,
                endTime: noEnd ? "" : endTime,
                noEnd
            };
        }

        function resetAdPeriodFields() {
            const sD = document.getElementById("startDateInput");
            const sT = document.getElementById("startTimeInput");
            const eD = document.getElementById("endDateInput");
            const eT = document.getElementById("endTimeInput");
            const noE = document.getElementById("noEndCheckbox");

            if (sD) sD.value = "";
            if (sT) sT.value = "";
            if (eD) eD.value = "";
            if (eT) eT.value = "";
            if (noE) noE.checked = false;

            if (eD) eD.disabled = false;
            if (eT) eT.disabled = false;
        }

        function setupNoEndToggle() {
            const noEnd = document.getElementById("noEndCheckbox");
            const endDate = document.getElementById("endDateInput");
            const endTime = document.getElementById("endTimeInput");
            if (!noEnd || !endDate || !endTime) return;

            noEnd.addEventListener("change", () => {
                if (noEnd.checked) {
                    endDate.value = "";
                    endTime.value = "";
                    endDate.disabled = true;
                    endTime.disabled = true;
                } else {
                    endDate.disabled = false;
                    endTime.disabled = false;
                }
            });
        }

        // ============================
        // âœ… ì‚¬ì—…ìë²ˆí˜¸ ê¸°ë°˜ ìƒí˜¸ ìë™ í›„ë³´ UI
        // ============================
        function normalizeBizNoDigits(v = "") {
            return String(v).replace(/[^\d]/g, "").trim(); // ìˆ«ìë§Œ
        }

        function formatBizNoPretty(digits = "") {
            const s = String(digits);
            if (s.length === 10) {
                return `${s.slice(0, 3)}-${s.slice(3, 5)}-${s.slice(5)}`;
            }
            return s;
        }

        function debounce(fn, wait = 250) {
            let t;
            return (...args) => {
                clearTimeout(t);
                t = setTimeout(() => fn(...args), wait);
            };
        }

        async function fetchStoresByBizNo(bizNoDigits) {
            const url = `/manager/ad/store/search?bizNo=${encodeURIComponent(bizNoDigits)}`;

            const res = await fetch(url);
            if (!res.ok) {
                return { ok: false, stores: [], status: res.status };
            }

            const data = await res.json();
            const stores = data?.stores || data?.items || data?.rows || data?.data || [];
            return { ok: !!(data?.ok || data?.success), stores };
        }

        function renderBizSearchResult({ bizNoDigits, payload }) {
            const resultBox = document.getElementById("bizSearchResult");
            const nameInput = document.getElementById("businessNameInput");
            const bizInput = document.getElementById("businessNoInput");

            if (!resultBox) return;

            resultBox.innerHTML = "";

            if (!bizNoDigits || bizNoDigits.length < 5) {
                resultBox.classList.add("hidden");
                return;
            }

            if (payload && payload.ok === false && payload.status === 404) {
                resultBox.classList.remove("hidden");
                resultBox.innerHTML = `
                    <div class="text-xs text-slate-500">
                        ğŸ” ê²€ìƒ‰ APIê°€ ì•„ì§ ì—°ê²°ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.<br>
                        <b>/manager/ad/store/search</b> ì—°ê²° í›„ ìë™ì™„ì„±ë©ë‹ˆë‹¤.
                    </div>`;
                return;
            }

            const stores = payload?.stores || [];
            if (!payload?.ok || !Array.isArray(stores) || stores.length === 0) {
                resultBox.classList.remove("hidden");
                resultBox.innerHTML = `<div class="text-xs text-slate-500">âŒ ì¼ì¹˜í•˜ëŠ” ê°€ê²Œê°€ ì—†ìŠµë‹ˆë‹¤.</div>`;
                return;
            }

            resultBox.classList.remove("hidden");

            stores.forEach((s, idx) => {
                const biz =
                    s.business_no || s.business_number || s.biz_number || s.bizNo || "";
                const digits = normalizeBizNoDigits(biz);
                const pretty = digits ? formatBizNoPretty(digits) : "ì‚¬ì—…ìë²ˆí˜¸ ë¯¸í™•ì¸";

                const name =
                    s.business_name || s.store_name || s.name || `ê°€ê²Œ ${idx + 1}`;

                const item = document.createElement("button");
                item.type = "button";
                item.className =
                    "w-full text-left px-2 py-2 rounded-md border border-slate-100 hover:border-blue-200 hover:bg-blue-50 transition text-xs";
                item.innerHTML = `
                    <div class="font-semibold text-slate-800">${escapeHtml(name)}</div>
                    <div class="text-[10px] text-slate-500">${escapeHtml(pretty)}</div>
                `;

                // âœ… í´ë¦­ ì‹œ ê°’ ì±„ìš°ê³ , ê²°ê³¼ë°•ìŠ¤ ë‹«ê¸°
                item.addEventListener("click", () => {
                    if (nameInput) nameInput.value = name;
                    if (bizInput && digits) bizInput.value = formatBizNoPretty(digits);

                    showBizResultBox("");
                    nameInput?.focus();
                });

                resultBox.appendChild(item);
            });
        }

        function setupBizSearchUI() {
            const bizInput = document.getElementById("businessNoInput");
            const resultBox = document.getElementById("bizSearchResult");

            if (!bizInput || !resultBox) return;

            const run = debounce(async () => {
                const digits = normalizeBizNoDigits(bizInput.value);

                if (!digits || digits.length < 5) {
                    resultBox.classList.add("hidden");
                    resultBox.innerHTML = "";
                    return;
                }

                const payload = await fetchStoresByBizNo(digits);
                renderBizSearchResult({ bizNoDigits: digits, payload });
            }, 250);

            bizInput.addEventListener("input", run);
        }

        // ============================
        // âœ… ìŠ¬ë¡¯ í´ë¦­ â†’ ëª¨ë‹¬ ì—´ê¸°
        // ============================
        function setupSlotClick() {
            document.addEventListener("click", (e) => {
                const slotEl = e.target.closest(".js-slot, .js-text-slot");
                if (!slotEl) return;

                const linkParent = slotEl.closest("a[href]");
                if (linkParent) {
                    e.preventDefault();
                    e.stopPropagation();
                }

                const page = slotEl.dataset.page || "index";
                const position = slotEl.dataset.position || "";
                const label = slotEl.dataset.label || position || "ì„ íƒëœ ìŠ¬ë¡¯";
                const slotType =
                    slotEl.dataset.slotType ||
                    (slotEl.classList.contains("js-text-slot") ? "text" : "banner");

                if (slotType === "text") {
                    document.getElementById("textSelectedPage").value = page;
                    document.getElementById("textSelectedPosition").value = position;
                    document.getElementById("textModalTitle").textContent = `í…ìŠ¤íŠ¸ ì„¤ì •: ${label}`;
                    document.getElementById("textSlotInfo").innerHTML =
                        `index í˜ì´ì§€ì˜ <span class="font-semibold">${position}</span> ìŠ¬ë¡¯ì— í‘œì‹œë  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•©ë‹ˆë‹¤.`;

                    let currentText = "";

                    if (position === "index_oneword") {
                        currentText = (document.getElementById("oneword-content")?.innerText || "").trim();
                    } else if (isListTextPosition(position)) {
                        currentText = extractListTextFromSlot(slotEl);
                    } else {
                        const currentTextEl = slotEl.querySelector(".slot-default-text") || slotEl;
                        currentText = (currentTextEl.innerText || "").trim();
                    }

                    document.getElementById("textContentInput").value = currentText;

                    const textModal = document.getElementById("textModal");
                    textModal.classList.remove("hidden");
                    textModal.classList.add("flex");
                } else {
                    document.getElementById("selectedPage").value = page;
                    document.getElementById("selectedPosition").value = position;
                    document.getElementById("modalTitle").textContent = `ìŠ¬ë¡¯ ì„¤ì •: ${label}`;
                    document.getElementById("slotInfo").textContent = `${page} / ${position}`;

                    document.getElementById("imageInput").value = "";
                    document.getElementById("linkInput").value = "";
                    document.getElementById("businessNoInput").value = "";
                    document.getElementById("businessNameInput").value = "";
                    showBizResultBox("");
                    resetAdPeriodFields();

                    const adModal = document.getElementById("adModal");
                    adModal.classList.remove("hidden");
                    adModal.classList.add("flex");
                }
            });
        }

        // ============================
        // ëª¨ë‹¬ ë‹«ê¸°
        // ============================
        function setupModalClose() {
            const adModal = document.getElementById("adModal");
            const closeBtn = document.getElementById("closeModal");
            if (!adModal || !closeBtn) return;

            const resetAll = () => {
                document.getElementById("imageInput").value = "";
                document.getElementById("linkInput").value = "";
                document.getElementById("businessNoInput").value = "";
                document.getElementById("businessNameInput").value = "";
                showBizResultBox("");
                resetAdPeriodFields();
            };

            closeBtn.addEventListener("click", () => {
                adModal.classList.add("hidden");
                adModal.classList.remove("flex");
                resetAll();
            });

            adModal.addEventListener("click", (e) => {
                if (e.target === e.currentTarget) {
                    adModal.classList.add("hidden");
                    adModal.classList.remove("flex");
                    resetAll();
                }
            });
        }

        // ============================
        // í…ìŠ¤íŠ¸ ëª¨ë‹¬ ë‹«ê¸°
        // ============================
        function setupTextModalClose() {
            const textModal = document.getElementById("textModal");
            const closeBtn = document.getElementById("closeTextModal");
            if (!textModal || !closeBtn) return;

            const resetText = () => {
                document.getElementById("textContentInput").value = "";
            };

            closeBtn.addEventListener("click", () => {
                textModal.classList.add("hidden");
                textModal.classList.remove("flex");
                resetText();
            });

            textModal.addEventListener("click", (e) => {
                if (e.target === e.currentTarget) {
                    textModal.classList.add("hidden");
                    textModal.classList.remove("flex");
                    resetText();
                }
            });
        }

        // ============================
        // ì…ë ¥ ëª¨ë“œ í† ê¸€
        // ============================
        function setupModeToggle() {
            const customFields = document.getElementById("customModeFields");
            const storeFields = document.getElementById("storeModeFields");
            const modeCustom = document.getElementById("modeCustom");
            const modeStore = document.getElementById("modeStore");

            if (!customFields || !storeFields || !modeCustom || !modeStore) return;

            const updateVisibility = () => {
                if (modeStore.checked) {
                    storeFields.classList.remove("hidden");
                    customFields.classList.add("hidden");
                } else {
                    customFields.classList.remove("hidden");
                    storeFields.classList.add("hidden");
                }

                showBizResultBox("");
            };

            modeCustom.addEventListener("change", updateVisibility);
            modeStore.addEventListener("change", updateVisibility);
            updateVisibility();
        }

        // ============================
        // ê´‘ê³  ì €ì¥
        // ============================
        function setupSave() {
            const btn = document.getElementById("saveAdBtn");
            if (!btn) return;

            btn.addEventListener("click", async () => {
                const page = document.getElementById("selectedPage").value;
                const position = document.getElementById("selectedPosition").value;
                const modeInput = document.querySelector('input[name="adMode"]:checked');
                const mode = modeInput ? modeInput.value : "custom";

                if (!page || !position) {
                    alert("ìŠ¬ë¡¯ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.");
                    return;
                }

                const period = collectAdPeriod();
                if (!period) return;

                // ----------------
                // ê°€ê²Œ ì—°ê²° ëª¨ë“œ
                // ----------------
                if (mode === "store") {
                    const businessNo = (document.getElementById("businessNoInput").value || "").trim();
                    const businessName = (document.getElementById("businessNameInput").value || "").trim();

                    if (!businessNo || !businessName) {
                        alert("ì‚¬ì—…ìë²ˆí˜¸ì™€ ìƒí˜¸ë¥¼ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                        return;
                    }

                    const body = {
                        page,
                        position,
                        biz_number: businessNo,
                        biz_name: businessName,
                        start_date: period.startDate || null,
                        start_time: period.startTime || null,
                        end_date: period.noEnd ? null : (period.endDate || null),
                        end_time: period.noEnd ? null : (period.endTime || null),
                        no_end: period.noEnd
                    };

                    try {
                        const res = await fetch("/manager/ad/store", {
                            method: "POST",
                            headers: { "Content-Type": "application/json" },
                            body: JSON.stringify(body),
                        });
                        const data = await res.json();

                        if (data.ok) {
                            alert("ê°€ê²Œê°€ ì´ ìŠ¬ë¡¯ì— ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.");

                            const adModal = document.getElementById("adModal");
                            adModal.classList.add("hidden");
                            adModal.classList.remove("flex");

                            document.getElementById("businessNoInput").value = "";
                            document.getElementById("businessNameInput").value = "";
                            showBizResultBox("");
                            resetAdPeriodFields();

                            // âœ… ì„œë²„ê°€ ëŒë ¤ì¤€ slotì„ ì¦‰ì‹œ DOMì— ë°˜ì˜
                            if (data.slot) {
                                applyBannerSlotToDom(data.slot);
                            }

                            if (String(position).startsWith("best_pick_")) {
                                await loadBestPickInlineSlots();
                            } else {
                                await loadBannerSlotById(`slot_${position}`, page, position);
                            }
                        } else {
                            alert("ì˜¤ë¥˜: " + (data.message || "ê°€ê²Œ ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."));
                        }
                    } catch (err) {
                        console.error(err);
                        alert("ê°€ê²Œ ì—°ê²° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                    }
                    return;
                }

                // ----------------
                // ì´ë¯¸ì§€+ë§í¬ ëª¨ë“œ
                // ----------------
                const imageFile = document.getElementById("imageInput").files[0];
                const link = (document.getElementById("linkInput").value || "").trim();

                if (!imageFile && !link && !period.startDate && !period.endDate && !period.noEnd) {
                    const ok = confirm(
                        "ì´ë¯¸ì§€, ë§í¬, ê¸°ê°„ ì •ë³´ê°€ ëª¨ë‘ ë¹„ì–´ ìˆìŠµë‹ˆë‹¤.\nê·¸ë˜ë„ ì´ ìŠ¬ë¡¯ ì •ë³´ë§Œ ì €ì¥í•˜ì‹œê² ìŠµë‹ˆê¹Œ?"
                    );
                    if (!ok) return;
                }

                const formData = new FormData();
                formData.append("page", page);
                formData.append("position", position);
                formData.append("link_url", link);

                if (period.startDate) formData.append("start_date", period.startDate);
                if (period.startTime) formData.append("start_time", period.startTime);

                if (period.noEnd) {
                    formData.append("no_end", "true");
                } else {
                    if (period.endDate) formData.append("end_date", period.endDate);
                    if (period.endTime) formData.append("end_time", period.endTime);
                }

                if (imageFile) {
                    formData.append("image", imageFile);
                }

                try {
                    const res = await fetch("/manager/ad/upload", {
                        method: "POST",
                        body: formData
                    });

                    const data = await res.json();

                    if (data.ok) {
                        // âœ… ì„œë²„ê°€ ì¤€ slotì„ ì¦‰ì‹œ í™”ë©´ì— ë°˜ì˜
                        if (data.slot) {
                            applyBannerSlotToDom(data.slot);
                        } else {
                            await loadBannerSlotById(`slot_${position}`, page, position);
                        }

                        alert("ì €ì¥ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.");

                        const adModal = document.getElementById("adModal");
                        adModal.classList.add("hidden");
                        adModal.classList.remove("flex");

                        document.getElementById("imageInput").value = "";
                        document.getElementById("linkInput").value = "";
                        resetAdPeriodFields();

                        if (String(position).startsWith("best_pick_")) {
                            await loadBestPickInlineSlots();
                        }
                    } else {
                        alert("ì˜¤ë¥˜: " + (data.message || "ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."));
                    }
                } catch (err) {
                    console.error(err);
                    alert("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                }
            });
        }

        // ============================
        // âœ… í…ìŠ¤íŠ¸ ì €ì¥
        // ============================
        function setupSaveText() {
            const btn = document.getElementById("saveTextBtn");
            if (!btn) return;

            btn.addEventListener("click", async () => {
                const page = document.getElementById("textSelectedPage").value || "index";
                const position = document.getElementById("textSelectedPosition").value;
                const content = document.getElementById("textContentInput").value.trim();

                if (!page || !position) {
                    alert("ìŠ¬ë¡¯ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì„ íƒí•´ì£¼ì„¸ìš”.");
                    return;
                }
                if (!content) {
                    alert("í‘œì‹œí•  í…ìŠ¤íŠ¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                    return;
                }

                const body = { page, position, content };

                try {
                    const res = await fetch("/manager/ad/text/save", {
                        method: "POST",
                        headers: { "Content-Type": "application/json" },
                        body: JSON.stringify(body),
                    });

                    if (!res.ok) {
                        alert("í…ìŠ¤íŠ¸ ì €ì¥ APIë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤. ì„œë²„ ë¼ìš°í„°ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”.");
                        return;
                    }

                    const data = await res.json();

                    if (data.ok) {
                        alert("í…ìŠ¤íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.");

                        const textModal = document.getElementById("textModal");
                        textModal.classList.add("hidden");
                        textModal.classList.remove("flex");

                        if (position === "index_oneword") {
                            const ow = document.getElementById("oneword-content");
                            if (ow) ow.innerHTML = content;
                            return;
                        }

                        const slotEl = document.querySelector(
                            `.js-text-slot[data-page="${page}"][data-position="${position}"]`
                        );

                        if (slotEl) {
                            const target = slotEl.querySelector(".slot-default-text") || slotEl;

                            if (isListTextPosition(position)) {
                                target.innerHTML = formatListHTMLFromRaw(content);
                            } else {
                                target.innerHTML = content;
                            }
                        }
                    } else {
                        alert("ì˜¤ë¥˜: " + (data.message || "ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤."));
                    }
                } catch (err) {
                    console.error(err);
                    alert("ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
                }
            });
        }

        // ============================
        // ë„¤ë¹„ê²Œì´ì…˜ ë²„íŠ¼ (onclick ìš©)
        // ============================
        function goBack() { window.history.back(); }
        function goNext() { window.history.forward(); }

        // ============================
        // Best Pick ê´€ë¦¬ì ìƒˆë¡œê³ ì¹¨ ë²„íŠ¼
        // ============================
        function setupBestPickReloadBtn() {
            document.getElementById("btnBestPickReload")?.addEventListener("click", async () => {
                await loadBestPickInlineSlots();
            });
        }

        // ============================
        // ì´ˆê¸°í™”
        // ============================
        document.addEventListener("DOMContentLoaded", async () => {
            // í—¤ë”/í‘¸í„° ë¡œë“œ
            // (ì„œë²„ ì •ì  ë£¨íŠ¸ ì„¤ì •ì— ë”°ë¼ URLì€ /components ë¡œ ìœ ì§€)
            fetch("/components/header.html")
                .then(r => r.text())
                .then(d => {
                    const hp = document.getElementById("header-placeholder");
                    if (hp) hp.innerHTML = d;
                });

            fetch("/components/footer.html")
                .then(r => r.text())
                .then(d => {
                    const fp = document.getElementById("footer-placeholder");
                    if (fp) fp.innerHTML = d;
                });

            // ëª¨ë“  ìŠ¬ë¡¯ ì„¤ì •
            setupSlotClick();
            setupModalClose();
            setupTextModalClose();
            setupModeToggle();
            setupSave();
            setupSaveText();
            setupNoEndToggle();

            // âœ… ì‚¬ì—…ìë²ˆí˜¸ ê²€ìƒ‰ ì´ë²¤íŠ¸ ì—°ê²°
            setupBizSearchUI();

            // Best Pick ê·¸ë¦¬ë“œ ë Œë”ë§ ë° ë¡œë“œ
            renderBestPickGridInline();
            await loadBestPickInlineSlots();

            // Best Pick ë¦¬ë¡œë“œ ë²„íŠ¼
            setupBestPickReloadBtn();

            // ê¸°ì¡´ ë°°ë„ˆ ìŠ¬ë¡¯ë“¤ ë¡œë“œ
            const bannerSlots = [
                ["slot_index_main_top", "index", "index_main_top"],
                ["slot_index_main_visual", "index", "index_main_visual"],
                ["slot_index_promo_1", "index", "index_promo_1"],
                ["slot_index_promo_2", "index", "index_promo_2"],
                ["slot_index_promo_3", "index", "index_promo_3"],
                ["slot_index_food_delivery", "index", "index_food_delivery"],
                ["slot_index_all_stores", "index", "index_all_stores"],
                ["slot_index_hot_place", "index", "index_hot_place"],
                ["slot_index_suggest", "index", "index_suggest"],
                ["slot_index_open", "index", "index_open"],
                ["slot_index_store_pride", "index", "index_store_pride"],
                ["slot_index_traditional", "index", "index_traditional"],
                ["slot_index_performing", "index", "index_performing"],
                ["slot_index_d2c_banner", "index", "index_d2c_banner"],
                ["slot_index_d2c_shop", "index", "index_d2c_shop"],
                ["slot_index_support_review", "index", "index_support_review"],
                ["slot_index_support_empty", "index", "index_support_empty"],
                ["slot_index_support_inquiry", "index", "index_support_inquiry"],
            ];

            await Promise.all(
                bannerSlots.map(([id, page, pos]) => loadBannerSlotById(id, page, pos))
            );

            // í…ìŠ¤íŠ¸ ìŠ¬ë¡¯ ë¡œë“œ(ì—†ìœ¼ë©´ ë”ë¯¸)
            await loadTextSlotById(
                "slot_index_sub_keywords",
                "index",
                "index_sub_keywords",
                (c) => renderDefaultList(c, DEFAULT_DATA.keywords)
            );
            await loadTextSlotById(
                "slot_index_sub_news",
                "index",
                "index_sub_news",
                (c) => renderDefaultList(c, DEFAULT_DATA.news)
            );
            await loadTextSlotById(
                "slot_index_sub_events",
                "index",
                "index_sub_events",
                (c) => renderDefaultList(c, DEFAULT_DATA.events)
            );
            await loadTextSlotById(
                "slot_index_sub_recommends",
                "index",
                "index_sub_recommends",
                (c) => renderDefaultList(c, DEFAULT_DATA.recommends)
            );

            // ìš°ë¦¬ë™ë„¤ í•œë§ˆë”” ë¡œë“œ
            await loadOneWord();
        });
    </script>

</body>

</html>