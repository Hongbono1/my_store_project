<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ìš°ë¦¬ë™ë„¤ ê°€ê²Œ ì‹ ë¬¸ | MALL HANKOOK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: Pretendard, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #f8f1e2 0, #e7d8c0 40%, #d2c1a5 100%);
            color: #222222;
        }

        .paper-shell {
            position: relative;
            background: #f7efe0;
            border-radius: 0.75rem;
            border: 1px solid rgba(70, 43, 20, 0.35);
            box-shadow: 0 22px 40px rgba(0, 0, 0, 0.18), 0 0 0 1px rgba(255, 255, 255, 0.7);
            padding: 1.5rem;
        }

        .neo-article {
            background: linear-gradient(135deg, #fbf4e7 0%, #f3e5cf 100%);
            border-radius: 0.6rem;
            border: 1px solid rgba(106, 78, 45, 0.35);
            box-shadow: 0 12px 26px rgba(0, 0, 0, 0.12), inset 0 0 0 1px rgba(255, 255, 255, 0.6);
            transition: transform 0.18s ease, box-shadow 0.18s ease;
            min-height: 200px;
        }

        .neo-article:hover {
            transform: translateY(-3px);
            box-shadow: 0 18px 32px rgba(0, 0, 0, 0.18);
        }

        .section-header {
            background: #fef3c7;
            border: 1px solid rgba(217, 119, 6, 0.5);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            font-size: 0.8rem;
            font-weight: 800;
            color: #92400e;
            letter-spacing: 0.22em;
        }

        .store-card {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem;
            background: rgba(255, 255, 255, 0.6);
            border-radius: 0.5rem;
            transition: background 0.2s;
            border: 1px solid rgba(0, 0, 0, 0.1);
        }

        .store-card:hover {
            background: rgba(255, 255, 255, 0.9);
        }

        .store-card-image {
            width: 56px;
            height: 56px;
            border-radius: 0.5rem;
            object-fit: cover;
            background: #e5e7eb;
        }

        .loading-placeholder {
            background: linear-gradient(90deg, #e5e7eb 0%, #f3f4f6 50%, #e5e7eb 100%);
            background-size: 200% 100%;
            animation: loading 2s ease-in-out infinite;
        }

        @keyframes loading {
            0% {
                background-position: 200% 0;
            }

            100% {
                background-position: -200% 0;
            }
        }
    </style>
</head>

<body class="min-h-screen text-slate-900">
    <div id="header-placeholder"></div>

    <main class="max-w-7xl mx-auto px-4 pt-24 pb-16">
        <!-- ì‹ ë¬¸ íƒ€ì´í‹€ -->
        <section class="paper-shell px-4 sm:px-8 py-6 mb-8 text-center">
            <div class="flex flex-col items-center gap-3 border-b border-slate-300/60 pb-4">
                <p class="text-[11px] sm:text-xs uppercase tracking-[0.25em] text-slate-500">
                    MALL HANKOOK Â· DAILY LOCAL DIGEST
                </p>
                <h1 class="text-2xl sm:text-3xl md:text-4xl font-extrabold tracking-tight text-slate-900">
                    ì˜¤ëŠ˜ì˜ ìš°ë¦¬ë™ë„¤ ê°€ê²Œ ì‹ ë¬¸
                </h1>
                <p class="text-xs sm:text-sm text-slate-600 leading-relaxed">
                    ìµœê·¼ ë“±ë¡ëœ ìš°ë¦¬ë™ë„¤ ê°€ê²Œì™€ ì†Œì‹ì„ ì‹ ë¬¸ì²˜ëŸ¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”
                </p>
                <p class="text-[11px] sm:text-xs text-slate-500">
                    ë°œí–‰: <span id="todayDate"></span> Â· ìš°ë¦¬ë™ë„¤ ìš”ì•½íŒ
                </p>
            </div>
        </section>

        <!-- 3ë‹¨ ì‹ ë¬¸ ë ˆì´ì•„ì›ƒ -->
        <div class="paper-shell px-4 sm:px-6 py-6 sm:py-8">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">

                <!-- ğŸ“° ì™¼ìª½ ì»¬ëŸ¼ -->
                <div class="space-y-6">
                    <!-- HOT ë­í‚¹ -->
                    <section class="space-y-3">
                        <div class="section-header bg-red-50 text-red-800 border-red-200 px-4 py-2 text-xs text-center rounded-lg">
                            ğŸ”¥ ê°€ì¥ HOTí•œ ìš°ë¦¬ë™ë„¤
                        </div>
                        <article class="neo-article p-4">
                            <h2 class="text-lg font-extrabold text-slate-900 mb-3">
                                ìš”ì¦˜ ê°€ì¥ ë§ì´ ì°¾ëŠ” ê°€ê²Œ TOP
                            </h2>
                            <p id="hotSummary" class="text-sm text-slate-700 mb-4">
                                HOT ë­í‚¹ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </p>
                            <div id="hotCards" class="space-y-3"></div>
                            <div class="mt-4 pt-3 border-t border-slate-200 flex justify-between text-xs">
                                <span class="text-slate-500">HOT ë­í‚¹</span>
                                <a href="/hot.html" class="text-blue-600 font-semibold hover:underline">ì „ì²´ë³´ê¸° â†’</a>
                            </div>
                        </article>
                    </section>

                    <!-- ì „í†µì‹œì¥ -->
                    <section class="space-y-3">
                        <div class="section-header bg-green-50 text-green-800 border-green-200 px-4 py-2 text-xs text-center rounded-lg">
                            ğŸª ì „í†µì‹œì¥
                        </div>
                        <article class="neo-article p-4">
                            <h2 class="text-lg font-extrabold text-slate-900 mb-3">
                                ìš°ë¦¬ë™ë„¤ ì „í†µì‹œì¥ ì†Œì‹
                            </h2>
                            <p id="marketSummary" class="text-sm text-slate-700 mb-4">
                                ì „í†µì‹œì¥ ì†Œì‹ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </p>
                            <div id="marketCards" class="space-y-3"></div>
                            <div class="mt-4 pt-3 border-t border-slate-200 flex justify-between text-xs">
                                <span class="text-slate-500">ì‹œì¥ ì†Œì‹</span>
                                <a href="/traditionalmarket.html" class="text-blue-600 font-semibold hover:underline">ì „ì²´ë³´ê¸° â†’</a>
                            </div>
                        </article>
                    </section>

                    <!-- ì´ë²¤íŠ¸ -->
                    <section class="space-y-3">
                        <div class="section-header bg-purple-50 text-purple-800 border-purple-200 px-4 py-2 text-xs text-center rounded-lg">
                            ğŸ‰ ì´ë²¤íŠ¸
                        </div>
                        <article class="neo-article p-4">
                            <h2 class="text-lg font-extrabold text-slate-900 mb-3">
                                ì§„í–‰ì¤‘ì¸ í• ì¸ ì´ë²¤íŠ¸
                            </h2>
                            <p id="eventSummary" class="text-sm text-slate-700 mb-4">
                                ìµœì‹  ì´ë²¤íŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </p>
                            <ul id="eventList" class="space-y-2"></ul>
                            <div class="mt-4 pt-3 border-t border-slate-200 flex justify-between text-xs">
                                <span class="text-slate-500">ì´ë²¤íŠ¸</span>
                                <a href="/event.html" class="text-blue-600 font-semibold hover:underline">ì „ì²´ë³´ê¸° â†’</a>
                            </div>
                        </article>
                    </section>
                </div>

                <!-- ğŸ“° ê°€ìš´ë° ì»¬ëŸ¼ (ë©”ì¸) -->
                <div class="space-y-6">
                    <!-- í™ë³´ì˜ ë°°ë‹¬ (ë©”ì¸ í”¼ì²˜) -->
                    <section class="space-y-3">
                        <div class="section-header bg-orange-50 text-orange-800 border-orange-200 px-4 py-2 text-xs text-center rounded-lg">
                            ğŸ• í™ë³´ì˜ ë°°ë‹¬
                        </div>
                        <article class="neo-article p-6 min-h-[500px]">
                            <h2 class="text-2xl font-extrabold text-slate-900 mb-4">
                                ì˜¤ëŠ˜ ë°°ë‹¬ ì£¼ë¬¸ ë§ì€<br>ìš°ë¦¬ë™ë„¤ ëŒ€í‘œ ê°€ê²Œ
                            </h2>
                            <p id="promoDeliverySummary" class="text-sm text-slate-700 mb-6">
                                ìµœê·¼ ë“±ë¡ëœ ë°°ë‹¬ ê°€ê²Œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </p>
                            <div id="promoDeliveryCards" class="space-y-4"></div>
                            <div class="mt-auto pt-4 border-t border-slate-200 flex justify-between text-xs">
                                <span class="text-slate-500">í™ë³´ì˜ ë°°ë‹¬</span>
                                <a href="/foodcategory.html" class="text-blue-600 font-semibold hover:underline">ì „ì²´ë³´ê¸° â†’</a>
                            </div>
                        </article>
                    </section>

                    <!-- ì˜¤í”ˆ ì˜ˆì • -->
                    <section class="space-y-3">
                        <div class="section-header bg-yellow-50 text-yellow-800 border-yellow-200 px-4 py-2 text-xs text-center rounded-lg">
                            ğŸŠ ì˜¤í”ˆ ì˜ˆì •
                        </div>
                        <article class="neo-article p-4">
                            <h2 class="text-lg font-extrabold text-slate-900 mb-3">
                                ê³§ ë¬¸ ì—¬ëŠ” ìƒˆ ê°€ê²Œ
                            </h2>
                            <p id="openSummary" class="text-sm text-slate-700 mb-4">
                                ì˜¤í”ˆ ì˜ˆì • ê°€ê²Œë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </p>
                            <div id="openCards" class="space-y-3"></div>
                            <div class="mt-4 pt-3 border-t border-slate-200 flex justify-between text-xs">
                                <span class="text-slate-500">ì‹ ê·œ ì˜¤í”ˆ</span>
                                <a href="/open.html" class="text-blue-600 font-semibold hover:underline">ì „ì²´ë³´ê¸° â†’</a>
                            </div>
                        </article>
                    </section>
                </div>

                <!-- ğŸ“° ì˜¤ë¥¸ìª½ ì»¬ëŸ¼ -->
                <div class="space-y-6">
                    <!-- ìš°ë¦¬ë™ë„¤ ëª¨ë“  ê°€ê²Œ -->
                    <section class="space-y-3">
                        <div class="section-header bg-blue-50 text-blue-800 border-blue-200 px-4 py-2 text-xs text-center rounded-lg">
                            ğŸ—ºï¸ ìš°ë¦¬ë™ë„¤ ëª¨ë“  ê°€ê²Œ
                        </div>
                        <article class="neo-article p-4">
                            <h2 class="text-lg font-extrabold text-slate-900 mb-3">
                                ë™ë„¤ ì „ì²´ ê°€ê²Œ ì§€ë„
                            </h2>
                            <p id="allStoresSummary" class="text-sm text-slate-700 mb-4">
                                ìµœê·¼ ë“±ë¡ëœ ê°€ê²Œë“¤ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </p>
                            <div id="allStoresCards" class="space-y-3"></div>
                            <div class="mt-4 pt-3 border-t border-slate-200 flex justify-between text-xs">
                                <span class="text-slate-500">ì „ì²´ ê°€ê²Œ</span>
                                <a href="/ncategory.html" class="text-blue-600 font-semibold hover:underline">ì „ì²´ë³´ê¸° â†’</a>
                            </div>
                        </article>
                    </section>

                    <!-- ê°€ê²Œ ìë‘ -->
                    <section class="space-y-3">
                        <div class="section-header bg-pink-50 text-pink-800 border-pink-200 px-4 py-2 text-xs text-center rounded-lg">
                            ğŸ’¬ ê°€ê²Œ ìë‘
                        </div>
                        <article class="neo-article p-4">
                            <h2 class="text-lg font-extrabold text-slate-900 mb-3">
                                ì‚¬ì¥ë‹˜ ì¸í„°ë·°
                            </h2>
                            <p id="prideSummary" class="text-sm text-slate-700 mb-4">
                                ê°€ê²Œ ìë‘ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </p>
                            <div id="prideCards" class="space-y-3"></div>
                            <div class="mt-4 pt-3 border-t border-slate-200 flex justify-between text-xs">
                                <span class="text-slate-500">ê°€ê²Œ ìë‘</span>
                                <a href="/storepride.html" class="text-blue-600 font-semibold hover:underline">ì „ì²´ë³´ê¸° â†’</a>
                            </div>
                        </article>
                    </section>

                    <!-- ì§€ì—­ ê²Œì‹œíŒ -->
                    <section class="space-y-3">
                        <div class="section-header bg-indigo-50 text-indigo-800 border-indigo-200 px-4 py-2 text-xs text-center rounded-lg">
                            ğŸ“ ì§€ì—­ ê²Œì‹œíŒ
                        </div>
                        <article class="neo-article p-4">
                            <h2 class="text-lg font-extrabold text-slate-900 mb-3">
                                ìš°ë¦¬ë™ë„¤ í•œë§ˆë””
                            </h2>
                            <p id="localBoardSummary" class="text-sm text-slate-700 mb-4">
                                ì§€ì—­ ê²Œì‹œíŒ ê¸€ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...
                            </p>
                            <ul id="localBoardList" class="space-y-2"></ul>
                            <div class="mt-4 pt-3 border-t border-slate-200 flex justify-between text-xs">
                                <span class="text-slate-500">ê²Œì‹œíŒ</span>
                                <a href="/localboard.html" class="text-blue-600 font-semibold hover:underline">ì „ì²´ë³´ê¸° â†’</a>
                            </div>
                        </article>
                    </section>
                </div>

            </div>
        </div>
    </main>

    <div id="footer-placeholder"></div>

    <script>
        document.addEventListener("DOMContentLoaded", () => {
            console.log("ğŸš€ í™ë³´ì˜ ì‹ ë¬¸ í˜ì´ì§€ ë¡œë”© ì‹œì‘");

            // Header/Footer ë¡œë”©
            loadComponent("header");
            loadComponent("footer");

            // ì˜¤ëŠ˜ ë‚ ì§œ ì„¤ì •
            setTodayDate();

            // ğŸ”¥ ëª¨ë“  ì„¹ì…˜ ë°ì´í„° ë¡œë”©
            loadAllSections();
        });

        function loadComponent(type) {
            const url = `/components/${type}.html`;
            const targetId = `${type}-placeholder`;

            fetch(url)
                .then(res => {
                    if (!res.ok) throw new Error(`${type} ë¡œë”© ì‹¤íŒ¨`);
                    return res.text();
                })
                .then(html => {
                    const target = document.getElementById(targetId);
                    if (target) target.innerHTML = html;
                })
                .catch(err => console.error(`âŒ ${type} ë¡œë”© ì˜¤ë¥˜:`, err));
        }

        function setTodayDate() {
            const d = new Date();
            const todayText = d.toLocaleDateString("ko-KR", {
                year: "numeric",
                month: "2-digit",
                day: "2-digit",
                weekday: "short"
            });
            const dateEl = document.getElementById("todayDate");
            if (dateEl) dateEl.textContent = todayText;
        }

        async function loadAllSections() {
            console.log("ğŸ“° ëª¨ë“  ì„¹ì…˜ ë¡œë”© ì‹œì‘");

            const sections = [
                { name: "í™ë³´ì˜ ë°°ë‹¬", func: loadPromoDelivery },
                { name: "HOT ë­í‚¹", func: loadHotRanking },
                { name: "ì „í†µì‹œì¥", func: loadTraditionalMarket },
                { name: "ì´ë²¤íŠ¸", func: loadEvents },
                { name: "ì˜¤í”ˆ ì˜ˆì •", func: loadOpenStores },
                { name: "ëª¨ë“  ê°€ê²Œ", func: loadAllStores },
                { name: "ê°€ê²Œ ìë‘", func: loadStorePride },
                { name: "ì§€ì—­ ê²Œì‹œíŒ", func: loadLocalBoard }
            ];

            // ë³‘ë ¬ ë¡œë”©
            await Promise.allSettled(
                sections.map(async section => {
                    try {
                        await section.func();
                        console.log(`âœ… ${section.name} ë¡œë”© ì™„ë£Œ`);
                    } catch (err) {
                        console.error(`âŒ ${section.name} ë¡œë”© ì‹¤íŒ¨:`, err);
                    }
                })
            );

            console.log("ğŸ‰ ëª¨ë“  ì„¹ì…˜ ë¡œë”© ì™„ë£Œ");
        }

        // âœ… ê°€ê²Œ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸
        function createStoreCard(store, linkUrl = "/detail.html") {
            const imageUrl = store.image || store.image_url || "/uploads/no-image.png";
            const storeName = store.name || store.store_name || "ì´ë¦„ ë¯¸ë“±ë¡";
            const category = store.category || store.store_category || "ì¼ë°˜";
            const viewCount = store.view_count ? ` (${store.view_count}íšŒ)` : "";

            return `
                <a href="${linkUrl}?id=${store.id}" class="store-card">
                    <img src="${imageUrl}" alt="${storeName}" class="store-card-image" 
                         onerror="this.src='/uploads/no-image.png'">
                    <div class="flex-1 min-w-0">
                        <div class="font-semibold text-slate-900 truncate">${storeName}${viewCount}</div>
                        <div class="text-sm text-slate-600">${category}</div>
                    </div>
                </a>
            `;
        }

        // ğŸ”½ í™ë³´ì˜ ë°°ë‹¬
        async function loadPromoDelivery() {
            const summaryEl = document.getElementById("promoDeliverySummary");
            const cardsEl = document.getElementById("promoDeliveryCards");

            try {
                console.log("ğŸ“± í™ë³´ì˜ ë°°ë‹¬ API í˜¸ì¶œ ì‹œì‘");
                const res = await fetch("/api/food/latest?limit=6");
                console.log("ğŸ“± ì‘ë‹µ ìƒíƒœ:", res.status);
                
                if (!res.ok) {
                    const errorText = await res.text();
                    console.error("ğŸ“± API ì˜¤ë¥˜ ì‘ë‹µ:", errorText);
                    throw new Error(`API í˜¸ì¶œ ì‹¤íŒ¨: ${res.status}`);
                }
                
                const data = await res.json();
                console.log("ğŸ“± ë°›ì€ ë°ì´í„°:", data);

                // ğŸš¨ ë°°ì—´ ì²´í¬ ê°•í™”
                if (!Array.isArray(data)) {
                    console.warn("ğŸ“± ë°ì´í„°ê°€ ë°°ì—´ì´ ì•„ë‹˜:", typeof data, data);
                    summaryEl.textContent = "ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-amber-600 p-4'>ì„œë²„ì—ì„œ ì˜ëª»ëœ í˜•ì‹ì˜ ë°ì´í„°ë¥¼ ë°›ì•˜ìŠµë‹ˆë‹¤</p>";
                    return;
                }

                if (data.length === 0) {
                    summaryEl.textContent = "ì•„ì§ ë“±ë¡ëœ ë°°ë‹¬ ê°€ê²Œê°€ ì—†ìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-slate-500 p-4 text-center'>ë“±ë¡ëœ ê°€ê²Œê°€ ì—†ìŠµë‹ˆë‹¤</p>";
                    return;
                }

                summaryEl.textContent = `ìµœê·¼ ë“±ë¡ëœ ë°°ë‹¬ ê°€ê²Œ ${data.length}ê³³ì„ ì†Œê°œí•©ë‹ˆë‹¤.`;
                cardsEl.innerHTML = data.map(store => createStoreCard(store)).join("");
                
            } catch (err) {
                console.error("âŒ í™ë³´ì˜ ë°°ë‹¬ ë¡œë”© ì‹¤íŒ¨:", err);
                summaryEl.textContent = "ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                cardsEl.innerHTML = `<p class='text-sm text-red-500 p-4'>ì˜¤ë¥˜: ${err.message}</p>`;
            }
        }

        // ğŸ”½ HOT ë­í‚¹
        async function loadHotRanking() {
            const summaryEl = document.getElementById("hotSummary");
            const cardsEl = document.getElementById("hotCards");

            try {
                console.log("ğŸ”¥ HOT ë­í‚¹ API í˜¸ì¶œ ì‹œì‘");
                const res = await fetch("/api/hot/latest?limit=4");
                
                if (!res.ok) {
                    throw new Error(`API í˜¸ì¶œ ì‹¤íŒ¨: ${res.status}`);
                }
                
                const data = await res.json();
                console.log("ğŸ”¥ ë°›ì€ ë°ì´í„°:", data);

                if (!Array.isArray(data)) {
                    console.warn("ğŸ”¥ ë°ì´í„°ê°€ ë°°ì—´ì´ ì•„ë‹˜:", typeof data, data);
                    summaryEl.textContent = "ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-amber-600 p-4'>ì„œë²„ ì˜¤ë¥˜</p>";
                    return;
                }

                if (data.length === 0) {
                    summaryEl.textContent = "ì•„ì§ HOT ë­í‚¹ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-slate-500 p-4 text-center'>ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</p>";
                    return;
                }

                summaryEl.textContent = `ì§€ê¸ˆ ê°€ì¥ ì¸ê¸° ìˆëŠ” ê°€ê²Œ ${data.length}ê³³ì…ë‹ˆë‹¤.`;
                cardsEl.innerHTML = data.map(store => createStoreCard(store)).join("");
                
            } catch (err) {
                console.error("âŒ HOT ë­í‚¹ ë¡œë”© ì‹¤íŒ¨:", err);
                summaryEl.textContent = "HOT ë­í‚¹ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                cardsEl.innerHTML = `<p class='text-sm text-red-500 p-4'>ì˜¤ë¥˜: ${err.message}</p>`;
            }
        }

        // ğŸ”½ ì „í†µì‹œì¥
        async function loadTraditionalMarket() {
            const summaryEl = document.getElementById("marketSummary");
            const cardsEl = document.getElementById("marketCards");

            try {
                const res = await fetch("/api/traditional/latest?limit=4");
                const data = await res.json();

                if (!data || data.length === 0) {
                    summaryEl.textContent = "ë“±ë¡ëœ ì „í†µì‹œì¥ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-slate-500 p-4 text-center'>ì‹œì¥ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤</p>";
                    return;
                }

                summaryEl.textContent = `ìµœê·¼ ì—…ë°ì´íŠ¸ëœ ì „í†µì‹œì¥ ${data.length}ê³³ì…ë‹ˆë‹¤.`;
                cardsEl.innerHTML = data.map(market => {
                    const imageUrl = market.image || "/uploads/no-image.png";
                    const name = market.name || "ì‹œì¥ëª… ë¯¸ë“±ë¡";
                    const region = market.region || market.address || "ì§€ì—­ ì •ë³´ ì—†ìŒ";

                    return `
                        <a href="/traditionalmarketdetail.html?id=${market.id}" class="store-card">
                            <img src="${imageUrl}" alt="${name}" class="store-card-image" 
                                 onerror="this.src='/uploads/no-image.png'">
                            <div class="flex-1 min-w-0">
                                <div class="font-semibold text-slate-900 truncate">${name}</div>
                                <div class="text-sm text-slate-600">${region}</div>
                            </div>
                        </a>
                    `;
                }).join("");

            } catch (err) {
                console.error("âŒ ì „í†µì‹œì¥ ë¡œë”© ì‹¤íŒ¨:", err);
                summaryEl.textContent = "ì‹œì¥ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                cardsEl.innerHTML = "<p class='text-sm text-red-500 p-4'>ë°ì´í„° ë¡œë”© ì‹¤íŒ¨</p>";
            }
        }

        // ğŸ”½ ì´ë²¤íŠ¸ (ë¦¬ìŠ¤íŠ¸)
        // HTMLì€ ê¸°ì¡´ ìœ ì§€, JavaScript ë¶€ë¶„ë§Œ ìˆ˜ì •
        async function loadEvents() {
            const summaryEl = document.getElementById("eventSummary");
            const listEl = document.getElementById("eventList");

            try {
                console.log("ğŸ‰ ì´ë²¤íŠ¸ API í˜¸ì¶œ ì‹œì‘");
                const res = await fetch("/api/event/latest?limit=4");
                console.log("ğŸ‰ ì‘ë‹µ ìƒíƒœ:", res.status);
                
                if (!res.ok) {
                    console.warn(`ğŸ‰ API ì‘ë‹µ ì˜¤ë¥˜: ${res.status}`);
                    summaryEl.textContent = "ì´ë²¤íŠ¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                    listEl.innerHTML = "<li class='text-sm text-slate-500 p-2'>ì„œë²„ ì—°ê²° ì˜¤ë¥˜</li>";
                    return;
                }
                
                const data = await res.json();
                console.log("ğŸ‰ ë°›ì€ ë°ì´í„°:", data, "íƒ€ì…:", typeof data, "ë°°ì—´ì—¬ë¶€:", Array.isArray(data));

                // ğŸš¨ ë°°ì—´ ê²€ì¦ ê°•í™”
                if (!Array.isArray(data)) {
                    console.warn("ğŸ‰ ì‘ë‹µì´ ë°°ì—´ì´ ì•„ë‹˜:", data);
                    summaryEl.textContent = "ì´ë²¤íŠ¸ ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜";
                    listEl.innerHTML = "<li class='text-sm text-amber-600 p-2'>ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜</li>";
                    return;
                }

                if (data.length === 0) {
                    summaryEl.textContent = "ì§„í–‰ì¤‘ì¸ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.";
                    listEl.innerHTML = "<li class='text-sm text-slate-500 p-2 text-center'>ì§„í–‰ì¤‘ì¸ ì´ë²¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤</li>";
                    return;
                }

                summaryEl.textContent = `ì§€ê¸ˆ ì°¸ì—¬ ê°€ëŠ¥í•œ ì´ë²¤íŠ¸ ${data.length}ê±´ì…ë‹ˆë‹¤.`;
                listEl.innerHTML = data.map((item, idx) => `
                    <li class="flex items-center justify-between p-2 hover:bg-white/50 rounded">
                        <a href="/eventdetail.html?id=${item.id}" class="flex items-center gap-2 flex-1">
                            <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-purple-100 text-purple-800 text-xs font-bold">
                                ${idx + 1}
                            </span>
                            <span class="font-medium text-sm truncate">${item.title || "ì´ë²¤íŠ¸ ì œëª© ì—†ìŒ"}</span>
                        </a>
                        <span class="text-xs text-slate-500 ml-2">${item.store_name || ""}</span>
                    </li>
                `).join("");
                
            } catch (err) {
                console.error("âŒ ì´ë²¤íŠ¸ ë¡œë”© ì‹¤íŒ¨:", err);
                summaryEl.textContent = "ì´ë²¤íŠ¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                listEl.innerHTML = `<li class='text-sm text-red-500 p-2'>ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${err.message}</li>`;
            }
        }

        // ğŸ”½ ì˜¤í”ˆ ì˜ˆì •
        // HTMLì€ ê¸°ì¡´ ìœ ì§€, JavaScript ë¶€ë¶„ë§Œ ìˆ˜ì •
        async function loadOpenStores() {
            const summaryEl = document.getElementById("openSummary");
            const cardsEl = document.getElementById("openCards");

            try {
                console.log("ğŸŠ ì˜¤í”ˆ ì˜ˆì • API í˜¸ì¶œ ì‹œì‘");
                const res = await fetch("/api/open/latest?limit=4");
                console.log("ğŸŠ ì‘ë‹µ ìƒíƒœ:", res.status);
                
                if (!res.ok) {
                    console.warn(`ğŸŠ API ì‘ë‹µ ì˜¤ë¥˜: ${res.status}`);
                    summaryEl.textContent = "ì˜¤í”ˆ ì˜ˆì • ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-slate-500 p-4 text-center'>ì„œë²„ ì—°ê²° ì˜¤ë¥˜</p>";
                    return;
                }
                
                const data = await res.json();
                console.log("ğŸŠ ë°›ì€ ë°ì´í„°:", data, "íƒ€ì…:", typeof data, "ë°°ì—´ì—¬ë¶€:", Array.isArray(data));

                // ğŸš¨ ë°°ì—´ ê²€ì¦
                if (!Array.isArray(data)) {
                    console.warn("ğŸŠ ì‘ë‹µì´ ë°°ì—´ì´ ì•„ë‹˜:", data);
                    summaryEl.textContent = "ì˜¤í”ˆ ì˜ˆì • ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜";
                    cardsEl.innerHTML = "<p class='text-sm text-amber-600 p-4'>ë°ì´í„° í˜•ì‹ ì˜¤ë¥˜</p>";
                    return;
                }

                if (data.length === 0) {
                    summaryEl.textContent = "ê³§ ì˜¤í”ˆí•  ê°€ê²Œê°€ ì—†ìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-slate-500 p-4 text-center'>ì˜¤í”ˆ ì˜ˆì • ê°€ê²Œê°€ ì—†ìŠµë‹ˆë‹¤</p>";
                    return;
                }

                summaryEl.textContent = `ê³§ ë¬¸ì„ ì—¬ëŠ” ìƒˆ ê°€ê²Œ ${data.length}ê³³ì…ë‹ˆë‹¤.`;
                cardsEl.innerHTML = data.map(store => createStoreCard(store, "/opendetail.html")).join("");
                
            } catch (err) {
                console.error("âŒ ì˜¤í”ˆ ì˜ˆì • ë¡œë”© ì‹¤íŒ¨:", err);
                summaryEl.textContent = "ì˜¤í”ˆ ì˜ˆì • ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                cardsEl.innerHTML = `<p class='text-sm text-red-500 p-4'>ë„¤íŠ¸ì›Œí¬ ì˜¤ë¥˜: ${err.message}</p>`;
            }
        }

        // ğŸ”½ ëª¨ë“  ê°€ê²Œ
        async function loadAllStores() {
            const summaryEl = document.getElementById("allStoresSummary");
            const cardsEl = document.getElementById("allStoresCards");

            try {
                const res = await fetch("/api/stores/latest?limit=4");
                const data = await res.json();

                if (!data || data.length === 0) {
                    summaryEl.textContent = "ë“±ë¡ëœ ê°€ê²Œê°€ ì—†ìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-slate-500 p-4 text-center'>ë“±ë¡ëœ ê°€ê²Œê°€ ì—†ìŠµë‹ˆë‹¤</p>";
                    return;
                }

                summaryEl.textContent = `ìµœê·¼ ë“±ë¡ëœ ê°€ê²Œ ${data.length}ê³³ì…ë‹ˆë‹¤.`;
                cardsEl.innerHTML = data.map(store => createStoreCard(store)).join("");

            } catch (err) {
                console.error("âŒ ëª¨ë“  ê°€ê²Œ ë¡œë”© ì‹¤íŒ¨:", err);
                summaryEl.textContent = "ê°€ê²Œ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                cardsEl.innerHTML = "<p class='text-sm text-red-500 p-4'>ë°ì´í„° ë¡œë”© ì‹¤íŒ¨</p>";
            }
        }

        // ğŸ”½ ê°€ê²Œ ìë‘
        async function loadStorePride() {
            const summaryEl = document.getElementById("prideSummary");
            const cardsEl = document.getElementById("prideCards");

            try {
                const res = await fetch("/api/storepride/latest?limit=3");
                const data = await res.json();

                if (!data || data.length === 0) {
                    summaryEl.textContent = "ë“±ë¡ëœ ê°€ê²Œ ìë‘ì´ ì—†ìŠµë‹ˆë‹¤.";
                    cardsEl.innerHTML = "<p class='text-sm text-slate-500 p-4 text-center'>ê°€ê²Œ ìë‘ì´ ì—†ìŠµë‹ˆë‹¤</p>";
                    return;
                }

                summaryEl.textContent = `ì‚¬ì¥ë‹˜ ì¸í„°ë·° ${data.length}ê±´ì…ë‹ˆë‹¤.`;
                cardsEl.innerHTML = data.map(item => {
                    const imageUrl = item.image || "/uploads/no-image.png";
                    const title = item.title || "ì œëª© ì—†ìŒ";
                    const storeName = item.store_name || "ê°€ê²Œëª… ì—†ìŒ";

                    return `
                        <a href="/storepridedetail.html?id=${item.id}" class="store-card">
                            <img src="${imageUrl}" alt="${title}" class="store-card-image" 
                                 onerror="this.src='/uploads/no-image.png'">
                            <div class="flex-1 min-w-0">
                                <div class="font-semibold text-slate-900 truncate">${title}</div>
                                <div class="text-sm text-slate-600">${storeName}</div>
                            </div>
                        </a>
                    `;
                }).join("");

            } catch (err) {
                console.error("âŒ ê°€ê²Œ ìë‘ ë¡œë”© ì‹¤íŒ¨:", err);
                summaryEl.textContent = "ê°€ê²Œ ìë‘ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                cardsEl.innerHTML = "<p class='text-sm text-red-500 p-4'>ë°ì´í„° ë¡œë”© ì‹¤íŒ¨</p>";
            }
        }

        // ğŸ”½ ì§€ì—­ ê²Œì‹œíŒ (ë¦¬ìŠ¤íŠ¸)
        async function loadLocalBoard() {
            const summaryEl = document.getElementById("localBoardSummary");
            const listEl = document.getElementById("localBoardList");

            try {
                const res = await fetch("/api/localboard/latest?limit=4");
                const data = await res.json();

                if (!data || data.length === 0) {
                    summaryEl.textContent = "ë™ë„¤ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤.";
                    listEl.innerHTML = "<li class='text-sm text-slate-500 p-2'>ë™ë„¤ ê²Œì‹œê¸€ì´ ì—†ìŠµë‹ˆë‹¤</li>";
                    return;
                }

                summaryEl.textContent = `ì˜¤ëŠ˜ ì˜¬ë¼ì˜¨ ë™ë„¤ ì´ì•¼ê¸° ${data.length}ê±´ì…ë‹ˆë‹¤.`;
                listEl.innerHTML = data.map((item, idx) => `
                    <li class="flex items-center justify-between p-2 hover:bg-white/50 rounded">
                        <a href="/localboarddetail.html?id=${item.id}" class="flex items-center gap-2 flex-1">
                            <span class="inline-flex items-center justify-center w-6 h-6 rounded-full bg-indigo-100 text-indigo-800 text-xs font-bold">
                                ${idx + 1}
                            </span>
                            <span class="font-medium text-sm truncate">${item.title || "ì œëª© ì—†ìŒ"}</span>
                        </a>
                        <span class="text-xs text-slate-500 ml-2">${item.author || "ìµëª…"}</span>
                    </li>
                `).join("");

            } catch (err) {
                console.error("âŒ ì§€ì—­ ê²Œì‹œíŒ ë¡œë”© ì‹¤íŒ¨:", err);
                summaryEl.textContent = "ë™ë„¤ ê²Œì‹œê¸€ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.";
                listEl.innerHTML = "<li class='text-sm text-red-500 p-2'>ë°ì´í„° ë¡œë”© ì‹¤íŒ¨</li>";
            }
        }
    </script>
</body>

</html>