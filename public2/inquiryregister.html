<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>문의 등록 | MALL HANKOOK</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            font-family: Pretendard, system-ui, sans-serif;
            background: linear-gradient(135deg, #eef2ff, #f8fafc);
        }
    </style>
</head>

<body class="min-h-screen flex items-center justify-center py-10">

    <div class="w-full max-w-2xl bg-white shadow-xl rounded-2xl p-8 border">
        <h2 class="text-3xl font-bold text-indigo-700 mb-8 text-center">문의 등록</h2>

        <form id="inquiryForm" class="flex flex-col gap-6" enctype="multipart/form-data">

            <!-- 1차 카테고리 -->
            <div>
                <label class="font-semibold text-gray-700">문의 유형</label>
                <select id="primaryCategory"
                    class="w-full mt-2 p-3 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                    <option value="">문의 유형 선택</option>
                    <option value="account">가입/로그인 문의</option>
                    <option value="store">가게 등록 문의</option>
                    <option value="payment">결제/정산 문의</option>
                    <option value="advertising">홍보/광고 문의</option>
                    <option value="error">오류 신고</option>
                    <option value="usage">사용 방법 문의</option>
                    <option value="rider">라이더 서비스 문의</option>
                    <option value="blog">오픈예정/홍보 블로그 문의</option>
                    <option value="etc">기타 문의</option>
                </select>
            </div>

            <!-- 2차 카테고리 -->
            <div>
                <label class="font-semibold text-gray-700">세부 유형</label>
                <select id="secondaryCategory"
                    class="w-full mt-2 p-3 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500">
                    <option value="">세부 유형 선택</option>
                </select>
            </div>

            <!-- 제목 -->
            <div>
                <label class="font-semibold text-gray-700">제목</label>
                <input type="text" id="title"
                    class="w-full mt-2 p-3 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"
                    placeholder="제목을 입력하세요">
            </div>

            <!-- 내용 -->
            <div>
                <label class="font-semibold text-gray-700">문의 내용</label>
                <textarea id="content" rows="6"
                    class="w-full mt-2 p-3 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"
                    placeholder="문의 내용을 상세히 입력해주세요."></textarea>
            </div>

            <!-- 연락처 -->
            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                <div>
                    <label class="font-semibold text-gray-700">이메일</label>
                    <input id="email" type="email"
                        class="w-full mt-2 p-3 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"
                        placeholder="example@email.com">
                </div>
                <div>
                    <label class="font-semibold text-gray-700">휴대폰 번호</label>
                    <input id="phone" type="text"
                        class="w-full mt-2 p-3 border rounded-lg focus:ring-indigo-500 focus:border-indigo-500"
                        placeholder="01012345678">
                </div>
            </div>

            <!-- 파일 -->
            <div>
                <label class="font-semibold text-gray-700">첨부 파일 (선택)</label>
                <input type="file" id="file" class="mt-2 w-full border rounded-lg p-2">
            </div>

            <!-- 버튼 -->
            <button type="submit"
                class="w-full py-3 mt-4 bg-indigo-600 hover:bg-indigo-700 text-white font-semibold rounded-xl shadow">
                문의 등록하기
            </button>
        </form>
    </div>

    <script>
        // 1차 → 2차 카테고리 매핑
        const secondaryOptions = {
            account: ["이메일/비밀번호 찾기", "휴대폰 인증 문제", "사업자 인증 문제", "회원가입 방법"],
            store: ["사업자번호 인증 오류", "지도/주소 등록 문제", "이미지 업로드 문제", "메뉴 등록 방법", "영업정보 수정 요청"],
            payment: ["카드 결제 연동", "PG사 등록 방법", "판매금 정산", "세금계산서/영수증"],
            advertising: ["상단 노출 광고 신청", "지역 광고 문의", "배너 광고", "SNS 마케팅"],
            error: ["지도 오류", "이미지 404", "상세페이지 오류", "등록 페이지 오류"],
            usage: ["지도 입력 방법", "사진 관리", "메뉴 등록", "블로그 작성 방법"],
            rider: ["라이더 등록", "보험/면허 제출", "배달 가능 지역", "정산/수익 문의"],
            blog: ["블로그 작성법", "이미지 업로드", "공개 설정", "Q&A 작성 방법"],
            etc: ["기타"]
        };

        const primaryCategory = document.getElementById("primaryCategory");
        const secondaryCategory = document.getElementById("secondaryCategory");

        primaryCategory.addEventListener("change", () => {
            const value = primaryCategory.value;
            secondaryCategory.innerHTML = '<option value="">세부 유형 선택</option>';

            if (secondaryOptions[value]) {
                secondaryOptions[value].forEach(item => {
                    const option = document.createElement("option");
                    option.value = item;
                    option.textContent = item;
                    secondaryCategory.appendChild(option);
                });
            }
        });

        // 폼 제출
        document.getElementById("inquiryForm").addEventListener("submit", async (e) => {
            e.preventDefault();

            const formData = new FormData();
            formData.append("primary_category", primaryCategory.value);
            formData.append("secondary_category", secondaryCategory.value);
            formData.append("title", document.getElementById("title").value);
            formData.append("content", document.getElementById("content").value);
            formData.append("email", document.getElementById("email").value);
            formData.append("phone", document.getElementById("phone").value);

            const fileInput = document.getElementById("file");
            if (fileInput.files[0]) {
                formData.append("file", fileInput.files[0]);
            }

            const res = await fetch("/inquiry/register", {
                method: "POST",
                body: formData
            });

            const data = await res.json();
            if (data.success) {
                alert("문의가 등록되었습니다.");
                location.href = "/inquiry.html";
            } else {
                alert("등록 실패: " + data.message);
            }
        });
    </script>

</body>

</html>