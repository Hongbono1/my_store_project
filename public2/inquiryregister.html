<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>문의 작성 | MALL HANKOOK</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: Pretendard, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: radial-gradient(circle at top, #e0f2fe, #f9fafb);
            min-height: 100vh;
        }

        .neo-card {
            background: rgba(255, 255, 255, 0.9);
            border-radius: 24px;
            box-shadow:
                10px 10px 30px rgba(15, 23, 42, 0.12),
                -6px -6px 20px rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(148, 163, 184, 0.2);
            backdrop-filter: blur(18px);
        }

        .field-label {
            @apply text-sm font-semibold text-slate-700;
        }

        .field-input {
            @apply w-full mt-1 px-3 py-2 rounded-xl border border-slate-200 focus:outline-none focus:ring-2 focus:ring-indigo-400 focus:border-indigo-400 bg-white;
        }
    </style>
</head>

<body class="flex items-center justify-center px-4 py-10">
    <div class="w-full max-w-3xl neo-card p-8">
        <h1 class="text-2xl md:text-3xl font-extrabold text-slate-900 mb-2">
            문의 작성
        </h1>
        <p class="text-sm text-slate-500 mb-6">
            서비스 이용, 광고/제휴, 가게 등록 등 궁금한 점을 남겨주세요. 최대 <strong>3장까지 이미지</strong>를 첨부할 수 있습니다.
        </p>

        <form id="inquiryForm" class="space-y-6" enctype="multipart/form-data">
            <!-- 작성자 정보 -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="field-label">이름 <span class="text-red-500">*</span></label>
                    <input type="text" name="writer_name" class="field-input" placeholder="홍길동" required />
                </div>
                <div>
                    <label class="field-label">연락처</label>
                    <input type="tel" name="writer_phone" class="field-input" placeholder="010-0000-0000" />
                </div>
                <div>
                    <label class="field-label">이메일</label>
                    <input type="email" name="writer_email" class="field-input" placeholder="example@mallhankook.com" />
                </div>
            </div>

            <!-- 문의 유형 -->
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="field-label">문의 유형 <span class="text-red-500">*</span></label>
                    <select name="inquiry_type" class="field-input" required>
                        <option value="">선택해주세요</option>
                        <option value="일반문의">일반문의</option>
                        <option value="광고문의">광고문의</option>
                        <option value="제휴문의">제휴/협업 문의</option>
                        <option value="가게등록문의">가게 등록 문의</option>
                        <option value="기타">기타</option>
                    </select>
                </div>
                <div class="md:col-span-2">
                    <label class="field-label">제목 <span class="text-red-500">*</span></label>
                    <input type="text" name="title" class="field-input" placeholder="어떤 내용의 문의인지 한 줄로 적어주세요" required />
                </div>
            </div>

            <!-- 문의 내용 -->
            <div>
                <label class="field-label">문의 내용 <span class="text-red-500">*</span></label>
                <textarea name="content" rows="6" class="field-input resize-none"
                    placeholder="문의 내용을 가능한 자세하게 적어주세요.&#10;예: 가게 등록 절차가 어떻게 되는지 궁금합니다." required></textarea>
            </div>

            <!-- 이미지 업로드 -->
            <div>
                <label class="field-label">이미지 첨부 (선택, 최대 3장)</label>
                <input type="file" name="images" id="images" class="mt-1 w-full text-sm text-slate-600" accept="image/*"
                    multiple />
                <p class="text-xs text-slate-400 mt-1">
                    JPG, PNG 등 이미지 파일만 업로드 가능 · 파일당 최대 5MB · 최대 3장
                </p>
            </div>

            <!-- 상태 메시지 -->
            <div id="inquiryMessage" class="text-sm mt-2 hidden"></div>

            <!-- 버튼 -->
            <div class="flex justify-end gap-3 pt-4 border-t border-slate-200">
                <button type="reset"
                    class="px-4 py-2 rounded-xl border border-slate-200 text-slate-600 text-sm font-medium hover:bg-slate-50">
                    초기화
                </button>
                <button type="submit"
                    class="px-6 py-2.5 rounded-xl bg-indigo-600 text-white text-sm font-semibold shadow-md hover:bg-indigo-700 active:scale-95 transition">
                    문의 보내기
                </button>
            </div>
        </form>
    </div>

    <script>
        const form = document.getElementById("inquiryForm");
        const messageBox = document.getElementById("inquiryMessage");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();

            messageBox.classList.remove("hidden", "text-red-500", "text-green-600");
            messageBox.textContent = "등록 중입니다. 잠시만 기다려주세요...";
            messageBox.classList.add("text-slate-600");

            try {
                const formData = new FormData(form);

                // images 필드 여러 개 전송 (input name="images", multiple)
                const files = document.getElementById("images").files;
                // (FormData는 이미 images 전체를 담으므로 별도 처리 없이도 전송 가능)

                const resp = await fetch("/api/inquiry", {
                    method: "POST",
                    body: formData
                });

                const data = await resp.json();

                if (!resp.ok || !data.ok) {
                    throw new Error(data.message || "문의 등록에 실패했습니다.");
                }

                messageBox.classList.remove("text-slate-600");
                messageBox.classList.add("text-green-600");
                messageBox.textContent = "문의가 정상적으로 등록되었습니다. 빠른 시일 내에 확인 후 연락드리겠습니다.";

                // 폼 초기화
                form.reset();
            } catch (err) {
                console.error(err);
                messageBox.classList.remove("text-slate-600", "text-green-600");
                messageBox.classList.add("text-red-500");
                messageBox.textContent = err.message || "문의 등록 중 오류가 발생했습니다.";
            }
        });
    </script>
</body>

</html>