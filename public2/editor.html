<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ì•ˆì •í˜• í…ìŠ¤íŠ¸ ì—ë””í„° (SE2 ì›ì¹™)</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: Pretendard, system-ui, -apple-system, Segoe UI, Roboto, 'Noto Sans KR', sans-serif;
    }

    .editor-content:focus {
      outline: none;
    }

    .editor-content p {
      margin: 0;
    }

    .toolbar-btn.active {
      outline: 2px solid rgb(59 130 246);
      outline-offset: 0;
      background-color: rgb(239 246 255);
    }

    .dropdown:focus-within .dropdown-menu {
      display: block;
    }

    .dropdown-menu {
      display: none;
    }

    /* íŒ”ë ˆíŠ¸ ë²„íŠ¼ í™œì„± ì‹œ ì‹œê° ê°•ì¡° */
    .swatch {
      box-shadow: inset 0 0 0 2px rgba(0, 0, 0, .08);
    }

    .swatch.is-active {
      outline: 2px solid rgb(59 130 246);
      outline-offset: 2px;
    }
  </style>
</head>

<body class="bg-gradient-to-br from-slate-50 to-indigo-50 min-h-screen">
  <div class="max-w-5xl mx-auto p-4 sm:p-6 lg:p-8">
    <header class="mb-4">
      <h1 class="text-2xl sm:text-3xl font-bold tracking-tight text-slate-800">MALL HANKOOK â€” ì•ˆì •í˜• í…ìŠ¤íŠ¸ ì—ë””í„°</h1>
      <p class="text-sm text-slate-500 mt-1">SE2 ë™ì‘ ì›ì¹™ ì¤€ìˆ˜ Â· í† ê¸€ ìœ ì§€ Â· í•œêµ­ì–´ UI Â· ë‹¨ì¶•í‚¤: Ctrl/âŒ˜ + B, U, I</p>
    </header>

    <!-- íˆ´ë°” -->
    <div id="toolbar"
      class="editor-toolbar sticky top-0 z-10 bg-white/80 backdrop-blur border rounded-2xl shadow-sm p-2 flex flex-wrap gap-2">
      <!-- ê¸€ê¼´/í¬ê¸° -->
      <div class="flex items-center gap-2">
        <label class="text-xs text-slate-500">ê¸€ê¼´</label>
        <select id="fontName" class="h-9 px-2 border rounded-md bg-white">
          <option value="">ê¸°ë³¸</option>
          <option value="Pretendard">Pretendard</option>
          <option value="Malgun Gothic">ë§‘ì€ ê³ ë”•</option>
          <option value="Nanum Gothic">ë‚˜ëˆ”ê³ ë”•</option>
          <option value="Arial">Arial</option>
          <option value="Times New Roman">Times New Roman</option>
        </select>
        <label class="text-xs text-slate-500">í¬ê¸°</label>
        <select id="fontSize" class="h-9 px-2 border rounded-md bg-white">
          <option value="3">ê¸°ë³¸(3)</option>
          <option value="1">1</option>
          <option value="2">2</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
          <option value="7">7</option>
        </select>
      </div>

      <div class="w-px h-7 bg-slate-200" aria-hidden="true"></div>

      <!-- ê¸°ë³¸ ì„œì‹ -->
      <div class="flex items-center gap-2">
        <button data-cmd="bold" title="êµµê²Œ (Ctrl/âŒ˜+B)"
          class="toolbar-btn w-9 h-9 flex items-center justify-center border rounded-md bg-white hover:bg-slate-50"><span
            class="font-bold">B</span></button>
        <button data-cmd="italic" title="ê¸°ìš¸ì„ (Ctrl/âŒ˜+I)"
          class="toolbar-btn w-9 h-9 flex items-center justify-center border rounded-md bg-white hover:bg-slate-50"><span
            class="italic">I</span></button>
        <button data-cmd="underline" title="ë°‘ì¤„ (Ctrl/âŒ˜+U)"
          class="toolbar-btn w-9 h-9 flex items-center justify-center border rounded-md bg-white hover:bg-slate-50"><span
            class="underline">U</span></button>
        <button data-cmd="strikeThrough" title="ì·¨ì†Œì„ "
          class="toolbar-btn w-9 h-9 flex items-center justify-center border rounded-md bg-white hover:bg-slate-50"><span
            class="line-through">S</span></button>
      </div>

      <div class="w-px h-7 bg-slate-200" aria-hidden="true"></div>

      <!-- ìƒ‰ìƒ -->
      <div class="flex items-center gap-2">
        <div class="dropdown relative">
          <button title="ê¸€ììƒ‰"
            class="w-9 h-9 border rounded-md bg-white hover:bg-slate-50 flex items-center justify-center">A</button>
          <div
            class="dropdown-menu absolute left-0 mt-2 p-2 bg-white border rounded-xl shadow-lg grid grid-cols-8 gap-1">
            <!-- ì‹¬í”Œ íŒ”ë ˆíŠ¸ -->
            <button data-forecolor="#111827" class="swatch w-6 h-6 rounded border" style="background:#111827"
              title="#111827"></button>
            <button data-forecolor="#374151" class="swatch w-6 h-6 rounded border" style="background:#374151"></button>
            <button data-forecolor="#6b7280" class="swatch w-6 h-6 rounded border" style="background:#6b7280"></button>
            <button data-forecolor="#9ca3af" class="swatch w-6 h-6 rounded border" style="background:#9ca3af"></button>
            <button data-forecolor="#ef4444" class="swatch w-6 h-6 rounded border" style="background:#ef4444"></button>
            <button data-forecolor="#f59e0b" class="swatch w-6 h-6 rounded border" style="background:#f59e0b"></button>
            <button data-forecolor="#10b981" class="swatch w-6 h-6 rounded border" style="background:#10b981"></button>
            <button data-forecolor="#3b82f6" class="swatch w-6 h-6 rounded border" style="background:#3b82f6"></button>
          </div>
        </div>
        <div class="dropdown relative">
          <button title="ë°°ê²½ìƒ‰"
            class="w-9 h-9 border rounded-md bg-white hover:bg-slate-50 flex items-center justify-center">Bg</button>
          <div
            class="dropdown-menu absolute left-0 mt-2 p-2 bg-white border rounded-xl shadow-lg grid grid-cols-8 gap-1">
            <button data-backcolor="#ffffff" class="swatch w-6 h-6 rounded border" style="background:#ffffff"></button>
            <button data-backcolor="#fef3c7" class="swatch w-6 h-6 rounded border" style="background:#fef3c7"></button>
            <button data-backcolor="#fee2e2" class="swatch w-6 h-6 rounded border" style="background:#fee2e2"></button>
            <button data-backcolor="#dcfce7" class="swatch w-6 h-6 rounded border" style="background:#dcfce7"></button>
            <button data-backcolor="#e0e7ff" class="swatch w-6 h-6 rounded border" style="background:#e0e7ff"></button>
            <button data-backcolor="#e5e7eb" class="swatch w-6 h-6 rounded border" style="background:#e5e7eb"></button>
            <button data-backcolor="#fde68a" class="swatch w-6 h-6 rounded border" style="background:#fde68a"></button>
            <button data-backcolor="#fca5a5" class="swatch w-6 h-6 rounded border" style="background:#fca5a5"></button>
          </div>
        </div>
      </div>

      <div class="w-px h-7 bg-slate-200" aria-hidden="true"></div>

      <!-- ì •ë ¬/ëª©ë¡/ë“¤ì—¬ì“°ê¸° -->
      <div class="flex items-center gap-2">
        <button data-cmd="justifyLeft" title="ì™¼ìª½ ì •ë ¬"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">âŸ¸</button>
        <button data-cmd="justifyCenter" title="ê°€ìš´ë° ì •ë ¬"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">â‡”</button>
        <button data-cmd="justifyRight" title="ì˜¤ë¥¸ìª½ ì •ë ¬"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">âŸ¹</button>
        <button data-cmd="insertUnorderedList" title="ë¶ˆë¦¿ ëª©ë¡"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">â€¢</button>
        <button data-cmd="insertOrderedList" title="ìˆ«ì ëª©ë¡"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">1.</button>
        <button data-cmd="outdent" title="ë‚´ì–´ì“°ê¸°"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">â‡¤</button>
        <button data-cmd="indent" title="ë“¤ì—¬ì“°ê¸°"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">â‡¥</button>
      </div>

      <div class="w-px h-7 bg-slate-200" aria-hidden="true"></div>

      <!-- ì¤„ê°„ê²©/ì¸ìš© -->
      <div class="flex items-center gap-2">
        <label class="text-xs text-slate-500">ì¤„ê°„ê²©</label>
        <select id="lineHeight" class="h-9 px-2 border rounded-md bg-white">
          <option value="1">1.0</option>
          <option value="1.2">1.2</option>
          <option value="1.5">1.5</option>
          <option value="1.8" selected>1.8</option>
          <option value="2">2.0</option>
        </select>
        <button id="quoteBtn" title="ì¸ìš©êµ¬"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">â</button>
      </div>

      <div class="ms-auto flex items-center gap-2">
        <button id="linkBtn" title="í•˜ì´í¼ë§í¬"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">ğŸ”—</button>
        <button id="charBtn" title="íŠ¹ìˆ˜ë¬¸ì"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">Î©</button>
        <button id="tableBtn" title="í‘œ ì‚½ì…"
          class="toolbar-btn w-9 h-9 border rounded-md bg-white hover:bg-slate-50">â–¦</button>
        <button id="clearBtn" title="ì„œì‹ ì œê±°" class="w-9 h-9 border rounded-md bg-white hover:bg-slate-50">âš</button>
        <button id="undoBtn" class="w-9 h-9 border rounded-md bg-white hover:bg-slate-50" title="ë˜ëŒë¦¬ê¸°">â†¶</button>
        <button id="redoBtn" class="w-9 h-9 border rounded-md bg-white hover:bg-slate-50" title="ë‹¤ì‹œí•˜ê¸°">â†·</button>
      </div>
    </div>

    <!-- ì—ë””í„° ë°•ìŠ¤ -->
    <div class="mt-3">
      <div id="editor" class="editor-content min-h-[360px] p-5 bg-white border rounded-2xl shadow-sm"
        contenteditable="true">
        
      </div>
    </div>

    <!-- ìƒíƒœë°” -->
    <div id="status" class="mt-2 text-xs text-slate-500">Ready</div>
  </div>

  <script>
    const editor = document.getElementById('editor');
    const toolbar = document.getElementById('toolbar');
    const status = document.getElementById('status');

    // íŒ”ë ˆíŠ¸ í† ê¸€ ìƒíƒœ ì¶”ì  (ê°™ì€ ìƒ‰ ì¬í´ë¦­ ì‹œ í•´ì œ)
    let lastFC = null; // ë§ˆì§€ë§‰ ê¸€ììƒ‰
    let lastBC = null; // ë§ˆì§€ë§‰ ë°°ê²½ìƒ‰

    // ë²„íŠ¼ ëˆ„ë¥¼ ë•Œ í¬ì»¤ìŠ¤ ìœ ì§€(ì˜¤ì‘ë™ ë°©ì§€)
    toolbar.addEventListener('mousedown', (e) => {
      const target = e.target.closest('button, select');
      if (!target) return;
      // selectëŠ” ë“œë¡­ë‹¤ìš´ ì—´ë ¤ì•¼ í•˜ë¯€ë¡œ ë§‰ì§€ ì•ŠìŒ (ë²„íŠ¼ë§Œ ê¸°ë³¸ë™ì‘ ë°©ì§€)
      if (target.tagName === 'BUTTON') {
        e.preventDefault();
        editor.focus();
      }
    });

    // execCommand ë˜í¼
    function doCmd(cmd, value = null) {
      document.execCommand(cmd, false, value);
      updateToolbarState();
      editor.focus();
    }

    // ê¸°ë³¸ ëª…ë ¹ ë²„íŠ¼ë“¤
    toolbar.addEventListener('click', (e) => {
      const btn = e.target.closest('button');
      if (!btn) return;

      const cmd = btn.dataset.cmd;
      if (cmd) return doCmd(cmd);

      if (btn.id === 'linkBtn') {
        const url = prompt('ë§í¬ URLì„ ì…ë ¥í•˜ì„¸ìš”', 'https://');
        if (url) doCmd('createLink', url);
        return;
      }
      if (btn.id === 'charBtn') {
        const ch = prompt('íŠ¹ìˆ˜ë¬¸ì ì…ë ¥ (ì˜ˆ: â˜…, âœ“, â™¥ ë“±)');
        if (ch) document.execCommand('insertText', false, ch);
        return;
      }
      if (btn.id === 'tableBtn') {
        const rows = Math.max(1, parseInt(prompt('í–‰ ìˆ˜', '2') || '2', 10));
        const cols = Math.max(1, parseInt(prompt('ì—´ ìˆ˜', '2') || '2', 10));
        const tbl = document.createElement('table');
        tbl.className = 'w-full border border-slate-200 my-2';
        tbl.style.borderCollapse = 'collapse';
        for (let r = 0; r < rows; r++) {
          const tr = document.createElement('tr');
          for (let c = 0; c < cols; c++) {
            const td = document.createElement('td');
            td.className = 'border border-slate-200 p-2';
            td.innerHTML = '&nbsp;';
            tr.appendChild(td);
          }
          tbl.appendChild(tr);
        }
        insertNodeAtCursor(tbl);
        // í‘œ ë’¤ì— ì…ë ¥ ì´ì–´ê°€ë„ë¡ ì¤„ í•˜ë‚˜ ì¶”ê°€
        const br = document.createElement('p'); br.innerHTML = '<br>';
        insertNodeAfter(tbl, br);
        placeCaretAtEnd(br);
        return;
      }
      if (btn.id === 'clearBtn') {
        // ìƒ‰ìƒ í† ê¸€ ìƒíƒœë„ ì´ˆê¸°í™”
        lastFC = null; lastBC = null;
        clearSwatchActive();
        doCmd('removeFormat');
        doCmd('unlink');
        return;
      }
      if (btn.id === 'undoBtn') return doCmd('undo');
      if (btn.id === 'redoBtn') return doCmd('redo');
    });

    // ìƒ‰ìƒ íŒ”ë ˆíŠ¸(ê¸€ì/ë°°ê²½) + í† ê¸€
    toolbar.addEventListener('click', (e) => {
      const fc = e.target.getAttribute('data-forecolor');
      const bc = e.target.getAttribute('data-backcolor');

      if (fc) {
        // ë™ì¼ ìƒ‰ ì¬í´ë¦­ ì‹œ ê¸°ë³¸ìƒ‰ìœ¼ë¡œ í•´ì œ
        if (lastFC === fc) {
          doCmd('foreColor', '#111827');
          lastFC = null;
        } else {
          doCmd('foreColor', fc);
          lastFC = fc;
        }
        markSwatchActive('data-forecolor', fc, lastFC !== null);
      }

      if (bc) {
        // ë™ì¼ ìƒ‰ ì¬í´ë¦­ ì‹œ í°ìƒ‰ìœ¼ë¡œ í•´ì œ (transparent í˜¸í™˜ ì´ìŠˆ íšŒí”¼)
        if (lastBC === bc) {
          doCmd('hiliteColor', '#ffffff');
          lastBC = null;
        } else {
          // ë¸Œë¼ìš°ì €ì— ë”°ë¼ backColor ëŒ€ì‹  hiliteColor í•„ìš”
          if (!document.queryCommandSupported('hiliteColor')) {
            doCmd('backColor', bc);
          } else {
            doCmd('hiliteColor', bc);
          }
          lastBC = bc;
        }
        markSwatchActive('data-backcolor', bc, lastBC !== null);
      }
    });

    function clearSwatchActive() {
      toolbar.querySelectorAll('.swatch').forEach(s => s.classList.remove('is-active'));
    }
    function markSwatchActive(attr, value, on) {
      // ê°™ì€ íŒ”ë ˆíŠ¸ ê·¸ë£¹ ë‚´ì—ì„œë§Œ ìƒíƒœ ë°˜ì˜
      const menu = document.querySelector(`[${attr}="${value}"]`)?.closest('.dropdown-menu');
      if (!menu) return;
      menu.querySelectorAll('.swatch').forEach(s => s.classList.remove('is-active'));
      if (on) {
        const btn = menu.querySelector(`[${attr}="${value}"]`);
        btn && btn.classList.add('is-active');
      }
    }

    // í°íŠ¸/ì‚¬ì´ì¦ˆ/ì¤„ê°„ê²©
    document.getElementById('fontName').addEventListener('change', (e) => doCmd('fontName', e.target.value));
    document.getElementById('fontSize').addEventListener('change', (e) => doCmd('fontSize', e.target.value));
    document.getElementById('lineHeight').addEventListener('change', (e) => {
      const value = e.target.value;
      wrapLineStyle('line-height', value);
      updateToolbarState();
    });

    // ì¸ìš©êµ¬ í† ê¸€: blockquote ë˜í•‘ (ê²¹ì¹œ ë²”ìœ„ ì•ˆì „ ì²˜ë¦¬)
    document.getElementById('quoteBtn').addEventListener('click', () => {
      toggleBlock('blockquote', 'border-l-4 border-indigo-400 pl-3 text-slate-700');
      updateToolbarState();
    });

    // ë‹¨ì¶•í‚¤ (Ctrl/âŒ˜ + B/I/U)
    editor.addEventListener('keydown', (e) => {
      const meta = e.ctrlKey || e.metaKey;
      if (!meta) return;
      const k = e.key.toLowerCase();
      if (k === 'b') { e.preventDefault(); doCmd('bold'); }
      if (k === 'i') { e.preventDefault(); doCmd('italic'); }
      if (k === 'u') { e.preventDefault(); doCmd('underline'); }
    });

    // ì„ íƒ ë³€ê²½ ì‹œ íˆ´ë°” í† ê¸€ ìƒíƒœ ê°±ì‹ 
    document.addEventListener('selectionchange', () => {
      if (document.activeElement === editor || editor.contains(document.activeElement)) {
        updateToolbarState();
      }
    });

    function updateToolbarState() {
      const map = {
        bold: document.queryCommandState('bold'),
        italic: document.queryCommandState('italic'),
        underline: document.queryCommandState('underline'),
        strikeThrough: document.queryCommandState('strikeThrough'),
        justifyLeft: document.queryCommandState('justifyLeft'),
        justifyCenter: document.queryCommandState('justifyCenter'),
        justifyRight: document.queryCommandState('justifyRight'),
        insertOrderedList: document.queryCommandState('insertOrderedList'),
        insertUnorderedList: document.queryCommandState('insertUnorderedList'),
      };
      toolbar.querySelectorAll('[data-cmd]').forEach((btn) => {
        const c = btn.dataset.cmd;
        if (map[c]) btn.classList.add('active'); else btn.classList.remove('active');
      });
      status.textContent = `B:${map.bold ? 'on' : 'off'} I:${map.italic ? 'on' : 'off'} U:${map.underline ? 'on' : 'off'} Â· ì •ë ¬ L:${map.justifyLeft ? 'on' : 'off'} C:${map.justifyCenter ? 'on' : 'off'} R:${map.justifyRight ? 'on' : 'off'}`;
    }

    // ë¸”ë¡ í† ê¸€ ìœ í‹¸ (blockquote ë“±)
    function toggleBlock(tag, extraClass = '') {
      const sel = window.getSelection();
      if (!sel.rangeCount) return;
      const range = sel.getRangeAt(0);
      let ancestor = range.commonAncestorContainer;
      if (ancestor.nodeType === 3) ancestor = ancestor.parentNode;
      const block = closestTag(ancestor, tag);
      if (block) {
        // í•´ì œ: block ë‚´ì˜ ë‚´ìš©ë§Œ ë‚¨ê¸°ê³  block ì œê±°
        const parent = block.parentNode;
        while (block.firstChild) parent.insertBefore(block.firstChild, block);
        parent.removeChild(block);
      } else {
        const wr = document.createElement(tag);
        if (extraClass) wr.className = extraClass;
        try {
          range.surroundContents(wr);
        } catch (e) {
          // íŒŒí¸ ë²”ìœ„ì¼ ë•Œ ì•ˆì „ ë˜í•‘
          const frag = range.extractContents();
          wr.appendChild(frag);
          range.insertNode(wr);
          placeCaretAtEnd(wr);
        }
      }
    }

    function closestTag(node, tag) {
      tag = tag.toUpperCase();
      while (node && node !== editor) {
        if (node.nodeName === tag) return node;
        node = node.parentNode;
      }
      return null;
    }

    // í˜„ì¬ ë¼ì¸ì„ spanìœ¼ë¡œ ë¬¶ê³  ìŠ¤íƒ€ì¼ ì ìš©
    function wrapLineStyle(prop, value) {
      const sel = window.getSelection();
      if (!sel.rangeCount) return;
      const range = sel.getRangeAt(0);
      const span = document.createElement('span');
      span.style[prop] = value;
      try {
        range.surroundContents(span);
      } catch (e) {
        const frag = range.extractContents();
        span.appendChild(frag);
        range.insertNode(span);
        sel.removeAllRanges();
        const r = document.createRange();
        r.selectNodeContents(span);
        r.collapse(false);
        sel.addRange(r);
      }
    }

    // ì»¤ì„œ ìœ„ì¹˜ì— ë…¸ë“œ ì‚½ì…
    function insertNodeAtCursor(node) {
      const sel = window.getSelection();
      if (!sel.rangeCount) {
        editor.appendChild(node);
        return;
      }
      const range = sel.getRangeAt(0);
      range.deleteContents();
      range.insertNode(node);
    }
    function insertNodeAfter(refNode, newNode) {
      if (refNode.nextSibling) {
        refNode.parentNode.insertBefore(newNode, refNode.nextSibling);
      } else {
        refNode.parentNode.appendChild(newNode);
      }
    }
    function placeCaretAtEnd(node) {
      const range = document.createRange();
      const sel = window.getSelection();
      range.selectNodeContents(node);
      range.collapse(false);
      sel.removeAllRanges();
      sel.addRange(range);
    }

    // ì´ˆê¸° ìƒíƒœ
    editor.focus();
    updateToolbarState();
  </script>
</body>

</html>