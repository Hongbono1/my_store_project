<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ì‡¼í•‘ëª° ìƒì„¸ | MALL HANKOOK</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        .neo-card {
            background: rgba(255, 255, 255, 0.6);
            border-radius: 1rem;
            backdrop-filter: blur(14px);
            box-shadow:
                8px 8px 20px rgba(0, 0, 0, 0.12),
                -8px -8px 20px rgba(255, 255, 255, 0.8);
        }
    </style>
</head>

<body class="bg-gray-100">

    <div id="header"></div>

    <!-- í˜ì´ì§€ ìµœìƒë‹¨ íƒ€ì´í‹€ -->
    <div class="text-center mt-24 mb-6">
        <h1 id="pageShopName" class="text-4xl font-extrabold tracking-tight text-gray-900"></h1>
    </div>

    <div class="max-w-4xl mx-auto mt-8 mb-20 px-4">

        <!-- ëŒ€í‘œ ì´ë¯¸ì§€ -->
        <div id="mainImageBox" class="w-full h-96 rounded-xl overflow-hidden shadow-lg bg-gray-100">
            <img id="mainImage" src="" class="w-full h-full object-contain" />
        </div>

        <!-- ì´ì „/í™ˆ/ë‹¤ìŒ ë²„íŠ¼ -->
        <div class="flex justify-between items-center mt-6">
            <button onclick="history.back()" class="px-6 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg font-semibold">
                â† ì´ì „
            </button>
            <a href="/index" class="px-6 py-2 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-semibold">
                ğŸ  í™ˆ
            </a>
            <button id="nextBtn" class="px-6 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg font-semibold">
                ë‹¤ìŒ â†’
            </button>
        </div>

        <!-- ì‡¼í•‘ëª° ì •ë³´ -->
        <div class="neo-card p-6 mt-6">
            <h2 id="shopName" class="text-3xl font-bold text-gray-800"></h2>
            <p id="shortDesc" class="text-xl text-gray-700 mt-3"></p>

            <!-- ì¹´í…Œê³ ë¦¬ -->
            <span id="categoryTag"
                class="inline-block mt-4 px-4 py-2 bg-indigo-100 text-indigo-600 rounded-full text-base font-semibold"></span>

            <!-- ì‡¼í•‘ëª° ë§í¬ -->
            <div class="mt-5">
                <p class="font-semibold text-gray-700 text-lg">ì‡¼í•‘ëª° ë°”ë¡œê°€ê¸°</p>
                <a id="website" href="#" target="_blank"
                    class="text-blue-600 underline break-all text-lg"></a>
            </div>
        </div>

        <!-- ë°°ë„ˆ ì´ë¯¸ì§€ -->
        <div class="mt-10">
            <h2 class="text-3xl font-bold mb-4">ì‡¼í•‘ëª° ë°°ë„ˆ</h2>
            <div id="bannerGallery" class="grid grid-cols-1 sm:grid-cols-3 gap-4"></div>
        </div>

        <!-- BEST ìƒí’ˆ -->
        <div class="mt-12">
            <h2 class="text-3xl font-bold mb-4">BEST ìƒí’ˆ</h2>
            <div id="bestGallery" class="grid grid-cols-2 sm:grid-cols-4 gap-4"></div>
        </div>

        <!-- ìƒì„¸ ì„¤ëª… (BEST ìƒí’ˆ ì•„ë˜) -->
        <div class="mt-14">
            <h2 class="text-3xl font-bold mb-4">ìƒì„¸ ì†Œê°œ</h2>
            <div id="fullDesc"
                 class="bg-white p-6 rounded-xl shadow-md border border-gray-200 text-[19px] leading-relaxed whitespace-pre-line">
            </div>
        </div>

        <!-- SNS ì˜ì—­ -->
        <div class="mt-12">
            <h2 class="text-3xl font-bold mb-4">SNS</h2>
            <div class="neo-card p-6">
                <div class="space-y-3 text-gray-800 text-lg" id="snsArea">
                    <p><a id="snsInstagram" href="#" target="_blank" class="hover:underline"></a></p>
                    <p><a id="snsYoutube" href="#" target="_blank" class="hover:underline"></a></p>
                    <p><a id="snsBlog" href="#" target="_blank" class="hover:underline"></a></p>
                    <p><a id="snsOther" href="#" target="_blank" class="hover:underline"></a></p>
                </div>
            </div>
        </div>

    </div>

    <div id="footer"></div>

    <script>
        document.addEventListener("DOMContentLoaded", async () => {

            // Header / Footer
            fetch("/components/header.html")
                .then(res => res.text())
                .then(html => document.getElementById("header").innerHTML = html);

            fetch("/components/footer.html")
                .then(res => res.text())
                .then(html => document.getElementById("footer").innerHTML = html);

            // ID ê°€ì ¸ì˜¤ê¸°
            const urlParams = new URLSearchParams(window.location.search);
            const id = urlParams.get("id");

            if (!id) {
                alert("ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤. idê°€ ì—†ìŠµë‹ˆë‹¤.");
                return;
            }

            // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
            const res = await fetch(`/shopping/${id}`);
            const store = await res.json();

            if (!store || !store.id) {
                alert("ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");
                return;
            }

            // ë°ì´í„° ë„£ê¸°
            document.getElementById("pageShopName").textContent = store.shop_name;
            document.getElementById("shopName").textContent = store.shop_name;
            document.getElementById("shortDesc").textContent = store.short_desc;
            document.getElementById("website").textContent = store.website;
            document.getElementById("website").href = store.website;
            document.getElementById("categoryTag").textContent = store.category;

            // SNS ë°ì´í„° ë„£ê¸°
            const instagramLink = document.getElementById("snsInstagram");
            if (store.sns_instagram) {
                instagramLink.innerHTML = `<span class="font-semibold text-gray-900">Instagram:</span> <span class="text-indigo-600">${store.sns_instagram}</span>`;
                instagramLink.href = store.sns_instagram;
            } else {
                instagramLink.parentElement.style.display = "none";
            }

            const youtubeLink = document.getElementById("snsYoutube");
            if (store.sns_youtube) {
                youtubeLink.innerHTML = `<span class="font-semibold text-gray-900">YouTube:</span> <span class="text-indigo-600">${store.sns_youtube}</span>`;
                youtubeLink.href = store.sns_youtube;
            } else {
                youtubeLink.parentElement.style.display = "none";
            }

            const blogLink = document.getElementById("snsBlog");
            if (store.sns_blog) {
                blogLink.innerHTML = `<span class="font-semibold text-gray-900">Blog:</span> <span class="text-indigo-600">${store.sns_blog}</span>`;
                blogLink.href = store.sns_blog;
            } else {
                blogLink.parentElement.style.display = "none";
            }

            const otherLink = document.getElementById("snsOther");
            if (store.sns_other) {
                otherLink.innerHTML = `<span class="font-semibold text-gray-900">ê¸°íƒ€:</span> <span class="text-indigo-600">${store.sns_other}</span>`;
                otherLink.href = store.sns_other;
            } else {
                otherLink.parentElement.style.display = "none";
            }

            // SNS ìˆ¨ê¹€ ì²˜ë¦¬
            const snsArea = document.getElementById("snsArea");
            if (!store.sns_instagram && !store.sns_youtube && !store.sns_blog && !store.sns_other) {
                snsArea.parentElement.parentElement.style.display = "none";
            }

            document.getElementById("fullDesc").textContent = store.full_desc || "";

            // ëŒ€í‘œ ì´ë¯¸ì§€
            if (store.image_main) {
                document.getElementById("mainImage").src = store.image_main;
            }

            // ë°°ë„ˆ ì´ë¯¸ì§€ 3ì¥
            const banners = [store.image_banner1, store.image_banner2, store.image_banner3];
            const bannerBox = document.getElementById("bannerGallery");
            banners.forEach(img => {
                if (img) {
                    const box = document.createElement("div");
                    box.className = "rounded-xl overflow-hidden shadow-lg";
                    box.innerHTML = `<img src="${img}" class="w-full h-40 object-cover"/>`;
                    bannerBox.appendChild(box);
                }
            });

            // BEST ì´ë¯¸ì§€ 4ì¥
            const bests = [store.image_best1, store.image_best2, store.image_best3, store.image_best4];
            const bestBox = document.getElementById("bestGallery");
            bests.forEach(img => {
                if (img) {
                    const box = document.createElement("div");
                    box.className = "rounded-xl overflow-hidden shadow";
                    box.innerHTML = `<img src="${img}" class="w-full h-32 object-cover"/>`;
                    bestBox.appendChild(box);
                }
            });

            // ë‹¤ìŒ ë²„íŠ¼ ê¸°ëŠ¥
            document.getElementById("nextBtn").addEventListener("click", async () => {
                const nextRes = await fetch(`/shopping?limit=1&offset=0`);
                const nextData = await nextRes.json();
                if (nextData && nextData.length > 0) {
                    const nextId = nextData.find(item => item.id > store.id);
                    if (nextId) {
                        window.location.href = `/shoppingdetail.html?id=${nextId.id}`;
                    } else {
                        alert("ë§ˆì§€ë§‰ ì‡¼í•‘ëª°ì…ë‹ˆë‹¤.");
                    }
                } else {
                    alert("ë‹¤ìŒ ì‡¼í•‘ëª°ì´ ì—†ìŠµë‹ˆë‹¤.");
                }
            });

        });
    </script>

</body>

</html>
