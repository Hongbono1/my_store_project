<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>í†µí•© ì •ë³´ ìƒì„¸</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-blue-50 via-white to-blue-100 min-h-screen">
    <main class="flex flex-col lg:flex-row gap-8 max-w-7xl mx-auto p-4">
        <!-- 1. ì™¼ìª½: ì´ë¯¸ì§€/ì§€ë„/ê´‘ê³  -->
        <section class="flex-1 flex flex-col gap-6">
            <div class="rounded-3xl bg-white shadow-xl p-6 flex flex-col items-center">
                <div class="w-full relative">
                    <div id="sliderWrapper" class="relative w-full h-80 rounded-2xl overflow-hidden shadow">
                        <div id="sliderImages" class="flex transition-transform duration-500 ease-in-out h-full"></div>
                        <button id="prevBtn"
                            class="absolute left-2 top-1/2 -translate-y-1/2 bg-black/70 text-white rounded-full px-3 py-1 opacity-80 hover:opacity-100 z-10">â€¹</button>
                        <button id="nextBtn"
                            class="absolute right-2 top-1/2 -translate-y-1/2 bg-black/70 text-white rounded-full px-3 py-1 opacity-80 hover:opacity-100 z-10">â€º</button>
                    </div>
                    <div id="thumbBox" class="flex gap-2 justify-center mt-3"></div>
                </div>
                <div class="text-center font-bold mt-2">ëŒ€í‘œ ì´ë¯¸ì§€</div>
            </div>
            <div class="rounded-3xl bg-white shadow-xl p-6">
                <div class="text-lg font-bold mb-2">ìœ„ì¹˜/ì§€ë„</div>
                <div id="addressText" class="mb-2 text-base"></div>
                <div id="map" class="w-full h-48 bg-gray-100 rounded-xl"></div>
            </div>
            <div class="flex flex-col gap-4">
                <div class="rounded-3xl bg-white shadow-xl p-3">
                    <img src="/images/ad-1.jpg" alt="ê´‘ê³ 1" class="rounded-xl w-full h-28 object-cover" />
                </div>
                <div class="rounded-3xl bg-white shadow-xl p-3">
                    <img src="/images/ad-2.jpg" alt="ê´‘ê³ 2" class="rounded-xl w-full h-28 object-cover" />
                </div>
            </div>
        </section>

        <!-- 2. ê°€ìš´ë°: ëª¨ë“  ê°€ê²Œ ìƒì„¸ì •ë³´ (ëª¨ë“  í•„ë“œ ì¶œë ¥) -->
        <section class="flex-[1.1] flex flex-col gap-6">
            <div class="rounded-3xl bg-white shadow-xl p-6">
                <h2 id="businessNameHeader" class="text-3xl font-bold text-center mb-2"></h2>
                <!-- ì˜ˆì•½ì‹ ì²­ ë²„íŠ¼ ì¶”ê°€ -->
                <div class="flex justify-center mt-2">
                    <button id="reserveBtn"
                        class="bg-blue-500 text-white px-5 py-2 rounded-lg shadow hover:bg-blue-700 transition">ì˜ˆì•½
                        ì‹ ì²­</button>
                </div>
                <div class="flex flex-col gap-1 text-center text-base font-semibold">
                    <div id="businessType"></div>
                    <div id="businessCategory"></div>
                    <div id="deliveryOption"></div>
                    <div id="businessHours"></div>
                </div>
            </div>
            <div class="rounded-2xl bg-blue-50 shadow p-6">
                <div class="font-semibold mb-1">ì„œë¹„ìŠ¤ ë‚´ìš©</div>
                <div id="serviceDetails"></div>
            </div>
            <div class="rounded-2xl bg-yellow-50 shadow p-6">
                <div class="font-semibold mb-1">ì´ë²¤íŠ¸</div>
                <ul id="eventsList" class="list-disc ml-5"></ul>
            </div>
            <div class="rounded-2xl bg-gray-50 shadow p-6">
                <div class="font-semibold mb-1">ê¸°íƒ€ ì •ë³´</div>
                <ul id="infoEtcList" class="list-disc pl-5"></ul>
            </div>
            <div class="rounded-2xl bg-blue-50 shadow p-6">
                <div class="font-semibold mb-1">ì¶”ê°€ ì„¤ëª…</div>
                <div id="additionalDesc"></div>
            </div>
            <div class="rounded-2xl bg-gray-50 shadow p-6">
                <div class="font-semibold mb-1">ì—°ë½ì²˜</div>
                <!-- ì „í™”ë²ˆí˜¸ë¥¼ tel: ë§í¬ë¡œ ê°ì‹¸ê¸° -->
                <div id="contactPhone"></div>
                <div id="contactHomepage"></div>
                <div id="contactInstagram"></div>
                <div id="contactFacebook"></div>
            </div>
        </section>

        <!-- 3. ì˜¤ë¥¸ìª½: ë©”ë‰´/ì¥ë°”êµ¬ë‹ˆ -->
        <section id="menuCartSection" class="flex-1 flex flex-col gap-6">
            <div class="rounded-3xl bg-white shadow-xl p-6">
                <div class="text-xl font-bold mb-4 text-center">ë©”ë‰´</div>
                <div id="menuList" class="flex flex-col gap-3"></div>
            </div>
            <div class="rounded-2xl bg-yellow-50 shadow p-6">
                <div class="font-bold mb-2">ì¥ë°”êµ¬ë‹ˆ</div>
                <ul id="cartItems" class="space-y-2 text-base"></ul>
                <div class="flex justify-between items-center mt-4">
                    <span class="font-bold text-gray-800">í•©ê³„:</span>
                    <span id="cartTotal" class="text-2xl font-bold text-blue-700">0ì›</span>
                </div>
                <button class="mt-3 w-full bg-blue-600 text-white py-2 rounded-lg shadow">ê²°ì œí•˜ê¸°</button>
            </div>
        </section>
    </main>

    <!-- ì´ë¯¸ì§€ ëª¨ë‹¬ ë“± ì¶”ê°€ ê°€ëŠ¥ -->
    <div id="imageModal" class="fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 hidden">
        <div class="relative">
            <img id="modalImage" class="w-[600px] h-[400px] object-contain rounded shadow-xl" />
            <button id="closeModal"
                class="absolute -top-4 -right-4 bg-white text-black rounded-full text-3xl w-10 h-10 flex items-center justify-center z-60 hover:bg-gray-200">Ã—</button>
        </div>
    </div>
    <script type="module">
        // ... (ìŠ¬ë¼ì´ë”/ì§€ë„/ì¹´íŠ¸ êµ¬í˜„ ì½”ë“œëŠ” ìƒëµ, ìœ„ì—ì„œ ì“°ë˜ ê²ƒ ë™ì¼í•˜ê²Œ ì ìš©)
        // ì•„ë˜ ë°ì´í„° ë°”ì¸ë”©ë§Œ ê°•ì¡°

        const $ = id => document.getElementById(id);
        const params = new URLSearchParams(location.search);
        const storeId = params.get("id") || 1;

        // ì™¼ìª½ ëŒ€í‘œ ì´ë¯¸ì§€(ìŠ¬ë¼ì´ë”) ë°ì´í„°
        // ... (ìŠ¬ë¼ì´ë” init í•¨ìˆ˜ ì°¸ê³ , ìµœëŒ€ 3ì¥)
        // ì§€ë„/ì£¼ì†Œë„ map init í•¨ìˆ˜ ì°¸ê³ 

        // ì¤‘ì•™ - ëª¨ë“  í•„ë“œ ì¶œë ¥ (í¼ì—ì„œ ì €ì¥í•œ ê°’ ê·¸ëŒ€ë¡œ)
        $("businessNameHeader").textContent = store.businessName ?? "ìƒí˜¸ëª… ì—†ìŒ";
        $("businessType").textContent = "ì—…ì¢…: " + (store.businessType || "-");
        $("businessCategory").textContent = "ì¹´í…Œê³ ë¦¬: " + (store.businessCategory || "-");
        $("deliveryOption").textContent = "ë°°ë‹¬: " + (store.deliveryOption || "-");
        $("businessHours").textContent = "ì˜ì—…ì‹œê°„: " + (store.businessHours || "-");
        $("serviceDetails").textContent = store.serviceDetails || "-";
        $("eventsList").innerHTML = [store.event1, store.event2].filter(Boolean).map(e => `<li>${e}</li>`).join("");
        $("infoEtcList").innerHTML = `
        <li>ì¥ì• ì¸ í¸ì˜ì‹œì„¤: ${store.facility ?? "-"}</li>
        <li>ë°˜ë ¤ë™ë¬¼ ì¶œì…: ${store.pets ?? "-"}</li>
        <li>ì£¼ì°¨ ì •ë³´: ${store.parking ?? "-"}</li>`;
        $("additionalDesc").textContent = store.additionalDesc || "-";
        $("contactPhone").textContent = store.phoneNumber || "-";
        $("contactHomepage").innerHTML = store.homepage ? `<a href="${store.homepage}" target="_blank">${store.homepage}</a>` : "";
        $("contactInstagram").innerHTML = store.instagram ? `<a href="${store.instagram}" target="_blank">${store.instagram}</a>` : "";
        $("contactFacebook").innerHTML = store.facebook ? `<a href="${store.facebook}" target="_blank">${store.facebook}</a>` : "";

        // í—¤ë”/í‘¸í„° ë¡œë“œ
        window.addEventListener("DOMContentLoaded", () => {
            fetch("/components/header.html").then(r => r.text()).then(html => { $("header-placeholder").innerHTML = html; });
            fetch("/components/footer.html").then(r => r.text()).then(html => { $("footer-placeholder").innerHTML = html; });
        });

        // Kakao SDK ë¡œë“œ
        function loadKakaoSdk() {
            return fetch("/kakao-key")
                .then(r => r.json())
                .then(({ key }) => new Promise((resolve, reject) => {
                    if (!key) return reject("Kakao key not found");
                    const s = document.createElement("script");
                    s.src = `https://dapi.kakao.com/v2/maps/sdk.js?appkey=${key}&autoload=false&libraries=services,clusterer`;
                    s.defer = true;
                    s.onload = () => kakao.maps.load(resolve);
                    s.onerror = () => reject("Kakao SDK load error");
                    document.head.appendChild(s);
                }));
        }

        // ì™¼ìª½ 'ê´‘ê³  2 ë'ì„ ê¸°ì¤€ìœ¼ë¡œ ê°€ìš´ë°/ì˜¤ë¥¸ìª½ ë†’ì´ ë§ì¶¤
        function syncToAdEnd() {
            const anchor = document.getElementById("leftLimit");
            const leftCol = document.getElementById("leftCol");
            if (!anchor || !leftCol) return;

            // ì™¼ìª½ ì„¹ì…˜ì˜ ìœ„Â·ì•„ë˜ íŒ¨ë”©ì„ í•©ì‚°
            const cs = getComputedStyle(leftCol);
            const padTop = parseFloat(cs.paddingTop) || 0;
            const padBottom = parseFloat(cs.paddingBottom) || 0;

            // anchor(ì»¨í…ì¸ ) ë†’ì´ + ì¢Œìš° ë™ì¼ íŒ¨ë”©ì„ í¬í•¨í•´ì•¼ ì„¹ì…˜ í•˜ë‹¨ì´ ì •í™•íˆ ì¼ì¹˜
            const contentH = anchor.getBoundingClientRect().height;
            const targetH = Math.round(contentH + padTop + padBottom + 2); // +2 ë¯¸ì„¸ë³´ì •

            ["centerCol", "rightCol"].forEach(id => {
                const col = document.getElementById(id);
                if (!col) return;

                // ì„¹ì…˜ ìì²´ ë†’ì´ë¥¼ ì™¼ìª½ê³¼ ë™ì¼í•˜ê²Œ
                col.style.height = targetH + "px";

                // ë‚´ë¶€ ìŠ¤í¬ë¡¤ ì˜ì—­ ë†’ì´ = ì„¹ì…˜ ì „ì²´ - ìƒí•˜ íŒ¨ë”©
                const inner = col.querySelector(".col-scroll");
                if (inner) {
                    const ccs = getComputedStyle(col);
                    const cPadTop = parseFloat(ccs.paddingTop) || 0;
                    const cPadBottom = parseFloat(ccs.paddingBottom) || 0;
                    inner.style.height = (targetH - cPadTop - cPadBottom) + "px";
                    inner.style.overflowY = "auto";
                }
            });
        }

        // ì˜ˆì•½ ì‹ ì²­ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
        document.addEventListener("DOMContentLoaded", () => {
            const reserveBtn = document.getElementById("reserveBtn");
            if (reserveBtn) {
                reserveBtn.onclick = () => {
                    alert("ì˜ˆì•½ ì‹ ì²­ ê¸°ëŠ¥ì€ ê³§ ì œê³µë©ë‹ˆë‹¤! (ì—¬ê¸°ì— í¼/ëª¨ë‹¬ ì—°ê²°)");
                    // ë˜ëŠ” ì˜ˆì•½ ëª¨ë‹¬/í˜ì´ì§€ë¡œ ì´ë™
                };
            }
        });

        // ì—°ë½ì²˜: tel: ë§í¬ë¡œ ê°ì‹¸ì„œ ë°”ë¡œ ì „í™”ê±¸ê¸°
        const phoneNum = store.phoneNumber || store.contactPhone || "";
        $("contactPhone").innerHTML = phoneNum
            ? `<a href="tel:${phoneNum.replace(/[^0-9]/g, '')}" class="text-blue-600 underline text-lg">${phoneNum}</a>`
            : "-";

        // ë©”ë‰´ ë Œë”
        const menuList = $("menuList"); menuList.innerHTML = "";
        if (!menus.length) {
            // ë©”ë‰´ê°€ ì—†ìœ¼ë©´ ì˜¤ë¥¸ìª½ ì „ì²´ ì„¹ì…˜ ìˆ¨ê¹€!
            document.getElementById("menuCartSection").style.display = "none";
        } else {
            document.getElementById("menuCartSection").style.display = "";
            // ... ì´í•˜ ë©”ë‰´ í‘œì‹œ ì½”ë“œëŠ” ë™ì¼ ...
            // (ìƒëµ)
        }

        window.addEventListener("DOMContentLoaded", syncToAdEnd);
        window.addEventListener("resize", syncToAdEnd);
        if ("ResizeObserver" in window) {
            const anchorEl = document.getElementById("leftLimit");
            if (anchorEl) new ResizeObserver(syncToAdEnd).observe(anchorEl);
        }

        async function initMap(storeAddress, storeName = "") {
            try {
                await loadKakaoSdk();
                const geocoder = new kakao.maps.services.Geocoder();
                const cleanedAddress = storeAddress.replace(/^\d{5}\s*/, "").replace(/\s+\d+$/, "").trim();
                geocoder.addressSearch(cleanedAddress, (result, status) => {
                    if (status !== kakao.maps.services.Status.OK) return;
                    const coords = new kakao.maps.LatLng(result[0].y, result[0].x);
                    const map = new kakao.maps.Map($("map"), { center: coords, level: 3 });
                    const marker = new kakao.maps.Marker({ map, position: coords });
                    if (storeName) {
                        const ovContent = `
    <div
        style="padding:4px 8px;background:#fff;border:1px solid #666;border-radius:4px;font-size:13px;white-space:nowrap;">
        ${storeName}
    </div>`;
                        const overlay = new kakao.maps.CustomOverlay({
                            position: marker.getPosition(),
                            content: ovContent,
                            yAnchor: 1
                        });
                        overlay.setMap(map);
                    }
                    // ì§€ë„ ë Œë” í›„ ë†’ì´ ì¬ë™ê¸°í™”
                    syncToAdEnd();
                });
            } catch (e) { }
        }

        // ìŠ¬ë¼ì´ë”
        const slider = {
            imgs: [],
            idx: 0,
            init(arr) {
                this.imgs = (arr || []).filter(src => typeof src === "string" && (src.startsWith("http") ||
                    src.startsWith("/"))).map(s => s.trim());
                if (!this.imgs.length) this.imgs = ["/no-image.png"];
                $("sliderImages").innerHTML = this.imgs.map((u, i) => `
    <img src="${u}" data-index="${i}" class="w-full h-full object-cover flex-shrink-0 cursor-pointer" />
    `).join('');
                $("sliderImages").onclick = (e) => {
                    if (e.target.tagName === "IMG") {
                        this.idx = Number(e.target.dataset.index);
                        this.update();
                        openModal(this.imgs[this.idx]);
                    }
                };
                this.renderThumbs();
                this.update();
                $("prevBtn").onclick = () => this.move(-1);
                $("nextBtn").onclick = () => this.move(1);

                const firstImg = $("sliderImages").querySelector('img');
                if (firstImg) {
                    firstImg.onload = () => syncToAdEnd();
                    if (firstImg.complete) syncToAdEnd();
                } else {
                    syncToAdEnd();
                }
            },
            renderThumbs() {
                const box = $("thumbBox");
                box.innerHTML = "";
                this.imgs.forEach((src, i) => {
                    if (!src.startsWith("http") && !src.startsWith("/")) return;
                    const t = document.createElement("img");
                    t.src = src;
                    t.alt = `ì´ë¯¸ì§€ ${i + 1}`;
                    t.className = "w-14 h-14 object-cover rounded cursor-pointer border hover:opacity-80";
                    t.addEventListener("click", () => {
                        this.idx = i; this.update(); openModal(src);
                    });
                    box.appendChild(t);
                });
            },
            move(step) { this.idx = (this.idx + step + this.imgs.length) % this.imgs.length; this.update(); },
            update() {
                $("sliderImages").style.transform = `translateX(${-this.idx * 100}%)`;
                [...$("thumbBox").children].forEach((el, i) => {
                    el.classList.toggle("ring-2", i === this.idx);
                    el.classList.toggle("ring-blue-300", i === this.idx);
                });
            }
        };

        // ëª¨ë‹¬
        (function enableModalKeys() {
            const modal = $("imageModal");
            modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });
            window.addEventListener("keydown", (e) => {
                if (modal.classList.contains("hidden")) return;
                if (e.key === "ArrowLeft") { slider.move(-1); $("modalImage").src = slider.imgs[slider.idx]; }
                if (e.key === "ArrowRight") { slider.move(1); $("modalImage").src = slider.imgs[slider.idx]; }
                if (e.key === "Escape") closeModal();
            });
            $("closeModal").addEventListener('click', closeModal);
        })();
        function openModal(src) { $("modalImage").src = src; $("imageModal").classList.remove("hidden"); }
        function closeModal() { $("imageModal").classList.add("hidden"); }

        // ì¥ë°”êµ¬ë‹ˆ
        const cart = [];
        function addToCart(item) {
            const found = cart.find(c => c.menuName === item.menuName);
            if (found) found.quantity += item.quantity; else cart.push({ ...item });
            renderCart();
        }
        function renderCart() {
            const ul = $("cartItems"); if (!ul) return;
            ul.innerHTML = "";
            let sum = 0;
            cart.forEach((item, index) => {
                const price = Number(item.menuPrice) || 0;
                const qty = Number(item.quantity) || 1;
                const total = price * qty; sum += total;
                const li = document.createElement("li");
                li.className = "flex justify-between items-center text-lg py-2";
                li.innerHTML = `
    <span>${item.menuName} Ã— ${qty}</span>
    <span class="text-xl font-bold">${total.toLocaleString()}ì›</span>
    <button class="removeBtn bg-red-100 text-red-600 px-2 py-1 rounded text-sm ml-2" data-index="${index}">ì‚­ì œ</button>`;
                ul.appendChild(li);
            });
            ul.querySelectorAll(".removeBtn").forEach(btn => {
                btn.onclick = () => { cart.splice(btn.dataset.index, 1); renderCart(); };
            });
            $("cartTotal").textContent = sum.toLocaleString();
        }

        // ë°ì´í„° fetch (ì‹¤ì„œë²„ ì—°ê²° ì‹œ ì—¬ê¸°ë§Œ ë°”ê¾¸ë©´ ë¨)
        (async () => {
            try {
                const res = await fetch(`/store/${window.storeId}`);
                const { store, menus = [] } = await res.json();

                // ìŠ¬ë¼ì´ë”/í…ìŠ¤íŠ¸ ë°”ì¸ë”©
                slider.init(store.images || [store.image1, store.image2, store.image3].filter(Boolean));
                $("businessNameHeader").textContent = store.businessName ?? "ìƒí˜¸ëª… ì—†ìŒ";
                $("businessCategory").innerHTML = `<strong>êµ¬ë¶„:</strong> ${store.category || "ì„ íƒë˜ì§€ ì•ŠìŒ"}`;
                $("businessType").innerHTML = `<strong>ì—…ì¢…:</strong> ${store.businessType || "ì—†ìŒ"}`;
                $("deliveryOption").innerHTML = `<strong>ë°°ë‹¬:</strong> ${store.deliveryOption || "ì—†ìŒ"}`;
                $("businessHours").innerHTML = `<strong>ì˜ì—…ì‹œê°„:</strong> ${store.businessHours || "ì—†ìŒ"}`;
                $("serviceDetails").textContent = store.serviceDetails ?? "ì—†ìŒ";
                $("eventsList").innerHTML = [store.event1, store.event2].filter(Boolean).map(v => `<li>${v}</li>`).join("");
                $("infoEtcList").innerHTML = `
    <li>ì¥ì• ì¸ í¸ì˜ì‹œì„¤: ${store.facility ?? "ì •ë³´ ì—†ìŒ"}</li>
    <li>ë°˜ë ¤ë™ë¬¼ ì¶œì…: ${store.pets ?? "ì •ë³´ ì—†ìŒ"}</li>
    <li>ì£¼ì°¨ ì •ë³´: ${store.parking ?? "ì •ë³´ ì—†ìŒ"}</li>`;
                $("additionalInfoList").innerHTML = `<li>ì„œë¹„ìŠ¤ ë‚´ìš©: ${store.serviceDetails ?? "ì—†ìŒ"}</li>`;
                $("contactPhone").textContent = store.contactPhone ?? "";
                $("contactHomepage").innerHTML = store.homepage ? `<strong>í™ˆí˜ì´ì§€:</strong> <a href="${store.homepage}"
        class="text-blue-600 underline" target="_blank">${store.homepage}</a>` : "";
                $("contactInstagram").innerHTML = store.instagram ? `<strong>ì¸ìŠ¤íƒ€ê·¸ë¨:</strong> <a href="${store.instagram}"
        class="text-blue-600 underline" target="_blank">${store.instagram}</a>` : "";
                $("contactFacebook").innerHTML = store.facebook ? `<strong>í˜ì´ìŠ¤ë¶:</strong> <a href="${store.facebook}"
        class="text-blue-600 underline" target="_blank">${store.facebook}</a>` : "";

                // ë©”ë‰´ê°€ ì—†ìœ¼ë©´ ì˜¤ë¥¸ìª½ ì„¹ì…˜ ìˆ¨ê¹€
                if (!menus.length) {
                    document.getElementById("menuCartSection").style.display = "none";
                } else {
                    document.getElementById("menuCartSection").style.display = "";
                    // ë©”ë‰´ ë Œë”ë§ ì½”ë“œëŠ” ê·¸ëŒ€ë¡œ
                }

                // ë©”ë‰´ ë Œë”
                const menuList = $("menuList"); menuList.innerHTML = "";
                const menuByCategory = {};
                menus.forEach(it => {
                    const raw = it.category ?? it.menu_category ?? it.cat ?? "";
                    const category = raw.replace(/\u3000/g, "").trim() || "ê¸°íƒ€";
                    (menuByCategory[category] ||= []).push(it);
                });
                Object.entries(menuByCategory).forEach(([category, items]) => {
                    const group = document.createElement("div");
                    const title = document.createElement("h3");
                    title.textContent = "ğŸ± " + category;
                    title.className = "text-xl font-bold mt-6 mb-2 text-gray-800";
                    group.appendChild(title);
                    items.forEach(it => {
                        const box = document.createElement("div");
                        box.className = "flex items-center gap-4 p-4 bg-white rounded-lg shadow-sm border";
                        box.innerHTML = `
    <img src="${(it.menu_image && it.menu_image.trim()) ? it.menu_image : '/assets/images/no-thumb.png'}"
        class="w-24 h-24 object-cover rounded-md" />
    <div class="flex-1">
        <div class="text-lg font-bold mb-1 truncate">${it.menuName}</div>
        <div class="text-base font-medium text-gray-700">${Number(it.menuPrice).toLocaleString()}ì›</div>
    </div>
    <div class="flex flex-col items-center gap-1 shrink-0">
        <div class="flex items-center gap-1">
            <button class="decrease px-2 py-1 bg-gray-200 rounded">ï¼</button>
            <span class="quantity w-6 text-center">1</span>
            <button class="increase px-2 py-1 bg-gray-200 rounded">ï¼‹</button>
        </div>
        <button class="addBtn px-3 py-1 bg-blue-600 text-white text-sm rounded">ë‹´ê¸°</button>
    </div>`;
                        let qty = 1;
                        const qtySpan = box.querySelector(".quantity");
                        box.querySelector(".decrease").onclick = () => { if (qty > 1) qtySpan.textContent = --qty; };
                        box.querySelector(".increase").onclick = () => { qtySpan.textContent = ++qty; };
                        box.querySelector(".addBtn").onclick = () => addToCart({ ...it, quantity: qty });
                        group.appendChild(box);
                    });
                    menuList.appendChild(group);
                });

                // ì£¼ì†Œ/ì§€ë„
                const fullAddress = store.address || "";
                const cleaned = fullAddress.replace(/^\d{5}\s*/, "").split(/\s+/).slice(0, 3).join(" ");
                $("addressText").textContent = `ğŸ“ ${cleaned}`;
                initMap(cleaned, store.businessName);

                // ë§ˆì§€ë§‰ìœ¼ë¡œ í•œ ë²ˆ ë” ë™ê¸°í™”
                syncToAdEnd();
            } catch (e) {
                // ì‹¤íŒ¨í•´ë„ ë ˆì´ì•„ì›ƒë§Œì€ ìœ ì§€
                syncToAdEnd();
            }
        })();
    </script>

</body>

</html>