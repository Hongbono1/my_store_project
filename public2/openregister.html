<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ì—ë””í„°(ê²½ëŸ‰) | MALL HANKOOK</title>
    <meta name="color-scheme" content="light" />
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* placeholder for contenteditable */
        [contenteditable][data-placeholder]:empty:before {
            content: attr(data-placeholder);
            color: rgb(156 163 175);
            pointer-events: none;
        }

        /* simple focus outline for accessibility */
        .focus-ring:focus-visible {
            outline: 2px solid rgb(59 130 246);
            outline-offset: 2px;
            border-radius: .5rem;
        }
    </style>
</head>

<body class="bg-gray-50 text-gray-800 antialiased">
    <div class="max-w-4xl mx-auto py-6 px-4">
        <!-- Header -->
        <header class="mb-4">
            <h1 class="text-2xl font-semibold">ì„¤ëª… ì‘ì„± ì—ë””í„°</h1>
            <p class="text-sm text-gray-500">ë„¤ì´ë²„ ë¸”ë¡œê·¸ ëŠë‚Œì˜ ê²½ëŸ‰ ì—ë””í„° (ìˆœìˆ˜ Tailwind + JS)</p>
        </header>

        <!-- Toolbar -->
        <div class="sticky top-0 z-10 bg-white/80 backdrop-blur border border-gray-200 rounded-xl p-2 mb-3 shadow-sm">
            <div class="flex flex-wrap items-center gap-2">

                <!-- Bold -->
                <button type="button" data-cmd="bold"
                    class="group focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm"
                    aria-label="êµµê²Œ" title="êµµê²Œ (Bold)">
                    <span class="font-bold">B</span>
                </button>

                <!-- Underline -->
                <button type="button" data-cmd="underline"
                    class="group focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm"
                    aria-label="ë°‘ì¤„" title="ë°‘ì¤„ (Underline)">
                    <span class="underline underline-offset-2">U</span>
                </button>

                <!-- Bullet List -->
                <button type="button" data-cmd="insertUnorderedList"
                    class="group focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm"
                    aria-label="ê¸€ë¨¸ë¦¬ê¸°í˜¸" title="ê¸€ë¨¸ë¦¬ê¸°í˜¸ (â€¢ ëª©ë¡)">
                    â€¢ ëª©ë¡
                </button>

                <!-- HR -->
                <button type="button" data-cmd="insertHorizontalRule"
                    class="group focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm"
                    aria-label="êµ¬ë¶„ì„ " title="êµ¬ë¶„ì„  (ê°€ë¡œì¤„)">
                    â”€â”€
                </button>

                <span class="mx-1 h-6 w-px bg-gray-200"></span>

                <!-- Image (Upload) -->
                <button type="button" id="btnImageUpload"
                    class="group focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm"
                    aria-label="ì´ë¯¸ì§€ ì‚½ì…(ì—…ë¡œë“œ)" title="ì´ë¯¸ì§€ ì‚½ì… - ë‚´ PCì—ì„œ ì—…ë¡œë“œ">
                    ğŸ–¼ ì—…ë¡œë“œ
                </button>
                <input type="file" id="imageFile" accept="image/*" class="hidden" />

                <!-- Image (URL) -->
                <button type="button" id="btnImageUrl"
                    class="group focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm"
                    aria-label="ì´ë¯¸ì§€ ì‚½ì…(URL)" title="ì´ë¯¸ì§€ ì‚½ì… - ì´ë¯¸ì§€ ì£¼ì†Œë¡œ ì¶”ê°€">
                    ğŸŒ URL
                </button>

                <span class="mx-1 h-6 w-px bg-gray-200"></span>

                <!-- Font Size (px) -->
                <label class="flex items-center gap-2 text-sm">
                    <span class="text-gray-600" title="ì„ íƒ ì˜ì—­ ê¸€ì í¬ê¸°(px) ì ìš©">ê¸€ìí¬ê¸°</span>
                    <input id="fontSizePx" type="number" min="8" max="96" step="1" value="16"
                        class="focus-ring w-20 px-2 py-1 border border-gray-300 rounded-md bg-white" />
                    <span class="text-gray-500">px</span>
                    <button type="button" id="btnApplyFont"
                        class="focus-ring px-3 py-1.5 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm"
                        title="ì„ íƒí•œ ê¸€ìì— í”½ì…€ í¬ê¸° ì ìš©">
                        ì ìš©
                    </button>
                </label>

                <div class="flex-1"></div>

                <!-- View / Copy result -->
                <button type="button" id="btnShowHtml"
                    class="focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm"
                    title="í˜„ì¬ ì‘ì„±í•œ HTMLì„ ë¯¸ë¦¬ë³´ê¸°ë¡œ í™•ì¸">
                    HTML ê²°ê³¼ ë³´ê¸°
                </button>
                <button type="button" id="btnCopyHtml"
                    class="focus-ring px-3 py-2 rounded-lg border border-indigo-200 bg-indigo-50 hover:bg-indigo-100 text-indigo-700 shadow-sm"
                    title="í˜„ì¬ ì‘ì„±í•œ HTMLì„ ë³µì‚¬">
                    ë³µì‚¬í•˜ê¸°
                </button>
            </div>
        </div>

        <!-- Editor -->
        <section class="bg-white border border-gray-200 rounded-2xl p-4 shadow-sm">
            <div id="editor" class="focus-ring min-h-[320px] leading-7 outline-none" contenteditable="true"
                data-placeholder="ì—¬ê¸°ì— ì„¤ëª…ì„ ì‘ì„±í•˜ì„¸ìš”. (í…ìŠ¤íŠ¸, ëª©ë¡, ì´ë¯¸ì§€, êµ¬ë¶„ì„ , ê¸€ìí¬ê¸° px ì ìš© ê°€ëŠ¥)">
                <!-- ì´ˆê¸° ì½˜í…ì¸ ê°€ í•„ìš”í•˜ë©´ ì—¬ê¸°ì— ì‘ì„± -->
            </div>
        </section>

        <!-- Live small preview (optional, lightweight) -->
        <details class="mt-3">
            <summary class="text-sm text-gray-600 cursor-pointer">ê°„ë‹¨ ë¯¸ë¦¬ë³´ê¸°</summary>
            <div id="livePreview" class="mt-2 p-3 border border-gray-200 rounded-xl bg-white"></div>
        </details>

        <!-- Footer helper -->
        <p class="mt-6 text-xs text-gray-500">
            * ê²°ê³¼ HTMLì€ ë‚˜ì¤‘ì— <code>openregister.html</code> / <code>opendetail.html</code>ì˜ <code>description</code>ì— ê·¸ëŒ€ë¡œ
            ë¶™ì—¬ë„£ì–´ ì¬ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
        </p>
    </div>

    <!-- Modal: HTML ê²°ê³¼ ë³´ê¸° -->
    <div id="modal" class="hidden fixed inset-0 z-20 items-center justify-center bg-black/40 p-4">
        <div class="max-w-3xl w-full bg-white rounded-2xl shadow-xl border border-gray-200">
            <div class="flex items-center justify-between px-5 py-3 border-b border-gray-200">
                <h2 class="text-lg font-semibold">HTML ê²°ê³¼</h2>
                <button id="modalClose" class="focus-ring p-1.5 rounded-md hover:bg-gray-100" title="ë‹«ê¸°">âœ•</button>
            </div>
            <div class="p-5 space-y-3">
                <textarea id="resultHtml"
                    class="w-full h-72 p-3 border border-gray-300 rounded-lg font-mono text-sm leading-6"
                    readonly></textarea>
                <div class="flex items-center justify-end gap-2">
                    <button id="btnCopyInModal"
                        class="focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm">
                        ë³µì‚¬í•˜ê¸°
                    </button>
                    <button id="modalClose2"
                        class="focus-ring px-3 py-2 rounded-lg border border-gray-200 bg-white hover:bg-gray-50 shadow-sm">
                        ë‹«ê¸°
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ------ helpers ------
        const editor = document.getElementById('editor');
        const livePreview = document.getElementById('livePreview');

        // execCommand wrapper (deprecated but lightweight & widely supported for simple ops)
        function doCmd(cmd, value = null) {
            document.execCommand(cmd, false, value);
            editor.focus();
            refreshPreview();
        }

        // Apply font size in px by wrapping selection in a <span style="font-size:NNpx">
        function applyFontSizePx(px) {
            px = parseInt(px, 10);
            if (!px || px < 8 || px > 300) return;

            const sel = window.getSelection();
            if (!sel || sel.rangeCount === 0) return;

            const range = sel.getRangeAt(0);
            if (range.collapsed) {
                // If collapsed, insert a span and place cursor inside
                const span = document.createElement('span');
                span.style.fontSize = px + 'px';
                span.appendChild(document.createTextNode('\u200b')); // zero-width space
                range.insertNode(span);

                // move caret after the span
                sel.removeAllRanges();
                const newRange = document.createRange();
                newRange.setStart(span.firstChild, 1);
                newRange.collapse(true);
                sel.addRange(newRange);
            } else {
                // wrap the selected contents
                const span = document.createElement('span');
                span.style.fontSize = px + 'px';
                range.surroundContents(span);
            }
            editor.focus();
            refreshPreview();
        }

        // Insert image from a File -> dataURL
        function insertImageFromFile(file) {
            const reader = new FileReader();
            reader.onload = () => {
                doCmd('insertImage', reader.result);
            };
            reader.readAsDataURL(file);
        }

        // Insert image from URL (basic)
        function insertImageFromUrl(url) {
            if (!url) return;
            doCmd('insertImage', url.trim());
        }

        // Live preview (super lightweight)
        function refreshPreview() {
            if (!livePreview) return;
            livePreview.innerHTML = editor.innerHTML;
        }

        // ------ toolbar actions ------
        document.querySelectorAll('[data-cmd]').forEach(btn => {
            btn.addEventListener('click', () => {
                const cmd = btn.getAttribute('data-cmd');
                doCmd(cmd);
            });
        });

        // Image upload
        const btnImageUpload = document.getElementById('btnImageUpload');
        const imageFile = document.getElementById('imageFile');
        btnImageUpload.addEventListener('click', () => imageFile.click());
        imageFile.addEventListener('change', (e) => {
            const file = e.target.files?.[0];
            if (file) insertImageFromFile(file);
            imageFile.value = '';
        });

        // Image URL
        const btnImageUrl = document.getElementById('btnImageUrl');
        btnImageUrl.addEventListener('click', () => {
            const url = prompt('ì´ë¯¸ì§€ URLì„ ì…ë ¥í•˜ì„¸ìš” (https://...)');
            if (url) insertImageFromUrl(url);
        });

        // Font size apply
        const fontSizePx = document.getElementById('fontSizePx');
        const btnApplyFont = document.getElementById('btnApplyFont');
        btnApplyFont.addEventListener('click', () => applyFontSizePx(fontSizePx.value));
        fontSizePx.addEventListener('keydown', (e) => {
            if (e.key === 'Enter') applyFontSizePx(fontSizePx.value);
        });

        // ------ show/copy HTML ------
        const btnShowHtml = document.getElementById('btnShowHtml');
        const btnCopyHtml = document.getElementById('btnCopyHtml');
        const modal = document.getElementById('modal');
        const resultHtml = document.getElementById('resultHtml');
        const modalClose = document.getElementById('modalClose');
        const modalClose2 = document.getElementById('modalClose2');
        const btnCopyInModal = document.getElementById('btnCopyInModal');

        btnShowHtml.addEventListener('click', () => {
            resultHtml.value = editor.innerHTML.trim();
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            resultHtml.focus();
            resultHtml.select();
        });

        function copyHtml() {
            const html = editor.innerHTML.trim();
            navigator.clipboard?.writeText(html).then(() => {
                btnCopyHtml.textContent = 'ë³µì‚¬ë¨!';
                setTimeout(() => (btnCopyHtml.textContent = 'ë³µì‚¬í•˜ê¸°'), 1200);
            }).catch(() => {
                alert('í´ë¦½ë³´ë“œ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤. ìˆ˜ë™ ë³µì‚¬ë¥¼ ì´ìš©í•˜ì„¸ìš”.');
            });
        }
        btnCopyHtml.addEventListener('click', copyHtml);

        btnCopyInModal.addEventListener('click', () => {
            const html = resultHtml.value;
            navigator.clipboard?.writeText(html).then(() => {
                btnCopyInModal.textContent = 'ë³µì‚¬ë¨!';
                setTimeout(() => (btnCopyInModal.textContent = 'ë³µì‚¬í•˜ê¸°'), 1200);
            }).catch(() => alert('í´ë¦½ë³´ë“œ ê¶Œí•œì´ ê±°ë¶€ë˜ì—ˆìŠµë‹ˆë‹¤.'));
        });

        function closeModal() {
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }
        modalClose.addEventListener('click', closeModal);
        modalClose2.addEventListener('click', closeModal);
        modal.addEventListener('click', (e) => {
            if (e.target === modal) closeModal();
        });

        // Keep preview synced
        editor.addEventListener('input', refreshPreview);
        editor.addEventListener('click', refreshPreview);
        editor.addEventListener('keyup', refreshPreview);

        // initial
        refreshPreview();
    </script>
</body>

</html>