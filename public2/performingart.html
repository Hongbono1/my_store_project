<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ê³µì—° Â· ì˜ˆìˆ  Â· ë²„ìŠ¤ì»¤ ëª©ë¡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=6286d4d9bc1d503495b03f46622b5dc8&libraries=services"></script>

    <style>
        /* glass */
        .glass-box {
            backdrop-filter: blur(14px);
            background: rgba(255, 255, 255, 0.35);
            border-radius: 22px;
            border: 1px solid rgba(255, 255, 255, 0.4);
            box-shadow:
                8px 8px 18px rgba(0, 0, 0, 0.12),
                -5px -5px 16px rgba(255, 255, 255, 0.8),
                inset 0 0 4px rgba(255, 255, 255, 0.3);
        }

        /* card shadow */
        .neo-card {
            border-radius: 18px;
            background: linear-gradient(135deg, #ffffff, #f1f5ff);
            box-shadow:
                8px 8px 20px rgba(0, 0, 0, 0.12),
                -6px -6px 18px rgba(255, 255, 255, 0.85);
        }

        /* section-box: ë„¤ì˜¤ëª¨í”¼ì¦˜ + ê¸€ë˜ìŠ¤ëª¨í”¼ì¦˜ + 3D */
        .section-box {
            position: relative;
            background: linear-gradient(145deg, rgba(255, 255, 255, 0.9), rgba(240, 245, 255, 0.85));
            backdrop-filter: blur(20px) saturate(180%);
            border-radius: 32px;
            border: 2px solid rgba(255, 255, 255, 0.9);
            padding: 2.5rem;
            
            /* ë„¤ì˜¤ëª¨í”¼ì¦˜ ê·¸ë¦¼ì */
            box-shadow:
                /* ë©”ì¸ ì™¸ë¶€ ê·¸ë¦¼ì (ì–´ë‘ìš´ ë©´) */
                12px 12px 24px rgba(0, 0, 0, 0.15),
                /* ë°˜ëŒ€í¸ í•˜ì´ë¼ì´íŠ¸ (ë°ì€ ë©´) */
                -12px -12px 24px rgba(255, 255, 255, 0.9),
                /* 3D ê¹Šì´ê° */
                6px 6px 12px rgba(0, 0, 0, 0.08),
                -6px -6px 12px rgba(255, 255, 255, 0.7),
                /* ë‚´ë¶€ ë°œê´‘ */
                inset 0 1px 2px rgba(255, 255, 255, 0.6),
                inset 0 -1px 2px rgba(0, 0, 0, 0.05);
            
            /* 3D ë³€í˜• */
            transform: perspective(1000px) rotateX(0deg) rotateY(0deg);
            transform-style: preserve-3d;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .section-box::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 32px;
            background: linear-gradient(
                135deg,
                rgba(255, 255, 255, 0.4) 0%,
                rgba(255, 255, 255, 0.1) 50%,
                rgba(200, 220, 255, 0.2) 100%
            );
            pointer-events: none;
            z-index: 1;
        }

        .section-box > div {
            position: relative;
            z-index: 2;
        }

        /* í˜¸ë²„ ì‹œ 3D íš¨ê³¼ */
        .section-box:hover {
            transform: perspective(1000px) rotateX(1deg) translateY(-4px);
            box-shadow:
                16px 16px 32px rgba(0, 0, 0, 0.18),
                -16px -16px 32px rgba(255, 255, 255, 1),
                8px 8px 16px rgba(0, 0, 0, 0.1),
                -8px -8px 16px rgba(255, 255, 255, 0.8),
                inset 0 2px 4px rgba(255, 255, 255, 0.7),
                inset 0 -2px 4px rgba(0, 0, 0, 0.08);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 0.75rem;
            color: #1f2937;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>

<body class="bg-gradient-to-br from-indigo-100 via-blue-50 to-purple-100 min-h-screen">

    <div id="header"></div>

    <!-- ë©”ì¸ ì½˜í…ì¸  -->
    <div class="max-w-7xl mx-auto px-5 py-10">

        <!-- í˜ì´ì§€ ì œëª© -->
        <div class="glass-box p-8 mb-10 text-center">
            <h1 class="text-4xl font-extrabold text-gray-900">ê³µì—° Â· ì˜ˆìˆ  Â· ë²„ìŠ¤ì»¤</h1>
            <p class="text-lg text-gray-600 mt-2">ë‹¤ì–‘í•œ ê³µì—°ê³¼ ì˜ˆìˆ  í–‰ì‚¬ë¥¼ ë§Œë‚˜ë³´ì„¸ìš”</p>
        </div>

        <!-- ê³µì—° ì„¹ì…˜ -->
        <div class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">ğŸ­ ê³µì—°</h2>
            <div class="section-box">
                <div id="performance-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
            </div>
        </div>

        <!-- ì˜ˆìˆ /ì¶•ì œ ì„¹ì…˜ -->
        <div class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">ğŸ¨ ì˜ˆìˆ /ì¶•ì œ</h2>
            <div class="section-box">
                <div id="art-festival-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
            </div>
        </div>

        <!-- ë²„ìŠ¤ì»¤ ì„¹ì…˜ -->
        <div class="mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-6">ğŸ¸ ë²„ìŠ¤ì»¤</h2>
            <div class="section-box">
                <div id="busker-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6"></div>
            </div>
        </div>

    </div>

    <!-- ì´ì „/í™ˆ/ë‹¤ìŒ ë²„íŠ¼ -->
    <div class="fixed bottom-6 right-6 flex flex-col items-center gap-4 z-50">
        <!-- ì´ì „ -->
        <div class="flex flex-col items-center">
            <button onclick="goBack()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow hover:from-gray-200 hover:to-gray-300 transition">
                â†
            </button>
            <span class="text-xs mt-1 text-gray-600 font-semibold">ì´ì „</span>
        </div>

        <!-- ë‹¤ìŒ -->
        <div class="flex flex-col items-center">
            <button onclick="goNext()"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow hover:from-gray-200 hover:to-gray-300 transition">
                â†’
            </button>
            <span class="text-xs mt-1 text-gray-600 font-semibold">ë‹¤ìŒ</span>
        </div>

        <!-- í™ˆ -->
        <div class="flex flex-col items-center">
            <a href="/index.html"
                class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow hover:from-blue-600 hover:to-blue-700 transition">
                ğŸ 
            </a>
            <span class="text-xs mt-1 text-gray-600 font-semibold">í™ˆ</span>
        </div>
    </div>

    <div id="footer"></div>

    <script>
        /* í—¤ë”/í‘¸í„° */
        fetch('components/header.html').then(r => r.text()).then(h => header.innerHTML = h);
        fetch('components/footer.html').then(r => r.text()).then(f => footer.innerHTML = f);

        let allData = [];

        async function loadArts() {
            try {
                const res = await fetch('/api/performingart');
                const json = await res.json();
                
                if (!json.success) {
                    alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                allData = json.data || [];
                renderAllSections();
            } catch (err) {
                console.error('ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', err);
                alert('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        function createCard(item) {
            return `
                <div class="glass-box p-5 hover:shadow-2xl transition cursor-pointer" onclick="location.href='performingartdetail.html?id=${item.id}'">
                    <div class="w-full h-48 bg-gray-200 rounded-xl mb-4 overflow-hidden">
                        ${item.main_img 
                            ? `<img src="${item.main_img}" class="w-full h-full object-cover" alt="${item.title}"/>` 
                            : `<div class="w-full h-full flex items-center justify-center text-gray-400">ì´ë¯¸ì§€ ì—†ìŒ</div>`
                        }
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2 line-clamp-2">${item.title}</h3>
                    <p class="text-sm text-indigo-600 font-semibold mb-2">${item.type || 'ê³µì—°'}</p>
                    <p class="text-xs text-gray-600 mb-1">ğŸ“… ${item.start_date ? item.start_date.split('T')[0] : '-'}</p>
                    <p class="text-xs text-gray-600 mb-1">ğŸ“ ${item.venue || '-'}</p>
                    <p class="text-xs text-gray-600">ğŸ’° ${item.price || '-'}</p>
                </div>
            `;
        }

        function createAdCard() {
            return `
                <div class="glass-box p-5 hover:shadow-2xl transition cursor-pointer bg-gradient-to-br from-yellow-100 to-orange-100">
                    <div class="w-full h-48 bg-gradient-to-br from-yellow-200 to-orange-200 rounded-xl mb-4 flex items-center justify-center">
                        <div class="text-center">
                            <p class="text-4xl mb-2">ğŸ“¢</p>
                            <p class="text-lg font-bold text-gray-700">ê´‘ê³  ë¬¸ì˜</p>
                        </div>
                    </div>
                    <h3 class="text-lg font-bold text-gray-900 mb-2 text-center">ì´ ìë¦¬ì— ê´‘ê³ í•˜ì„¸ìš”</h3>
                    <p class="text-sm text-gray-600 text-center mb-2">ê·€í•˜ì˜ ê³µì—°/í–‰ì‚¬ë¥¼ í™ë³´í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                    <p class="text-xs text-gray-500 text-center">ğŸ“ ë¬¸ì˜: 02-1234-5678</p>
                </div>
            `;
        }

        function renderSection(containerId, items, maxCount = 8) {
            const container = document.getElementById(containerId);
            const cards = [];
            
            // ì‹¤ì œ ë°ì´í„° ì¹´ë“œ
            items.slice(0, maxCount).forEach(item => {
                cards.push(createCard(item));
            });
            
            // 8ê°œ ë¯¸ë§Œì´ë©´ ê´‘ê³  ì¹´ë“œë¡œ ì±„ìš°ê¸°
            const adCount = maxCount - items.length;
            if (adCount > 0) {
                for (let i = 0; i < adCount; i++) {
                    cards.push(createAdCard());
                }
            }
            
            container.innerHTML = cards.join('');
        }

        function renderAllSections() {
            // ê³µì—°
            const performances = allData.filter(item => item.type === 'ê³µì—°');
            renderSection('performance-list', performances, 8);
            
            // ì˜ˆìˆ /ì¶•ì œ (ì˜ˆìˆ /ë¬¸í™” + ì¶•ì œ í•©ì¹˜ê¸°)
            const artFestival = allData.filter(item => item.type === 'ì˜ˆìˆ /ë¬¸í™”' || item.type === 'ì¶•ì œ');
            renderSection('art-festival-list', artFestival, 8);
            
            // ë²„ìŠ¤ì»¤
            const buskers = allData.filter(item => item.type === 'ë²„ìŠ¤ì»¤');
            renderSection('busker-list', buskers, 8);
        }

        function goBack() { window.history.back(); }
        function goNext() { window.history.forward(); }

        loadArts();
    </script>

</body>
</html>
