<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¤í† ì–´ í”„ë¼ì´ë“œ ëª¨ìŒ | MALL HANKOOK</title>
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            background: linear-gradient(135deg, #eef2ff, #e0e7ff, #f8fafc);
            font-family: Pretendard, -apple-system, BlinkMacSystemFont, sans-serif;
            min-height: 100vh;
        }

        /* ğŸ”¥ ë„¤ì˜¤ëª¨í”¼ì¦˜ ê³µí†µ */
        .neo-box {
            background: #eef2ff;
            border-radius: 22px;
            box-shadow:
                10px 10px 20px #c7cffc,
                -10px -10px 20px #ffffff;
        }

        /* ğŸ”¥ ê¸€ë˜ìŠ¤ëª¨í”¼ì¦˜ */
        .glass {
            backdrop-filter: blur(15px);
            background: rgba(255, 255, 255, 0.28);
            border: 1px solid rgba(255, 255, 255, 0.32);
        }

        /* 3D Hover */
        .card-3d {
            transition: all 0.25s ease;
            transform-style: preserve-3d;
        }

        .card-3d:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, .15);
        }
    </style>
</head>

<body>

    <!-- Header -->
    <div id="header"></div>

    <div class="max-w-screen-xl mx-auto px-4 sm:px-8 mt-12 mb-20">

        <!-- ğŸŸ¦ íƒ€ì´í‹€ ì˜ì—­ -->
        <section class="glass neo-box p-10 mb-16 relative">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-800 text-center tracking-tight drop-shadow-md">
                âœ¨ ìš°ë¦¬ê°€ê²Œ ìë‘ ëª¨ìŒ
            </h1>

            <a href="/storeprideregister.html"
                class="absolute right-6 top-6 bg-blue-600 text-white px-5 py-2 rounded-xl shadow-lg hover:bg-blue-700 transition">
                + ë“±ë¡í•˜ê¸°
            </a>
        </section>

        <!-- ğŸŸ¦ ìš°ë¦¬ê°€ê²Œ ìë‘ ë°•ìŠ¤ ê·¸ë£¹ (2ê°œì”© ë¬¶ìŒ) -->
        <section class="neo-box glass p-8 mb-16">
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-center">ê°€ê²Œ ìë‘ BEST</h2>

            <div id="hotNeighborhoodBoxes" class="grid grid-cols-1 sm:grid-cols-2 gap-10"></div>
        </section>

        <!-- ğŸŸ¦ ìºëŸ¬ì…€ ìŠ¬ë¼ì´ë“œ -->
        <section class="neo-box glass p-4 mb-20 relative">
            <h2 class="text-3xl font-bold text-gray-800 text-center mb-6">ì˜¤ëŠ˜ì˜ ì¶”ì²œ ìë‘</h2>

            <div class="relative overflow-hidden w-full">
                <div id="sliderContainer" class="flex transition-transform duration-500 h-60 items-center px-6"></div>

                <!-- Prev/Next -->
                <button id="prevBtn"
                    class="absolute left-4 top-1/2 -translate-y-1/2 bg-white/70 backdrop-blur px-4 py-3 rounded-full shadow hover:bg-white">
                    â—€
                </button>
                <button id="nextBtn"
                    class="absolute right-4 top-1/2 -translate-y-1/2 bg-white/70 backdrop-blur px-4 py-3 rounded-full shadow hover:bg-white">
                    â–¶
                </button>
            </div>
        </section>

        <!-- ğŸŸ¦ ì¶”ì²œ ê°€ê²Œ ì„¹ì…˜ -->
        <section class="neo-box glass p-8">
            <h2 class="text-3xl font-bold text-center text-gray-800 mb-10">ê¸ˆì£¼ì˜ ì¶”ì²œ ê°€ê²Œ</h2>

            <div class="grid grid-cols-1 lg:grid-cols-5 gap-6 items-stretch">

                <!-- ì™¼ìª½ ë§Œí™” ì´ë¯¸ì§€ 2ê°œ -->
                <div class="lg:col-span-1 flex flex-col gap-6">
                    <div class="flex-1 neo-box overflow-hidden">
                        <img src="https://via.placeholder.com/300x400?text=ë§Œí™”1"
                            class="w-full h-full object-cover rounded-xl">
                    </div>
                    <div class="flex-1 neo-box overflow-hidden">
                        <img src="https://via.placeholder.com/300x400?text=ë§Œí™”2"
                            class="w-full h-full object-cover rounded-xl">
                    </div>
                </div>

                <!-- ì˜¤ë¥¸ìª½ ì¶”ì²œ ê°€ê²Œ ì¹´ë“œ -->
                <div id="recommendedStoreContainer"
                    class="lg:col-span-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>

            </div>
        </section>

    </div>

    <div id="footer"></div>

    <!-- ========== JS ë¡œì§ ê·¸ëŒ€ë¡œ ìœ ì§€(ê¸°ëŠ¥ ì •ìƒì‘ë™) ========== -->

    <script>
        /* Header/Footer */
        fetch('components/header.html').then(r => r.text()).then(d => header.innerHTML = d);
        fetch('components/footer.html').then(r => r.text()).then(d => footer.innerHTML = d);

        /* ì¹´ë“œ ìƒì„± */
        function createAdCard(ad) {
            if (!ad) return createEmptyAdCard();

            const adBox = document.createElement("div");
            adBox.className =
                "neo-box glass p-6 rounded-2xl shadow flex flex-col card-3d";

            // ì´ë¯¸ì§€ ê²½ë¡œ ì²˜ë¦¬
            let imgSrc = '/assets/images/no-thumb.png';
            if (ad.main_image) {
                imgSrc = ad.main_image.startsWith('/uploads/') || ad.main_image.startsWith('http') 
                    ? ad.main_image 
                    : `/uploads/${ad.main_image}`;
            }

            adBox.innerHTML = `
        <img src="${imgSrc}"
             class="h-40 w-full object-cover rounded-xl mb-4 shadow">
        <h2 class="text-2xl font-bold text-center text-gray-800 mb-1">${ad.store_name}</h2>
        <p class="text-center text-gray-600">${ad.phone || ''}</p>
        <a href="/substorepride.html?id=${ad.pride_id}"
           class="mt-4 bg-blue-600 text-white text-center py-2 rounded-xl shadow hover:bg-blue-700 transition">
           ìì„¸íˆ ë³´ê¸°
        </a>
      `;
            return adBox;
        }

        function createEmptyAdCard() {
            const div = document.createElement("div");
            div.className = "neo-box glass p-6 opacity-50 rounded-xl";
            div.innerHTML = `
        <div class="w-full h-40 bg-gray-200 rounded-xl mb-4"></div>
        <p class="text-center text-gray-400">ì •ë³´ ì—†ìŒ</p>
      `;
            return div;
        }

        function renderAdBoxes(containerId, ads, perBox = 2, total = 8) {
            const container = document.getElementById(containerId);
            container.innerHTML = "";

            const data = [...ads.slice(0, total)];
            while (data.length < total) data.push(null);

            for (let i = 0; i < total; i += perBox) {
                const box = document.createElement("div");
                box.className = "neo-box glass p-5 rounded-2xl flex flex-col md:flex-row gap-6 card-3d";

                for (let j = 0; j < perBox; j++) {
                    box.appendChild(createAdCard(data[i + j]));
                }
                container.appendChild(box);
            }
        }

        function renderAds(containerId, ads, total = 8) {
            const container = document.getElementById(containerId);
            container.innerHTML = "";

            const data = [...ads.slice(0, total)];
            while (data.length < total) data.push(null);

            data.forEach(ad => container.appendChild(createAdCard(ad)));
        }

        async function safeFetch(url) {
            try {
                const r = await fetch(url);
                if (r.ok) return await r.json();
            } catch {
                return [];
            }
            return [];
        }

        /* ìŠ¬ë¼ì´ë“œ ì¹´ë“œ */
        function createSimpleSlideAdCard(ad) {
            const div = document.createElement("div");
            div.className = "flex-shrink-0 w-64 mx-3 cursor-pointer card-3d";

            // ì´ë¯¸ì§€ ê²½ë¡œ ì²˜ë¦¬
            let imgSrc = '/assets/images/no-thumb.png';
            if (ad.main_image) {
                imgSrc = ad.main_image.startsWith('/uploads/') || ad.main_image.startsWith('http') 
                    ? ad.main_image 
                    : `/uploads/${ad.main_image}`;
            }

            div.innerHTML = `
        <div class="neo-box glass p-4 rounded-2xl shadow flex flex-col items-center">
          <img src="${imgSrc}"
               class="w-full h-36 object-cover rounded-xl mb-3">
          <h3 class="font-bold text-center text-gray-700">${ad.store_name || ''}</h3>
        </div>
      `;

            div.onclick = () => location.href = `/substorepride.html?id=${ad.pride_id}`;
            return div;
        }

        async function renderSliderAds() {
            const slider = document.getElementById("sliderContainer");

            let ads = await safeFetch("/slide/api");
            if (!ads.length) ads = Array(5).fill({});

            slider.innerHTML = "";
            ads.forEach(ad => slider.appendChild(createSimpleSlideAdCard(ad)));

            let idx = 0, total = ads.length;

            const update = () => {
                slider.style.transform = `translateX(-${idx * 17}rem)`;
            };

            prevBtn.onclick = () => { idx = (idx - 1 + total) % total; update(); };
            nextBtn.onclick = () => { idx = (idx + 1) % total; update(); };

            update();
        }

        /* ë©”ì¸ ë¡œë”© */
        document.addEventListener("DOMContentLoaded", async () => {
            const prideList = await safeFetch("/storepride/list");

            renderAdBoxes("hotNeighborhoodBoxes", prideList);
            renderAds("recommendedStoreContainer", prideList);
            renderSliderAds();
        });

    </script>

</body>

</html>