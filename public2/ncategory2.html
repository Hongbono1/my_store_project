<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>카테고리 페이지</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 네오모피즘 카드 */
        .neo-card {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 1.2rem;
            box-shadow:
                6px 6px 16px #d9e0ec,
                -6px -6px 16px #ffffff;
            backdrop-filter: blur(16px) saturate(120%);
            transition: all .25s ease;
        }

        .neo-card:hover {
            transform: translateY(-4px);
            box-shadow:
                4px 4px 12px #cfd8e6,
                -4px -4px 12px #ffffff,
                0 8px 24px rgba(80, 130, 255, 0.15);
        }

        /* 3D 버튼 */
        .btn-3d {
            background: linear-gradient(90deg, #6dd5fa, #2980b9);
            border-radius: 1.3rem;
            padding: .5rem 1.5rem;
            font-weight: bold;
            color: white;
            box-shadow: 0 4px 0 #2393b3, 0 8px 16px rgba(0, 64, 128, 0.14);
            transition: all .15s;
        }

        .btn-3d:active {
            transform: translateY(2px);
            box-shadow: 0 2px 0 #2393b3, 0 4px 10px rgba(0, 64, 128, 0.16);
        }

        /* 가로 스크롤 영역 */
        .scroll-x {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            scrollbar-width: thin;
        }

        .scroll-x::-webkit-scrollbar {
            height: 6px;
        }

        .scroll-x::-webkit-scrollbar-thumb {
            background: #a3bffa;
            border-radius: 9999px;
        }

        /* 사이드바 스크롤바 - 사용 안 할 때 숨김 */
        .sidebar-scroll {
            overflow-y: auto;
            scrollbar-width: thin;
            scrollbar-color: transparent transparent;
        }

        .sidebar-scroll:hover {
            scrollbar-color: #cbd5e1 transparent;
        }

        .sidebar-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar-scroll::-webkit-scrollbar-track {
            background: transparent;
        }

        .sidebar-scroll::-webkit-scrollbar-thumb {
            background: transparent;
            border-radius: 9999px;
        }

        .sidebar-scroll:hover::-webkit-scrollbar-thumb {
            background: #cbd5e1;
        }

        .sidebar-scroll::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
    </style>
</head>

<body class="bg-gradient-to-br from-blue-50 via-white to-blue-100 min-h-screen text-gray-800">
    <!-- ✅ header.html 불러오기 -->
    <div id="header-placeholder"></div>

    <header class="py-6 text-center">
        <h1 class="text-3xl font-bold text-blue-700">우리동네 가게</h1>
        <p class="text-gray-600 mt-1">어떤 가게를 찾으세요?</p>
    </header>

    <div class="max-w-6xl mx-auto grid grid-cols-12 gap-6 py-6 px-4">

        <!-- 좌측 사이드바 -->
        <aside class="col-span-3 neo-card p-3 h-full min-h-[1400px] sidebar-scroll">
            <h2 class="font-bold text-2xl mb-4 text-center">CATEGORY</h2>
            <ul class="space-y-3">

                <!-- 병원 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        병 원 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=hospital&category=종합병원"
                                class="block px-5 py-2 neo-card text-center">종합병원</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=내과"
                                class="block px-3 py-2 neo-card text-center">내과</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=치과"
                                class="block px-3 py-2 neo-card text-center">치과</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=소아과"
                                class="block px-3 py-2 neo-card text-center">소아과</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=정형외과"
                                class="block px-3 py-2 neo-card text-center">정형외과</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=산부인과"
                                class="block px-3 py-2 neo-card text-center">산부인과</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=한의원"
                                class="block px-3 py-2 neo-card text-center">한의원</a></li>
                        <li><a href="/subcategory.html?type=hospital&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 약국 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        약 국 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=pharmacy&category=일반약국"
                                class="block px-3 py-2 neo-card text-center">일반약국</a></li>
                        <li><a href="/subcategory.html?type=pharmacy&category=24시약국"
                                class="block px-3 py-2 neo-card text-center">24시약국</a></li>
                        <li><a href="/subcategory.html?type=pharmacy&category=한약방"
                                class="block px-3 py-2 neo-card text-center">한약방</a></li>
                        <li><a href="/subcategory.html?type=pharmacy&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 어린이집 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-12 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        어린이집 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-1 hidden">
                        <li><a href="/subcategory.html?type=kindergarten&category=국공립"
                                class="block px-3 py-2 neo-card text-center">어린이집 통합</a></li>
                    </ul>
                </li>

                <!-- 학원 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        학 원 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=academy&category=입시학원"
                                class="block px-3 py-2 neo-card text-center">입시학원</a></li>
                        <li><a href="/subcategory.html?type=academy&category=영어"
                                class="block px-3 py-2 neo-card text-center">영어</a></li>
                        <li><a href="/subcategory.html?type=academy&category=수학"
                                class="block px-3 py-2 neo-card text-center">수학</a></li>
                        <li><a href="/subcategory.html?type=academy&category=음악"
                                class="block px-3 py-2 neo-card text-center">음악</a></li>
                        <li><a href="/subcategory.html?type=academy&category=미술"
                                class="block px-3 py-2 neo-card text-center">미술</a></li>
                        <li><a href="/subcategory.html?type=academy&category=컴퓨터"
                                class="block px-3 py-2 neo-card text-center">컴퓨터</a></li>
                        <li><a href="/subcategory.html?type=academy&category=체육"
                                class="block px-3 py-2 neo-card text-center">체육</a></li>
                        <li><a href="/subcategory.html?type=academy&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 마트 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        마 트 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=mart&category=대형마트"
                                class="block px-3 py-2 neo-card text-center">대형마트</a></li>
                        <li><a href="/subcategory.html?type=mart&category=중소마트"
                                class="block px-3 py-2 neo-card text-center">중소마트</a></li>
                        <li><a href="/subcategory.html?type=mart&category=슈퍼마켓"
                                class="block px-3 py-2 neo-card text-center">슈퍼마켓</a></li>
                        <li><a href="/subcategory.html?type=mart&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 편의점 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-14 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        편의점 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=store&category=CU"
                                class="block px-3 py-2 neo-card text-center">CU</a></li>
                        <li><a href="/subcategory.html?type=store&category=GS25"
                                class="block px-3 py-2 neo-card text-center">GS25</a></li>
                        <li><a href="/subcategory.html?type=store&category=세븐일레븐"
                                class="block px-3 py-2 neo-card text-center">세븐일레븐</a></li>
                        <li><a href="/subcategory.html?type=store&category=이마트24"
                                class="block px-3 py-2 neo-card text-center">이마트24</a></li>
                        <li><a href="/subcategory.html?type=store&category=미니스톱"
                                class="block px-3 py-2 neo-card text-center">미니스톱</a></li>
                        <li><a href="/subcategory.html?type=store&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 운동 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        운 동 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=exercise&category=헬스장"
                                class="block px-3 py-2 neo-card text-center">헬스장</a></li>
                        <li><a href="/subcategory.html?type=exercise&category=필라테스"
                                class="block px-3 py-2 neo-card text-center">필라테스</a></li>
                        <li><a href="/subcategory.html?type=exercise&category=요가"
                                class="block px-3 py-2 neo-card text-center">요가</a></li>
                        <li><a href="/subcategory.html?type=exercise&category=태권도"
                                class="block px-3 py-2 neo-card text-center">태권도</a></li>
                        <li><a href="/subcategory.html?type=exercise&category=스포츠센터"
                                class="block px-3 py-2 neo-card text-center">스포츠센터</a></li>
                        <li><a href="/subcategory.html?type=exercise&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 미용/이발 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-11 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        미용/이발 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=beauty&category=미용"
                                class="block px-3 py-2 neo-card text-center">미용</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=이발"
                                class="block px-3 py-2 neo-card text-center">이발</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=네일"
                                class="block px-3 py-2 neo-card text-center">네일</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=피부관리"
                                class="block px-3 py-2 neo-card text-center">피부관리</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=왁싱"
                                class="block px-3 py-2 neo-card text-center">왁싱</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 스터디/독서실 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-8 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        스터디/독서실 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=beauty&category=스터디룸"
                                class="block px-3 py-2 neo-card text-center">스터디룸</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=독서실"
                                class="block px-3 py-2 neo-card text-center">독서실</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=도서관"
                                class="block px-3 py-2 neo-card text-center">도서관</a></li>
                        <li><a href="/subcategory.html?type=beauty&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 목욕 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        목 욕 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=beauty&category=목욕"
                                class="block px-3 py-2 neo-card text-center">목욕 전체</a></li>
                    </ul>
                </li>

                <!-- 세탁/옷수선 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-10 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        세탁/옷수선 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=laundry&category=세탁_옷_신발수선"
                                class="block px-3 py-2 neo-card text-center">세탁/옷수선 전체</a></li>
                    </ul>
                </li>

                <!-- 숙박 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-16 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        숙 박 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=stay&category=호텔"
                                class="block px-3 py-2 neo-card text-center">호텔</a></li>
                        <li><a href="/subcategory.html?type=stay&category=모텔"
                                class="block px-3 py-2 neo-card text-center">모텔</a></li>
                        <li><a href="/subcategory.html?type=stay&category=게스트하우스"
                                class="block px-3 py-2 neo-card text-center">게스트하우스</a></li>
                        <li><a href="/subcategory.html?type=stay&category=펜션"
                                class="block px-3 py-2 neo-card text-center">펜션</a></li>
                        <li><a href="/subcategory.html?type=stay&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 중고/구제 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-12 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        중고/구제 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=used&category=중고가전"
                                class="block px-3 py-2 neo-card text-center">중고가전</a></li>
                        <li><a href="/subcategory.html?type=used&category=중고가구"
                                class="block px-3 py-2 neo-card text-center">중고가구</a></li>
                        <li><a href="/subcategory.html?type=used&category=중고명품"
                                class="block px-3 py-2 neo-card text-center">중고명품</a></li>
                        <li><a href="/subcategory.html?type=used&category=리사이클"
                                class="block px-3 py-2 neo-card text-center">리사이클</a></li>
                        <li><a href="/subcategory.html?type=used&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 자동차 정비/수리 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-6 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        자동차 정비/수리 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=car&category=카센터"
                                class="block px-3 py-2 neo-card text-center">카센터</a></li>
                        <li><a href="/subcategory.html?type=car&category=정비소"
                                class="block px-3 py-2 neo-card text-center">정비소</a></li>
                        <li><a href="/subcategory.html?type=car&category=자동차용품"
                                class="block px-3 py-2 neo-card text-center">자동차용품</a></li>
                        <li><a href="/subcategory.html?type=car&category=타이어"
                                class="block px-3 py-2 neo-card text-center">타이어 전문점</a></li>
                        <li><a href="/subcategory.html?type=car&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 주유소 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-14 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        주유소 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=gas&category=직영주유소"
                                class="block px-3 py-2 neo-card text-center">직영주유소</a></li>
                        <li><a href="/subcategory.html?type=gas&category=알뜰주유소"
                                class="block px-3 py-2 neo-card text-center">알뜰주유소</a></li>
                        <li><a href="/subcategory.html?type=gas&category=충전소"
                                class="block px-3 py-2 neo-card text-center">충전소</a></li>
                        <li><a href="/subcategory.html?type=gas&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 반려동물 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-12 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        반려동물 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=pet&category=동물병원"
                                class="block px-3 py-2 neo-card text-center">동물병원</a></li>
                        <li><a href="/subcategory.html?type=pet&category=애견미용"
                                class="block px-3 py-2 neo-card text-center">애견미용</a></li>
                        <li><a href="/subcategory.html?type=pet&category=애견호텔"
                                class="block px-3 py-2 neo-card text-center">애견호텔</a></li>
                        <li><a href="/subcategory.html?type=pet&category=애견카페"
                                class="block px-3 py-2 neo-card text-center">애견카페</a></li>
                        <li><a href="/subcategory.html?type=pet&category=동물용품"
                                class="block px-3 py-2 neo-card text-center">동물용품</a></li>
                        <li><a href="/subcategory.html?type=pet&category=펫시터"
                                class="block px-3 py-2 neo-card text-center">펫시터</a></li>
                        <li><a href="/subcategory.html?type=pet&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 가전제품 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-12 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        가전제품 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=electronics&category=가전판매"
                                class="block px-3 py-2 neo-card text-center">가전판매</a></li>
                        <li><a href="/subcategory.html?type=electronics&category=가전수리"
                                class="block px-3 py-2 neo-card text-center">가전수리</a></li>
                        <li><a href="/subcategory.html?type=electronics&category=휴대폰"
                                class="block px-3 py-2 neo-card text-center">휴대폰</a></li>
                        <li><a href="/subcategory.html?type=electronics&category=PC수리"
                                class="block px-3 py-2 neo-card text-center">PC수리</a></li>
                        <li><a href="/subcategory.html?type=electronics&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 철물/자재 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-11 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        철물/자재 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=materials&category=철물점"
                                class="block px-3 py-2 neo-card text-center">철물점</a></li>
                        <li><a href="/subcategory.html?type=materials&category=건축자재"
                                class="block px-3 py-2 neo-card text-center">건축자재</a></li>
                        <li><a href="/subcategory.html?type=materials&category=인테리어자재"
                                class="block px-3 py-2 neo-card text-center">인테리어자재</a></li>
                        <li><a href="/subcategory.html?type=materials&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 간판/광고 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-11 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        간판/광고 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=sign&category=간판제작"
                                class="block px-3 py-2 neo-card text-center">간판제작</a></li>
                        <li><a href="/subcategory.html?type=sign&category=인쇄"
                                class="block px-3 py-2 neo-card text-center">인쇄</a></li>
                        <li><a href="/subcategory.html?type=sign&category=홍보물"
                                class="block px-3 py-2 neo-card text-center">홍보물</a></li>
                        <li><a href="/subcategory.html?type=sign&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 통신/인터넷/TV -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-7 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        통신/인터넷/TV <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=telecom&category=SK"
                                class="block px-3 py-2 neo-card text-center">SK</a></li>
                        <li><a href="/subcategory.html?type=telecom&category=KT"
                                class="block px-3 py-2 neo-card text-center">KT</a></li>
                        <li><a href="/subcategory.html?type=telecom&category=LG"
                                class="block px-3 py-2 neo-card text-center">LG</a></li>
                        <li><a href="/subcategory.html?type=telecom&category=인터넷_TV"
                                class="block px-3 py-2 neo-card text-center">인터넷_TV</a></li>
                        <li><a href="/subcategory.html?type=telecom&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>

                <!-- 안경/사진/꽃집 -->
                <li class="mb-5">
                    <button
                        class="w-full text-left pl-7 pr-3 py-2 neo-card flex justify-between items-center font-bold text-xl"
                        onclick="toggleSub(this)">
                        안경/사진/꽃집 <span>▼</span>
                    </button>
                    <ul class="ml-4 mt-1 space-y-3 hidden">
                        <li><a href="/subcategory.html?type=shop&category=안경점"
                                class="block px-3 py-2 neo-card text-center">안경점</a></li>
                        <li><a href="/subcategory.html?type=shop&category=사진관"
                                class="block px-3 py-2 neo-card text-center">사진관</a></li>
                        <li><a href="/subcategory.html?type=shop&category=꽃집"
                                class="block px-3 py-2 neo-card text-center">꽃집</a></li>
                        <li><a href="/subcategory.html?type=shop&category=화원"
                                class="block px-3 py-2 neo-card text-center">화원</a></li>
                        <li><a href="/subcategory.html?type=shop&category=기타"
                                class="block px-3 py-2 neo-card text-center">기타</a></li>
                    </ul>
                </li>
            </ul>

            <!-- ✅ 광고 박스 -->
            <div class="neo-card mt-6 p-4 text-center border-2 border-dashed border-blue-300">
                <h3 class="font-bold text-lg mb-2">광고 영역</h3>
                <p class="text-sm text-gray-600">이곳은 광고 배너/이미지가 들어갈 박스입니다.</p>
                <img src="/uploads/sample-ad.jpg" alt="광고 이미지" class="mt-3 w-full h-[30px] object-cover rounded-xl">
            </div>
        </aside>

        <!-- 중앙 메인 -->
        <main class="col-span-9 space-y-8">

            <!-- 메인 배너 -->
            <section class="relative h-60 neo-card flex items-center justify-center">
                <div class="text-center">
                    <h1 class="text-3xl font-bold mb-2">Premium 카테고리</h1>
                    <p class="text-gray-600 text-sm">카테고리 설명 문구를 여기에 넣습니다.</p>
                </div>
            </section>

            <!-- 파워 광고 -->
            <section class="mt-10">
                <h2 class="font-bold text-2xl text-purple-600 text-center mb-4">강력 추천</h2>

                <div id="powerViewport" class="relative overflow-hidden">
                    <div id="powerAdTrack"
                        class="flex transition-transform duration-500 ease-in-out will-change-transform">

                        <!-- 그룹 1 -->
                        <div class="power-group flex basis-full shrink-0">
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="1">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 1"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 1</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 한식</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="2">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 2"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 2</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 카페</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="3">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 3"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 3</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 미용실</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>

                        <!-- 그룹 2 -->
                        <div class="power-group flex basis-full shrink-0">
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="4">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 4"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 4</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 한식</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="5">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 5"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 5</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 카페</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="6">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 6"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 6</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 미용실</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>

                        <!-- 그룹 3 -->
                        <div class="power-group flex basis-full shrink-0">
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="7">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 7"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 7</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 한식</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="8">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 8"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 8</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 카페</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                            <div class="w-1/3 px-2">
                                <a href="#" class="block" data-ad-slot data-page="ncategory2"
                                    data-position="ncategory2_power" data-priority="9">
                                    <div
                                        class="neo-card p-0 overflow-hidden relative rounded-2xl border-4 border-yellow-200">
                                        <img src="/uploads/no-image.png" alt="상호명 9"
                                            class="w-full h-60 md:h-64 object-cover" data-ad-img>
                                        <div
                                            class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                            <div class="font-bold text-lg" data-ad-title>상호명 9</div>
                                            <div class="text-sm text-slate-600" data-ad-cat>업종: 미용실</div>
                                        </div>
                                    </div>
                                </a>
                            </div>
                        </div>

                    </div>

                    <button id="prevBtn"
                        class="absolute left-0 top-1/2 -translate-y-1/2 bg-white shadow rounded-full px-3 py-2">‹</button>
                    <button id="nextBtn"
                        class="absolute right-0 top-1/2 -translate-y-1/2 bg-white shadow rounded-full px-3 py-2">›</button>
                </div>
            </section>

            <!-- 최고의 가게 영역 -->
            <section class="grid grid-cols-12 gap-6 items-stretch">

                <!-- 좌측: MVP + HIGHLIGHT -->
                <div class="col-span-3 h-full">
                    <div class="neo-card p-4 w-full h-full flex flex-col gap-4">

                        <!-- MVP -->
                        <div class="flex-1 flex flex-col">
                            <h2 class="font-bold text-2xl text-blue-600 text-center mb-3">MVP</h2>
                            <a href="#" class="block h-full" data-ad-slot data-page="ncategory2"
                                data-position="ncategory2_mvp" data-priority="1">
                                <div
                                    class="neo-card p-0 overflow-hidden relative rounded-2xl h-full border-2 border-blue-500">
                                    <img src="/uploads/no-image.png" class="w-full h-full object-cover"
                                        alt="상호명 Top" data-ad-img>
                                    <div
                                        class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                        <div class="font-bold text-lg leading-tight" data-ad-title>상호명 Top</div>
                                        <div class="text-sm text-slate-600" data-ad-cat>업종: 한식</div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <!-- HIGHLIGHT -->
                        <div class="flex-1 flex flex-col">
                            <h2 class="font-bold text-2xl text-yellow-600 text-center mb-3">HIGHLIGHT</h2>
                            <a href="#" class="block h-full" data-ad-slot data-page="ncategory2"
                                data-position="ncategory2_highlight" data-priority="1">
                                <div
                                    class="neo-card p-0 overflow-hidden relative rounded-2xl h-full border-2 border-yellow-500">
                                    <img src="/uploads/no-image.png" class="w-full h-full object-cover"
                                        alt="상호명 Bottom" data-ad-img>
                                    <div
                                        class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-2 text-center">
                                        <div class="font-bold text-lg leading-tight" data-ad-title>상호명 Bottom</div>
                                        <div class="text-sm text-slate-600" data-ad-cat>업종: 카페</div>
                                    </div>
                                </div>
                            </a>
                        </div>

                    </div>
                </div>

                <!-- 우측: 최고의 가게 -->
                <div class="col-span-9 flex flex-col gap-6">
                    <div class="neo-card p-5">
                        <h2 class="font-bold mb-3 text-2xl text-center">최고의 가게</h2>

                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">

                            <a href="#" class="block group" data-ad-slot data-page="ncategory2"
                                data-position="ncategory2_best" data-priority="1">
                                <div class="neo-card p-0 overflow-hidden relative rounded-2xl transition-transform">
                                    <div class="w-full h-60">
                                        <img src="/uploads/no-image.png" alt="상호명 A" class="w-full h-full object-cover"
                                            data-ad-img>
                                    </div>
                                    <div
                                        class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-3">
                                        <div class="font-bold text-lg leading-tight" data-ad-title>상호명 A</div>
                                        <div class="text-sm text-slate-600" data-ad-cat>업종: 한식</div>
                                    </div>
                                </div>
                            </a>

                            <a href="#" class="block group" data-ad-slot data-page="ncategory2"
                                data-position="ncategory2_best" data-priority="2">
                                <div class="neo-card p-0 overflow-hidden relative rounded-2xl transition-transform">
                                    <div class="w-full h-60">
                                        <img src="/uploads/no-image.png" alt="상호명 B" class="w-full h-full object-cover"
                                            data-ad-img>
                                    </div>
                                    <div
                                        class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-3">
                                        <div class="font-bold text-lg leading-tight" data-ad-title>상호명 B</div>
                                        <div class="text-sm text-slate-600" data-ad-cat>업종: 분식</div>
                                    </div>
                                </div>
                            </a>

                            <a href="#" class="block group" data-ad-slot data-page="ncategory2"
                                data-position="ncategory2_best" data-priority="3">
                                <div class="neo-card p-0 overflow-hidden relative rounded-2xl transition-transform">
                                    <div class="w-full h-60">
                                        <img src="/uploads/no-image.png" alt="상호명 C" class="w-full h-full object-cover"
                                            data-ad-img>
                                    </div>
                                    <div
                                        class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-3">
                                        <div class="font-bold text-lg leading-tight" data-ad-title>상호명 C</div>
                                        <div class="text-sm text-slate-600" data-ad-cat>업종: 일식</div>
                                    </div>
                                </div>
                            </a>

                            <a href="#" class="block group" data-ad-slot data-page="ncategory2"
                                data-position="ncategory2_best" data-priority="4">
                                <div class="neo-card p-0 overflow-hidden relative rounded-2xl transition-transform">
                                    <div class="w-full h-60">
                                        <img src="/uploads/no-image.png" alt="상호명 D" class="w-full h-full object-cover"
                                            data-ad-img>
                                    </div>
                                    <div
                                        class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-3">
                                        <div class="font-bold text-lg leading-tight" data-ad-title>상호명 D</div>
                                        <div class="text-sm text-slate-600" data-ad-cat>업종: 중식</div>
                                    </div>
                                </div>
                            </a>

                            <a href="#" class="block group" data-ad-slot data-page="ncategory2"
                                data-position="ncategory2_best" data-priority="5">
                                <div class="neo-card p-0 overflow-hidden relative rounded-2xl transition-transform">
                                    <div class="w-full h-60">
                                        <img src="/uploads/no-image.png" alt="상호명 E" class="w-full h-full object-cover"
                                            data-ad-img>
                                    </div>
                                    <div
                                        class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-3">
                                        <div class="font-bold text-lg leading-tight" data-ad-title>상호명 E</div>
                                        <div class="text-sm text-slate-600" data-ad-cat>업종: 치킨</div>
                                    </div>
                                </div>
                            </a>

                            <a href="#" class="block group" data-ad-slot data-page="ncategory2"
                                data-position="ncategory2_best" data-priority="6">
                                <div class="neo-card p-0 overflow-hidden relative rounded-2xl transition-transform">
                                    <div class="w-full h-60">
                                        <img src="/uploads/no-image.png" alt="상호명 F" class="w-full h-full object-cover"
                                            data-ad-img>
                                    </div>
                                    <div
                                        class="absolute left-3 right-3 bottom-3 bg-white/70 backdrop-blur-md rounded-xl shadow px-4 py-3">
                                        <div class="font-bold text-lg leading-tight" data-ad-title>상호명 F</div>
                                        <div class="text-sm text-slate-600" data-ad-cat>업종: 카페</div>
                                    </div>
                                </div>
                            </a>

                        </div>
                    </div>
                </div>

            </section>

            <!-- ✅ 하단 박스 두 개 (광고 슬롯 연결) -->
            <div class="grid grid-cols-2 gap-6">
              <!-- 하단 박스 1 : DB(ncategory2_bottom_1, priority=1) 매칭 -->
              <a href="#"
                 class="neo-card p-0 overflow-hidden relative rounded-2xl block"
                 data-ad-slot data-page="ncategory2"
                 data-position="ncategory2_bottom" data-priority="1">
                <img src="/uploads/no-image.png" alt="하단 박스 1" class="w-full h-32 object-cover" data-ad-img>
                <div class="p-4 text-center">
                  <h3 class="font-bold text-base mb-1" data-ad-title>하단 박스 1</h3>
                  <p class="text-gray-600 text-xs" data-ad-cat>업종: </p>
                </div>
              </a>

              <!-- 하단 박스 2 : (현재 DB에 ncategory2_bottom_2가 없으면 샘플 그대로 유지됨) -->
              <a href="#"
                 class="neo-card p-0 overflow-hidden relative rounded-2xl block"
                 data-ad-slot data-page="ncategory2"
                 data-position="ncategory2_bottom" data-priority="2">
                <img src="/uploads/no-image.png" alt="하단 박스 2" class="w-full h-32 object-cover" data-ad-img>
                <div class="p-4 text-center">
                  <h3 class="font-bold text-base mb-1" data-ad-title>하단 박스 2</h3>
                  <p class="text-gray-600 text-xs" data-ad-cat>업종: </p>
                </div>
              </a>
            </div>

            <!-- 오른쪽 하단 세로 네비게이션 -->
            <div class="fixed bottom-6 right-6 flex flex-col items-center gap-4 z-50">

                <div class="flex flex-col items-center">
                    <button onclick="goBack()"
                        class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow hover:from-gray-200 hover:to-gray-300 transition">
                        ←
                    </button>
                    <span class="text-xs mt-1 text-gray-600 font-semibold">이전</span>
                </div>

                <div class="flex flex-col items-center">
                    <button onclick="goNext()"
                        class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-gray-100 to-gray-200 text-gray-700 shadow hover:from-gray-200 hover:to-gray-300 transition">
                        →
                    </button>
                    <span class="text-xs mt-1 text-gray-600 font-semibold">다음</span>
                </div>

                <div class="flex flex-col items-center">
                    <a href="/index.html"
                        class="w-14 h-14 flex items-center justify-center rounded-full bg-gradient-to-br from-blue-500 to-blue-600 text-white shadow hover:from-blue-600 hover:to-blue-700 transition">
                        🏠
                    </a>
                    <span class="text-xs mt-1 text-gray-600 font-semibold">홈</span>
                </div>
            </div>

            <!-- ✅ footer.html 불러오기 -->
            <div id="footer-placeholder"></div>

            <script>
                // ✅ header/footer 동적 포함
                fetch("/components/header.html")
                    .then(r => r.text())
                    .then(d => document.getElementById("header-placeholder").innerHTML = d);

                fetch("/components/footer.html")
                    .then(r => r.text())
                    .then(d => document.getElementById("footer-placeholder").innerHTML = d);

                // ✅ 서브카테고리 토글
                function toggleSub(btn) {
                    const ul = btn.nextElementSibling;
                    if (!ul) return;
                    ul.classList.toggle("hidden");
                }

                // ✅ 모든 이미지에 onerror 핸들러 추가 (404 에러 방지)
                document.addEventListener("DOMContentLoaded", () => {
                    document.querySelectorAll("img").forEach(img => {
                        if (!img.onerror) {
                            img.onerror = function() {
                                this.onerror = null; // 무한 루프 방지
                                this.src = "/uploads/no-image.png";
                            };
                        }
                    });
                });

                // =========================================================
                // ✅ (푸드 아님) 카테고리 페이지 슬롯 연결 로직
                //    - 기존 샘플 카드 유지(연결 실패 시 그대로)
                //    - ncategory2 쪽(통합가게) 라우터 기준으로 기본값 설정
                // =========================================================
                const AD_API_BASE = "/ncategory2manager/ad"; // 필요 시 너 라우터에 맞게 변경

                function cleanStr(v) {
                    if (v === undefined || v === null) return "";
                    return String(v).trim();
                }

                function buildStoreLink(store_type, store_id) {
                    const t = cleanStr(store_type);
                    const id = cleanStr(store_id);
                    if (!id) return "#";

                    // ✅ 통합 가게 상세 페이지(너가 쓰는 ndetail 기준)
                    // store_type 값이 "combined" / "combined_store_info" / "combined_store" 등으로 와도 대응
                    if (t.includes("combined")) return `/ndetail.html?id=${encodeURIComponent(id)}&type=combined`;
                    if (t === "store_info") return `/ndetail.html?id=${encodeURIComponent(id)}&type=store_info`;

                    // 그 외는 일단 type 없이(필요하면 여기에 매핑 추가)
                    return `/ndetail.html?id=${encodeURIComponent(id)}`;
                }

                function normalizeItems(payload) {
                    if (!payload) return [];
                    // 가능한 케이스들 전부 흡수
                    const arr =
                        payload.items ||
                        payload.rows ||
                        payload.data ||
                        payload.result ||
                        (Array.isArray(payload) ? payload : null);

                    return Array.isArray(arr) ? arr : [];
                }

                async function fetchSlotItems(page) {
                    // 1순위: slot-items로 한번에 받기
                    const url = `${AD_API_BASE}/slot-items?page=${encodeURIComponent(page)}`;
                    const res = await fetch(url, { cache: "no-store" });
                    if (!res.ok) throw new Error(`slot-items HTTP ${res.status}`);
                    const json = await res.json();
                    if (json && json.success === false) throw new Error(json.error || "slot-items fail");
                    return normalizeItems(json);
                }

                function applyItemToCard(anchorEl, item) {
                    if (!anchorEl || !item) return;

                    const imgEl = anchorEl.querySelector("[data-ad-img]");
                    const titleEl = anchorEl.querySelector("[data-ad-title]");
                    const catEl = anchorEl.querySelector("[data-ad-cat]");

                    const image_url = cleanStr(item.image_url || item.image || item.img_url);
                    const business_name = cleanStr(item.business_name || item.store_name || item.title || item.text_content);
                    const business_category = cleanStr(item.business_category || item.category || item.store_category);

                    // 링크 우선순위: link_url > store_type+store_id 조합
                    const href =
                        cleanStr(item.link_url) ||
                        buildStoreLink(item.store_type || item.store_table || item.detail_type, item.store_id || item.id);

                    if (href && href !== "#") anchorEl.href = href;

                    if (imgEl && image_url) imgEl.src = image_url;
                    if (titleEl && business_name) titleEl.textContent = business_name;
                    if (catEl && business_category) catEl.textContent = `업종: ${business_category}`;
                }

                function indexByPositionPriority(items) {
                    const map = new Map();
                    for (const it of items) {
                        const page = cleanStr(it.page || it.slot_page || it.ad_page || "");
                        const position = cleanStr(it.position || it.slot_position || it.pos || "");
                        const priority = cleanStr(it.priority ?? it.rank ?? it.order ?? "");
                        const key = `${page}|${position}|${priority}`;
                        map.set(key, it);
                    }
                    return map;
                }

                async function hydrateAds() {
                    const page = "ncategory2";

                    // DOM에 박혀있는 슬롯 카드들
                    const nodes = Array.from(document.querySelectorAll("[data-ad-slot]"));
                    console.log(`🔍 [hydrateAds] 슬롯 카드 ${nodes.length}개 발견`);
                    if (!nodes.length) return;

                    try {
                        const items = await fetchSlotItems(page);
                        console.log(`📦 [hydrateAds] API 응답: ${items.length}개 광고 데이터`, items);

                        // page 값이 없고 position/priority만 오는 케이스도 많아서 보정
                        // (page가 비어있으면 여기서 강제로 page=ncategory2로 취급)
                        for (const it of items) {
                            if (!it.page && !it.slot_page && !it.ad_page) it.page = page;
                        }

                        const map = indexByPositionPriority(items);
                        console.log(`🗺️ [hydrateAds] 매핑된 광고:`, map);

                        for (const a of nodes) {
                            const p = cleanStr(a.getAttribute("data-page"));
                            const pos = cleanStr(a.getAttribute("data-position"));
                            const pri = cleanStr(a.getAttribute("data-priority"));
                            
                            const key1 = `${p}|${pos}|${pri}`;
                            let ad = map.get(key1);

                            if (!ad) {
                                const key2 = `${p}|${pos}_${pri}|1`;
                                ad = map.get(key2);
                            }

                            if (!ad) continue; // 없는 슬롯은 스킵(기본 카드 유지)

                            applyItemToCard(a, ad);
                        }

                        // 파워 슬라이더는 이미지 변경 후 리사이즈 한번
                        const viewport = document.getElementById("powerViewport");
                        const track = document.getElementById("powerAdTrack");
                        if (viewport && track) {
                            const slideWidth = viewport.clientWidth;
                            // 현재 transform이 있으면 유지하면서 "정렬"만 다시
                            // (강제로 0으로 보내면 랜덤 시작이 깨질 수 있어서 여기선 건드리지 않음)
                            // 대신 레이아웃 계산만 유도
                            track.style.willChange = "transform";
                            track.getBoundingClientRect();
                            track.style.willChange = "transform";
                        }

                    } catch (err) {
                        console.error("❌ [hydrateAds] category slot hydrate 실패:", err?.message || err);
                        // 실패해도 샘플 카드 그대로 유지(요구사항)
                    }
                }

                // =========================================================
                // ✅ 파워 광고 슬라이더(기존 로직 그대로)
                // =========================================================
                document.addEventListener("DOMContentLoaded", () => {
                    const viewport = document.getElementById("powerViewport");
                    const track = document.getElementById("powerAdTrack");
                    if (!viewport || !track) return;

                    // ✅ 먼저 슬롯 연결 시도(샘플 유지 + 덮어쓰기 방식)
                    hydrateAds();

                    let groups = track.querySelectorAll(".power-group").length;
                    let index = Math.floor(Math.random() * groups);
                    console.log(`🎲 파워 슬라이더 랜덤 시작: ${index + 1}번째 그룹`);

                    let dir = 1;

                    function updateSlider() {
                        const slideWidth = viewport.clientWidth;
                        track.style.transform = `translateX(${-index * slideWidth}px)`;
                    }

                    function stepAuto() {
                        if (groups <= 1) return;
                        if (index >= groups - 1) dir = -1;
                        else if (index <= 0) dir = 1;
                        index = index + dir;
                        updateSlider();
                    }

                    function nextManual() {
                        if (groups <= 1) return;
                        if (index < groups - 1) index++;
                        else { dir = -1; index = Math.max(0, groups - 2); }
                        updateSlider();
                    }

                    function prevManual() {
                        if (groups <= 1) return;
                        if (index > 0) index--;
                        else { dir = 1; index = Math.min(groups - 1, 1); }
                        updateSlider();
                    }

                    const nextBtn = document.getElementById("nextBtn");
                    const prevBtn = document.getElementById("prevBtn");

                    if (nextBtn && prevBtn) {
                        nextBtn.addEventListener("click", () => { stopAuto(); nextManual(); startAuto(); });
                        prevBtn.addEventListener("click", () => { stopAuto(); prevManual(); startAuto(); });
                    }

                    window.addEventListener("resize", updateSlider);

                    const INTERVAL = 10000;
                    let timer = null;
                    function startAuto() { if (!timer) timer = setInterval(stepAuto, INTERVAL); }
                    function stopAuto() { if (timer) { clearInterval(timer); timer = null; } }

                    document.addEventListener("visibilitychange", () => {
                        document.hidden ? stopAuto() : startAuto();
                    });

                    viewport.addEventListener("mouseenter", stopAuto);
                    viewport.addEventListener("mouseleave", startAuto);

                    updateSlider();
                    startAuto();
                });
            </script>

            <script>
                function goBack() {
                    if (document.referrer && document.referrer !== location.href) {
                        window.history.back();
                    } else {
                        window.location.href = "/category.html";
                    }
                }

                function goNext() {
                    window.history.forward();
                }
            </script>

        </main>
    </div>

</body>

</html>