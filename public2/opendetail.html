<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ì˜¤í”ˆ ì˜ˆì • ìƒì„¸ | MALL HANKOOK</title>
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Kakao ì§€ë„ -->
  <script src="https://dapi.kakao.com/v2/maps/sdk.js?appkey=6286d4d9bc1d503495b03f46622b5dc8&autoload=false&libraries=services"></script>

  <style>
    body{
      font-family:Pretendard,system-ui,-apple-system,Segoe UI,Roboto,'Noto Sans KR',sans-serif;
      min-height:100vh;
      background:
        radial-gradient(circle at top left, #dbeafe, #eef2ff 35%, #f9fafb 75%),
        linear-gradient(135deg, #e5e7eb, #f9fafb);
      color:#0f172a;
    }
    .neo-card{
      background:rgba(255,255,255,.86);
      backdrop-filter:blur(16px);
      -webkit-backdrop-filter:blur(16px);
      border-radius:1.5rem;
      border:1px solid rgba(255,255,255,.75);
      box-shadow:10px 14px 28px rgba(15,23,42,.14), -8px -8px 20px rgba(255,255,255,.9);
    }
    .title-grad{
      background:linear-gradient(90deg,#2563eb,#7c3aed,#f97316);
      -webkit-background-clip:text;background-clip:text;color:transparent;
    }
    .btn-3d{
      border-radius:999px;
      box-shadow:0 8px 20px rgba(15,23,42,.15), 0 0 0 1px rgba(255,255,255,.7) inset;
      transition:transform .15s ease, box-shadow .15s ease;
    }
    .btn-3d:hover{transform:translateY(-1px);box-shadow:0 12px 26px rgba(15,23,42,.18),0 0 0 1px rgba(255,255,255,.9) inset}
    .btn-3d:active{transform:translateY(0);box-shadow:0 6px 14px rgba(15,23,42,.2),0 0 0 1px rgba(255,255,255,.7) inset}

    /* âœ… â€œëª¨ë‹¬ì´ ê¸°ë³¸ìœ¼ë¡œ ì—´ë ¤ ë³´ì„â€ì„ ê°•ì œë¡œ ì°¨ë‹¨ */
    #descModal[hidden]{display:none !important;}

    /* âœ… ëª¨ë‹¬ ìŠ¤í¬ë¡¤ */
    .scrollbox{
      overflow-y:scroll;            /* í•­ìƒ ìŠ¤í¬ë¡¤ íŠ¸ë™ì´ ë³´ì´ê²Œ(ë¸Œë¼ìš°ì €ë³„ ì°¨ì´ ìˆìŒ) */
      scrollbar-gutter: stable;     /* ì§€ì› ë¸Œë¼ìš°ì €ì—ì„œ ë ˆì´ì•„ì›ƒ í”ë“¤ë¦¼ ë°©ì§€ */
    }
    .scrollbox::-webkit-scrollbar{width:10px}
    .scrollbox::-webkit-scrollbar-thumb{
      background:rgba(15,23,42,.18);
      border-radius:999px;
      border:3px solid rgba(255,255,255,.65);
    }
    .scrollbox::-webkit-scrollbar-track{
      background:rgba(15,23,42,.06);
      border-radius:999px;
    }

    /* âœ… ë¯¸ë¦¬ë³´ê¸° ì¤„ ì œí•œ (í”ŒëŸ¬ê·¸ì¸ ì—†ì´) */
    .line-clamp-6{
      display:-webkit-box;
      -webkit-line-clamp:6;
      -webkit-box-orient:vertical;
      overflow:hidden;
    }
  </style>
</head>

<body class="min-h-screen">
  <div id="header"></div>

  <main class="mx-auto max-w-6xl px-4 sm:px-6 lg:px-8 pb-16 pt-6">
    <section class="mb-6 sm:mb-8">
      <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4">
        <div>
          <p class="text-xs font-semibold text-indigo-500 uppercase tracking-wide mb-1">Open Soon</p>
          <h1 id="heroName" class="title-grad text-2xl sm:text-3xl md:text-4xl font-extrabold tracking-tight">
            ì˜¤í”ˆ ì˜ˆì • ê°€ê²Œ
          </h1>
          <p class="text-sm text-slate-500 mt-1">ë¯¸ë¦¬ ê°€ê²Œ ì •ë³´ë¥¼ í™•ì¸í•´ ë‘ê³ , ì˜¤í”ˆí•˜ë©´ ê°€ì¥ ë¨¼ì € ë°©ë¬¸í•´ ë³´ì„¸ìš”.</p>

          <!-- âœ… ë²„ì „ ì²´í¬(ë°˜ì˜ í™•ì¸ìš©) -->
          <p class="mt-2 text-[11px] text-slate-400">OPENDETAIL VERSION: 2025-12-12-v2</p>
        </div>

        <a href="/open.html"
          class="btn-3d inline-flex items-center gap-2 px-4 py-2 bg-white/90 text-xs sm:text-sm font-semibold text-slate-700 border border-slate-200 hover:bg-slate-50">
          <span class="text-lg leading-none">â†</span><span>ì˜¤í”ˆ ì˜ˆì • ëª©ë¡ìœ¼ë¡œ</span>
        </a>
      </div>
    </section>

    <section class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-7">

      <!-- ëŒ€í‘œ ì‚¬ì§„ -->
      <article class="neo-card p-4 sm:p-5 flex flex-col min-h-[260px]">
        <header class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2 text-sm font-semibold text-slate-600">
            <span class="text-lg">ğŸ“¸</span><span>ëŒ€í‘œ ì‚¬ì§„</span>
          </div>
          <span class="text-[11px] text-slate-400">í”„ë¦¬ë·° ì´ë¯¸ì§€</span>
        </header>

        <div class="relative flex-1 rounded-2xl overflow-hidden border border-slate-100 bg-slate-900/5">
          <img id="storeImage" src="/uploads/no-thumb.png" alt="ëŒ€í‘œ ì´ë¯¸ì§€" class="w-full h-full max-h-72 object-cover" />
          <div class="pointer-events-none absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
        </div>

        <div class="mt-3 flex items-center justify-between gap-3">
          <div class="text-[11px] text-slate-500">ì´ë¯¸ì§€ê°€ ì—†ìœ¼ë©´ ê¸°ë³¸ ì´ë¯¸ì§€ê°€ í‘œì‹œë©ë‹ˆë‹¤.</div>
          <a id="openImageNewTab" href="/uploads/no-thumb.png" target="_blank" rel="noopener"
            class="btn-3d px-3 py-1.5 bg-white/90 border border-slate-200 text-[12px] font-semibold text-slate-700 hover:bg-slate-50">
            ìƒˆì°½ìœ¼ë¡œ ë³´ê¸°
          </a>
        </div>
      </article>

      <!-- ê¸°ë³¸ ì •ë³´ -->
      <article class="neo-card p-4 sm:p-6 flex flex-col justify-between min-h-[260px]">
        <header class="mb-4">
          <div class="flex items-start justify-between gap-4">
            <div class="min-w-0">
              <p class="text-xs font-semibold tracking-wide text-indigo-500 uppercase">ê¸°ë³¸ ì •ë³´</p>
              <h2 id="storeName" class="mt-1 text-2xl sm:text-3xl font-extrabold title-grad break-words">ìƒí˜¸ëª…</h2>
              <div class="mt-2 flex flex-wrap items-center gap-2">
                <span class="inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold bg-indigo-50 text-indigo-700 border border-indigo-100">
                  ğŸ·ï¸ <span id="badgeCategoryText">-</span>
                </span>
                <span class="inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-semibold bg-orange-50 text-orange-700 border border-orange-100">
                  ğŸ“… <span id="badgeOpenText">-</span>
                </span>
              </div>
            </div>
            <div class="shrink-0">
              <span class="inline-flex items-center rounded-full px-3 py-1 text-[11px] font-semibold bg-white/80 border border-slate-200 text-slate-600">
                OPEN SOON
              </span>
            </div>
          </div>
        </header>

        <dl class="mt-2 space-y-3 sm:space-y-4 text-sm sm:text-base leading-relaxed flex-1">
          <div class="flex gap-4 items-baseline">
            <dt class="w-24 shrink-0 text-slate-500 flex items-center gap-1"><span>ğŸ“…</span><span>ì˜¤í”ˆì¼</span></dt>
            <dd class="font-semibold text-slate-900">
              <span id="openDate" class="inline-flex rounded-xl bg-white/90 border border-slate-200 px-3 py-1.5">-</span>
            </dd>
          </div>

          <div class="flex gap-4 items-baseline">
            <dt class="w-24 shrink-0 text-slate-500 flex items-center gap-1"><span>ğŸ·ï¸</span><span>ì¹´í…Œê³ ë¦¬</span></dt>
            <dd id="category" class="font-semibold text-slate-900 inline-flex rounded-xl bg-white/90 border border-slate-200 px-3 py-1.5">-</dd>
          </div>

          <div class="flex gap-4 items-baseline">
            <dt class="w-24 shrink-0 text-slate-500 flex items-center gap-1"><span>ğŸ“</span><span>ì „í™”</span></dt>
            <dd class="font-semibold text-slate-900">
              <a id="phoneLink" href="#"
                class="btn-3d inline-flex items-center gap-2 rounded-xl bg-white/90 border border-slate-200 px-3 py-1.5 hover:bg-slate-50">
                <span id="phone">-</span><span class="text-[11px] text-slate-500">ì „í™”ê±¸ê¸°</span>
              </a>
            </dd>
          </div>

          <div class="flex gap-4 items-start">
            <dt class="w-24 shrink-0 text-slate-500 flex items-center gap-1 mt-0.5"><span>ğŸ“</span><span>ì£¼ì†Œ</span></dt>
            <dd class="font-semibold text-slate-900 flex-1">
              <div class="rounded-xl bg-white/90 border border-slate-200 px-3 py-2 flex items-start justify-between gap-3">
                <span id="addressText" class="inline-block max-w-full text-[0.92rem] leading-snug break-words">-</span>
                <button id="copyAddrBtn" type="button"
                  class="btn-3d px-3 py-1.5 bg-white/90 border border-slate-200 text-[12px] font-semibold text-slate-700 hover:bg-slate-50 shrink-0">
                  ë³µì‚¬
                </button>
              </div>
              <p id="copyAddrToast" class="hidden mt-1 text-[11px] text-emerald-600 font-semibold">ì£¼ì†Œê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
            </dd>
          </div>
        </dl>

        <p class="text-[11px] text-slate-400 mt-4">â€» ì‹¤ì œ ì˜¤í”ˆ ì‹œì ì˜ ì •ë³´ëŠ” ì¼ë¶€ ë‹¬ë¼ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      </article>

      <!-- ì§€ë„ -->
      <article class="neo-card p-4 sm:p-5 flex flex-col min-h-[260px]">
        <header class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2 text-sm font-semibold text-slate-600">
            <span class="text-lg">ğŸ—ºï¸</span><span>ê°€ê²Œ ìœ„ì¹˜</span>
          </div>
          <span class="text-[11px] text-slate-400">ì¹´ì¹´ì˜¤ ì§€ë„ ì—°ë™</span>
        </header>

        <div class="flex-1 rounded-2xl overflow-hidden border border-slate-200 bg-slate-100">
          <div id="map" class="w-full h-56 sm:h-64"></div>
        </div>

        <div class="flex justify-end pt-3">
          <a id="kakaoDirBtn" href="#" target="_blank" rel="noopener"
            class="btn-3d px-4 py-2 bg-gradient-to-r from-sky-500 to-indigo-500 text-xs sm:text-sm font-semibold text-white hover:from-sky-600 hover:to-indigo-600">
            ì¹´ì¹´ì˜¤ë§µ ê¸¸ì°¾ê¸° ì—´ê¸°
          </a>
        </div>
      </article>

      <!-- ì†Œê°œ(ë¯¸ë¦¬ë³´ê¸° + ë”ë³´ê¸°) -->
      <article class="neo-card p-4 sm:p-5 flex flex-col min-h-[260px]">
        <header class="mb-3 flex items-center justify-between">
          <div class="flex items-center gap-2 text-sm font-semibold text-slate-600">
            <span class="text-lg">ğŸ“</span><span>ê°€ê²Œ ì†Œê°œ</span>
          </div>
          <span id="descLenHint" class="text-[11px] text-slate-400 hidden">ê¸´ ê¸€</span>
        </header>

        <div id="desc" class="flex-1 text-sm sm:text-base leading-relaxed text-slate-800 whitespace-pre-line break-words line-clamp-6">
          ë“±ë¡ëœ ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.
        </div>

        <div class="mt-4 flex items-center justify-between">
          <p class="text-[11px] text-slate-400">â€» ì†Œê°œ ê¸€ì€ ì‚¬ì¥ë‹˜ì´ ì§ì ‘ ì‘ì„±í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>

          <!-- âœ… ì„¤ëª…ì´ ìˆìœ¼ë©´ ë¬´ì¡°ê±´ ë³´ì´ê²Œ(â€œì•ˆ ëˆŒë¦¼/ì•ˆ ëœ¸â€ ë°©ì§€) -->
          <button id="openDescModalBtn" type="button"
            class="btn-3d px-4 py-2 bg-white/90 border border-slate-200 text-xs sm:text-sm font-semibold text-slate-700 hover:bg-slate-50 hidden">
            ë”ë³´ê¸°
          </button>
        </div>
      </article>

    </section>
  </main>

  <!-- ìš°ì¸¡ í•˜ë‹¨ ê³ ì • ë„¤ë¹„ -->
  <div class="fixed bottom-6 right-6 flex flex-col items-center gap-4 z-50">
    <div class="flex flex-col items-center">
      <button onclick="history.back()"
        class="w-14 h-14 flex items-center justify-center rounded-full bg-gray-100 text-gray-800 border border-gray-200 shadow hover:bg-gray-50 transition">â†</button>
      <span class="text-xs mt-1 text-gray-600 font-semibold">ì´ì „</span>
    </div>
    <div class="flex flex-col items-center">
      <button onclick="history.forward()"
        class="w-14 h-14 flex items-center justify-center rounded-full bg-gray-100 text-gray-800 border border-gray-200 shadow hover:bg-gray-50 transition">â†’</button>
      <span class="text-xs mt-1 text-gray-600 font-semibold">ë‹¤ìŒ</span>
    </div>
    <div class="flex flex-col items-center">
      <a href="/index.html"
        class="w-14 h-14 flex items-center justify-center rounded-full bg-blue-600 text-white shadow hover:bg-blue-700 transition">ğŸ </a>
      <span class="text-xs mt-1 text-gray-600 font-semibold">í™ˆ</span>
    </div>
  </div>

  <!-- âœ… ì†Œê°œ ëª¨ë‹¬: hidden + class hidden ë‘˜ ë‹¤ë¡œ ì œì–´ -->
  <div id="descModal" hidden class="hidden fixed inset-0 z-[60] bg-black/50 backdrop-blur-sm flex items-center justify-center px-4">
    <div class="w-full max-w-3xl neo-card border border-white/70 overflow-hidden">
      <div class="px-5 sm:px-6 py-4 border-b border-slate-200/70 bg-white/60 flex items-center justify-between">
        <div class="min-w-0">
          <p class="text-[11px] font-semibold text-indigo-500 uppercase tracking-wide">Open Soon</p>
          <h3 class="mt-0.5 text-lg sm:text-xl font-extrabold title-grad truncate">ğŸ“ <span>ê°€ê²Œ ì†Œê°œ</span></h3>
          <p id="descModalSub" class="text-[12px] text-slate-500 mt-1 truncate">-</p>
        </div>

        <button type="button" data-desc-close
          class="btn-3d w-10 h-10 grid place-items-center bg-white/90 border border-slate-200 hover:bg-slate-50"
          aria-label="ë‹«ê¸°">âœ•</button>
      </div>

      <div class="px-5 sm:px-6 py-5">
        <div class="rounded-2xl border border-slate-200 bg-white/70 p-4 sm:p-5">
          <div id="descFull" class="scrollbox max-h-[65vh] pr-2 text-sm sm:text-base leading-relaxed text-slate-800 whitespace-pre-line break-words">
            -
          </div>
        </div>

        <div class="mt-4 flex items-center justify-end">
          <button type="button" data-desc-close
            class="btn-3d px-4 py-2 bg-gradient-to-r from-sky-500 to-indigo-500 text-xs sm:text-sm font-semibold text-white hover:from-sky-600 hover:to-indigo-600">
            ë‹«ê¸°
          </button>
        </div>
      </div>
    </div>
  </div>

  <div id="footer"></div>

  <script>
    console.log("OPENDETAIL VERSION CHECK: 2025-12-12-v2");

    // í—¤ë”/í‘¸í„°
    fetch('/components/header.html').then(r=>r.text()).then(t=>{ const el=document.getElementById('header'); if(el) el.innerHTML=t; }).catch(()=>{});
    fetch('/components/footer.html').then(r=>r.text()).then(t=>{ const el=document.getElementById('footer'); if(el) el.innerHTML=t; }).catch(()=>{});

    const $ = (id) => document.getElementById(id);

    // âœ… ëª¨ë‹¬ ê°•ì œ í† ê¸€ (hidden + class hidden ë‘˜ ë‹¤)
    function showModal() {
      const modal = $('descModal');
      if (!modal) return;
      modal.hidden = false;
      modal.classList.remove('hidden');
      document.body.style.overflow = 'hidden';
    }
    function hideModal() {
      const modal = $('descModal');
      if (!modal) return;
      modal.hidden = true;
      modal.classList.add('hidden');
      document.body.style.overflow = '';
    }

    // âœ… ì´ë²¤íŠ¸ëŠ” â€œë¬´ì¡°ê±´â€ ë¨¼ì € ë¶™ì„ (ë°ì´í„° fetch ì‹¤íŒ¨í•´ë„ ë‹«í˜/ì—´ë¦¼ ë™ì‘ì€ ì‚´ì•„ìˆê²Œ)
    document.addEventListener('DOMContentLoaded', () => {
      const openBtn = $('openDescModalBtn');
      const modal = $('descModal');

      if (openBtn) {
        openBtn.addEventListener('click', (e) => {
          e.preventDefault();
          showModal();
        });
      }

      // ë‹«ê¸° ë²„íŠ¼ë“¤
      document.addEventListener('click', (e) => {
        if (e.target.closest('[data-desc-close]')) {
          e.preventDefault();
          hideModal();
        }
      });

      // ë°”ê¹¥ í´ë¦­ ë‹«ê¸°
      if (modal) {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) hideModal();
        });
      }

      // ESC ë‹«ê¸°
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') hideModal();
      });

      // ì£¼ì†Œ ë³µì‚¬
      const btn = $('copyAddrBtn');
      const addr = $('addressText');
      const toast = $('copyAddrToast');
      if (btn && addr && toast) {
        let t = null;
        btn.addEventListener('click', async () => {
          const v = (addr.textContent || '').trim();
          if (!v || v === '-') return;
          try { await navigator.clipboard.writeText(v); }
          catch {
            const ta=document.createElement('textarea'); ta.value=v; document.body.appendChild(ta);
            ta.select(); document.execCommand('copy'); ta.remove();
          }
          toast.classList.remove('hidden');
          clearTimeout(t);
          t = setTimeout(()=>toast.classList.add('hidden'), 1500);
        });
      }
    });

    async function safeFetch(url) {
      const res = await fetch(url);
      const text = await res.text();
      if (!res.ok) throw new Error(`HTTP ${res.status} ${res.statusText} / ${text.slice(0,120)}`);
      const ct = res.headers.get('content-type') || '';
      if (ct.includes('application/json')) return JSON.parse(text);
      throw new Error(`NOT JSON: ${ct}`);
    }

    function qs(name) { return new URLSearchParams(location.search).get(name); }
    function basename(p) { const s=String(p||''); const i=s.lastIndexOf('/'); return i>=0?s.slice(i+1):s; }

    function setImageWithFallback(imgEl, rawSrc) {
      const tried = new Set();
      const candidates = [];
      const src = (rawSrc || '').trim();

      if (src) candidates.push(src);
      if (src.startsWith('/uploads/') && !src.startsWith('/uploads/open/')) {
        const base = basename(src);
        if (base) candidates.push(`/uploads/open/${base}`);
      }
      candidates.push('/uploads/no-thumb.png');

      let idx = 0;
      const next = () => {
        while (idx < candidates.length && tried.has(candidates[idx])) idx++;
        if (idx >= candidates.length) return;
        const c = candidates[idx++];
        tried.add(c);
        imgEl.src = c;
      };
      imgEl.onerror = () => next();
      next();
    }

    // ì§€ë„
    let map, marker, geocoder;
    function initMap(center) {
      map = new kakao.maps.Map($('map'), { center, level: 3 });
      marker = new kakao.maps.Marker({ map, position: center });
      geocoder = new kakao.maps.services.Geocoder();
    }

    function updateMapByAddress(address, storeName) {
      const dirBtn = $('kakaoDirBtn');
      const addr = (address || '').trim();
      if (!addr) { dirBtn.href = 'https://map.kakao.com/'; return; }

      const normalized = addr.replace(/\s+/g,' ');
      const variations = [normalized, normalized.replace(/\s+\d+\s*$/, ''), normalized.split(' ').slice(0, 3).join(' ')];

      function tryOne(i) {
        if (i >= variations.length) {
          dirBtn.href = `https://map.kakao.com/link/search/${encodeURIComponent(addr)}`;
          return;
        }
        geocoder.addressSearch(variations[i], (result, status) => {
          if (status === kakao.maps.services.Status.OK && result.length > 0) {
            const lat = parseFloat(result[0].y);
            const lng = parseFloat(result[0].x);
            const loc = new kakao.maps.LatLng(lat, lng);
            map.setCenter(loc);
            marker.setPosition(loc);
            const label = encodeURIComponent(storeName || 'ëª©ì ì§€');
            dirBtn.href = `https://map.kakao.com/link/to/${label},${lat},${lng}`;
          } else {
            tryOne(i + 1);
          }
        });
      }
      tryOne(0);
    }

    async function main() {
      const id = qs('id');
      if (!id) { alert('idê°€ ì—†ìŠµë‹ˆë‹¤.'); location.href='/open.html'; return; }

      const api = `/api/open/${id}`;
      const data = await safeFetch(api);
      const row = data.data || data;

      const storeName = row.store_name || 'ìƒí˜¸ëª… ë¯¸ì •';
      const category = row.category || '-';
      const openDateRaw = row.open_date || '-';
      const phone = (row.phone || '').trim();
      const address = (row.address || '').trim();
      const imagePath = (row.image_path || '').trim();
      const rawDesc = (row.description || '').trim();

      $('heroName').textContent = storeName;
      $('storeName').textContent = storeName;
      $('badgeCategoryText').textContent = category;
      $('category').textContent = category;
      $('addressText').textContent = address || '-';

      // ë‚ ì§œ
      let openText = openDateRaw;
      try {
        if (openDateRaw && openDateRaw !== '-') {
          const d = new Date(openDateRaw);
          openText = d.toLocaleDateString('ko-KR');
        }
      } catch {}
      $('openDate').textContent = openText;
      $('badgeOpenText').textContent = openText;

      // ì „í™”
      $('phone').textContent = phone || '-';
      const phoneLink = $('phoneLink');
      phoneLink.href = phone ? `tel:${phone.replace(/[^\d+]/g,'')}` : '#';

      // ì´ë¯¸ì§€ + ìƒˆì°½ ë§í¬
      const imgEl = $('storeImage');
      setImageWithFallback(imgEl, imagePath);
      $('openImageNewTab').href = imagePath || '/uploads/no-thumb.png';

      // ì„¤ëª…: HTML ì œê±° í›„ í…ìŠ¤íŠ¸ë§Œ
      let plain = '';
      if (rawDesc) {
        const tmp = document.createElement('div');
        tmp.innerHTML = rawDesc;
        plain = (tmp.textContent || tmp.innerText || '').trim();
      }

      $('descModalSub').textContent = storeName;

      if (plain) {
        $('desc').textContent = plain;
        $('descFull').textContent = plain;

        // âœ… ì„¤ëª…ì´ ìˆìœ¼ë©´ â€œë”ë³´ê¸°â€ ë¬´ì¡°ê±´ ë³´ì´ê²Œ
        $('openDescModalBtn').classList.remove('hidden');

        // â€œê¸´ ê¸€â€ ë±ƒì§€
        const isLong = plain.length > 220 || plain.split('\n').length >= 6;
        if (isLong) $('descLenHint').classList.remove('hidden');
      } else {
        $('desc').textContent = 'ë“±ë¡ëœ ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.';
        $('descFull').textContent = 'ë“±ë¡ëœ ì„¤ëª…ì´ ì—†ìŠµë‹ˆë‹¤.';
        $('openDescModalBtn').classList.add('hidden');
        $('descLenHint').classList.add('hidden');
      }

      // ì§€ë„
      kakao.maps.load(() => {
        const fallback = new kakao.maps.LatLng(37.5665, 126.9780);
        initMap(fallback);
        updateMapByAddress(address, storeName);
      });
    }

    main().catch((e) => {
      console.error(e);
      alert('ìƒì„¸ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.');
      location.href = '/open.html';
    });
  </script>
</body>
</html>
